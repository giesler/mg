Version =19
VersionRequired =19
Checksum =338524060
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    OrderByOn = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    GridX =24
    GridY =24
    Width =12360
    ItemSuffix =60
    Left =1620
    Top =285
    Right =13740
    Bottom =5610
    Toolbar ="BLIFormToolbar"
    RecSrcDt = Begin
        0x0ab1be521e66e140
    End
    Caption ="Inventory"
    MenuBar ="BLIFormMenuBar"
    OnResize ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin CustomControl
            SpecialEffect =2
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin FormHeader
            Height =0
            BackColor =-2147483633
            Name ="FormHeader0"
        End
        Begin Section
            CanGrow = NotDefault
            Height =5160
            BackColor =-2147483633
            Name ="Detail0"
            Begin
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =5
                    Top =600
                    Width =12093
                    Name ="Line31"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10080
                    Top =60
                    Width =486
                    Height =486
                    Name ="cmdClose"
                    OnClick ="=CloseForm()"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880888888 ,
                        0x8888888888888888888888880088888888888888888888888888888030888888 ,
                        0x8888888888888888888888033088888888888888888888888888803330888888 ,
                        0x8888888888888888888803333088888888888888888888888000333330000000 ,
                        0x00000888888888888880333330ffff0888888888888888888880333330ffff08 ,
                        0x88888888888888888880333300ffff0888888888888888888880333330ffff08 ,
                        0x88888488888888888880333330ffff0888884488888888888880333330ffff08 ,
                        0x88844488888888888880333330ffff0888444444488888888880333330ffff08 ,
                        0x84444444488888888880333330ffff0884444444488888888880333330ffff08 ,
                        0x8844444448888888888033330fffff08888444888888800088803330ffffff08 ,
                        0x88884488888880ff8880330fffffff0888888488888880ff888030ffffffff08 ,
                        0x888888888888800088800fffffffff0888888888888888888880000000000008 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =7200
                    Top =60
                    Width =480
                    Height =480
                    TabIndex =1
                    Name ="cmdPrint"
                    Caption ="Button20"
                    OnClick ="=InventoryReports()"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888000008888000000000000 ,
                        0x000088888880ffff8880888888888888888008888880ffff8880888888888888 ,
                        0x888080888880ffff8000000000000000000008088880ff00808888888888bbbb ,
                        0x888800808880ffff808888888888bbbb888808008880ffff8088888888887777 ,
                        0x888808808880ff008088888888888888888808880880ffff8000000000000000 ,
                        0x000008880880ffff8088888888888888888080880880ffff8808888888888888 ,
                        0x888088080880ffff8880000000000000000008800880ffff888880ffffffffff ,
                        0xff0880880880fff0888880ffffffffffff0088070880fff08888880ff0000000 ,
                        0xfff000008880ffff8888880ffffffffffff008888880000088888880ffffffff ,
                        0xffff088888888888888888880f00000000ff088888888888888888880fffffff ,
                        0xfffff088888888888888888880fffffffffff088888888888888888880000000 ,
                        0x0000008888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    Left =1050
                    Top =75
                    Width =4440
                    Height =420
                    FontSize =16
                    FontWeight =700
                    ForeColor =8421504
                    Name ="lblHead2"
                    Caption ="Inventory"
                    FontName ="Tahoma"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    Left =1020
                    Top =60
                    Width =4440
                    Height =420
                    FontSize =16
                    FontWeight =700
                    ForeColor =128
                    Name ="lblHead"
                    Caption ="Inventory"
                    FontName ="Tahoma"
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    SpecialEffect =0
                    Left =60
                    Top =60
                    Width =660
                    Height =480
                    TabIndex =2
                    Name ="subLogoSmall"
                    SourceObject ="Form.zfsubLogoSmall"
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =120
                    Top =720
                    Width =2460
                    Height =3570
                    AutoActivate =1
                    TabIndex =3
                    Name ="tvInvn"
                    OleData = Begin
                        0x001a0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000c0174f134dfebe010a00000040020000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000050000008e000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000800000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000030000006a000000 ,
                        0x0000000008000000fdffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfefffffffefffffffeffffff07000000ffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000e0d231c0e1febe010600000080020000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000050000008e000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000800000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000030000008b000000 ,
                        0x00000000ffffffffffffffff05000000fdfffffffefffffffeffffff0b000000 ,
                        0xfffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffeffffff02000000feffffff04000000090000000600000007000000 ,
                        0xfefffffffefffffffeffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff03004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000010000005c000000 ,
                        0x0000000002004f006c0065005000720065007300300030003000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000018000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000024000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000400000001000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000005c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b69041c78985d111b16a00c0f02836282143341208000000f3100000 ,
                        0x99180000b13cc16a0100060022000000390000006101000008000000c90b460b ,
                        0x01efcdab00000500980d460b06000000000000000500008024dd120001000000 ,
                        0x5c001fdeecbd010005002ddd12000352e30b918fce119de300aa004bb8510100 ,
                        0x000090010100feff030a0000ffffffffb69041c78985d111b16a00c0f0283628 ,
                        0x280000004d6963726f736f667420547265655669657720436f6e74726f6c2c20 ,
                        0x76657273696f6e20362e3000170000004d53436f6d63746c4c69622e54726565 ,
                        0x4374726c2e3200170000004d53436f6d63746c4c69622e547265654374726c2e ,
                        0x3200f439b2710000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000010000020000000000000000000000000000000008201d1300000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000010000005c000000 ,
                        0x0000000002004f006c0065005000720065007300300030003000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000018000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000024000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000feffffff02000000feffffff04000000feffffff0600000007000000 ,
                        0xfefffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff000000000400000001000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000005c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b69041c78985d111b16a00c0f02836282143341208000000f3100000 ,
                        0x99180000b13cc16a0100060022000000390000006101000008000000d1556b0e ,
                        0x01efcdab00000500a0576b0e06000000000000000500008018ea120001000000 ,
                        0x5c001fdeecbd0100050020ea1200000000000000000000000000000000000000 ,
                        0x000000000100feff030a0000ffffffffb69041c78985d111b16a00c0f0283628 ,
                        0x280000004d6963726f736f667420547265655669657720436f6e74726f6c2c20 ,
                        0x76657273696f6e20362e3000170000004d53436f6d63746c4c69622e54726565 ,
                        0x4374726c2e3200170000004d53436f6d63746c4c69622e547265654374726c2e ,
                        0x3200f439b2710000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000010000020000000000000000000000000000000008201d1300000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000044420100065461686f6d610000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="TreeCtrl"
                    Class ="MSComctlLib.TreeCtrl.2"
                    GUID = Begin
                        0xb3d5fe1fd0d85e43a02af2ac3039f416
                    End
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =2640
                    Top =720
                    Width =9060
                    Height =3570
                    AutoActivate =1
                    TabIndex =4
                    Name ="lvInvn"
                    OleData = Begin
                        0x00120000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf028362800000000000000000000000070aca5a019ffbe010a00000080030000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000900000096000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000c00000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000300000088010000 ,
                        0x0000000009000000fdffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffefffffffeffffff0b000000feffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000f007fda919ffbe010600000080030000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000900000096000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000c00000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000300000088010000 ,
                        0x00000000ffffffffffffffff05000000fdfffffffefffffffeffffff07000000 ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffeffffff02000000feffffff04000000050000000600000007000000 ,
                        0x080000000d0000000a0000000b000000fefffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff03004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000010000005c000000 ,
                        0x0000000002004f006c0065005000720065007300300030003000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000018000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000024000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000400000001000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000005c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000004bf0d1bd8b85d111b16a00c0f028362821433412080000006d3e0000 ,
                        0x991800004e087deb010006001c0000000000000000000000238200066d3e0000 ,
                        0x01efcdab0000050081e1af770780da0608000080050000800001038000000000 ,
                        0x00000000000000001fdeecbd01000500c902e8040352e30b918fce119de300aa ,
                        0x004bb85101000000900144420100065461686f6d61060020000000000000001e ,
                        0x1800000c0000000000000000000000000000000c000000446573637269707469 ,
                        0x6f6e002000010001000000000000000500000000000000000000000000000005 ,
                        0x000000436f7374002000020002000000e4060000060000000000000000000000 ,
                        0x00000000060000004f72646572002000030001000000e40600000b0000000000 ,
                        0x000000000000000000000b0000004f7264657220446174650020000400020000 ,
                        0x00e40600000b0000000000000000000000000000000b00000053616c65204f72 ,
                        0x646572002000050002000000e406000008000000000000000000000000000000 ,
                        0x080000000100feff030a0000ffffffff4bf0d1bd8b85d111b16a00c0f0283628 ,
                        0x280000004d6963726f736f6674204c6973745669657720436f6e74726f6c2c20 ,
                        0x76657273696f6e20362e30001b0000004d53436f6d63746c4c69622e4c697374 ,
                        0x566965774374726c2e32001b0000004d53436f6d63746c4c69622e4c69737456 ,
                        0x6965774374726c2e3200f439b271000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000001000002000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000496e766f696365000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                    GUID = Begin
                        0xb5a225db45b4a64ca9e8c0cf516fb60a
                    End
                End
            End
        End
        Begin FormFooter
            CanGrow = NotDefault
            Height =420
            BackColor =128
            Name ="FormFooter1"
            Begin
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =1260
                    Top =60
                    Width =360
                    Height =300
                    Name ="Button48"
                    Caption ="Button48"
                    OnClick ="=fRecNav(\"next\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8888800888888888800000008888800088888888840000008888800008888888 ,
                        0x8004322688888000008888888040e26288888000000888888440366688888000 ,
                        0x000088888111a3338888800000088888899deaee8888800000888888888caaaa ,
                        0x8888800008888888811133228888800088888888811909108888800888888888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =900
                    Top =60
                    Width =360
                    Height =300
                    TabIndex =1
                    Name ="Button49"
                    Caption ="Button49"
                    OnClick ="=fRecNav(\"prev\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8888888800888888800000008888888000888888840000008888880000888888 ,
                        0x8004322688888000008888888040e26288880000008888888440366688800000 ,
                        0x008888888111a3338888000000888888899deaee8888800000888888888caaaa ,
                        0x8888880000888888811133228888888000888888811909108888888800888888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =1620
                    Top =60
                    Width =360
                    Height =300
                    TabIndex =2
                    Name ="Button50"
                    Caption ="Button50"
                    OnClick ="=fRecNav(\"last\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8800888888800888800000008800088888800888840000008800008888800888 ,
                        0x8004322688000008888008888040e26288000000888008888440366688000000 ,
                        0x088008888111a3338800000088800888899deaee8800000888800888888caaaa ,
                        0x8800008888800888811133228800088888800888811909108800888888800888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =540
                    Top =60
                    Width =360
                    Height =300
                    TabIndex =3
                    Name ="cmdPrevious"
                    Caption ="Button51"
                    OnClick ="=fRecNav(\"first\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8800888888800888800000008800888888000888840000008800888880000888 ,
                        0x8004322688008888000008888040e26288008880000008888440366688008800 ,
                        0x000008888111a3338800888000000888899deaee8800888800000888888caaaa ,
                        0x8800888880000888811133228800888888000888811909108800888888800888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =1980
                    Top =60
                    Width =360
                    Height =300
                    TabIndex =4
                    Name ="cmdNew"
                    Caption ="Button52"
                    OnClick ="=fRecNav(\"new\")"
                    PictureData = Begin
                        0x28000000100000000f0000000100040000000000780000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x80800000c0c0c000808080000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00777777777777777777777777777777777777777777777777 ,
                        0x7077777777777777700777777770777770007777707070777000077777000777 ,
                        0x7000007700000007700007777700077770007777707070777007777777707777 ,
                        0x7077777777777777777777777777777777777777777777777777777777777777 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0xc0c0c00080808000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =540
                    Top =60
                    Width =1800
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =5
                    Name ="cmdShowAll"
                    Caption ="Show All"
                    OnClick ="=fRecNav(\"showall\")"
                    FontName ="Tahoma"
                End
                Begin OptionButton
                    OverlapFlags =85
                    Left =180
                    Top =120
                    Width =240
                    Height =180
                    TabIndex =6
                    Name ="optHideCosts"
                    DefaultValue ="True"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =67
                    TextFontFamily =34
                    Left =10800
                    Top =60
                    Width =1020
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =7
                    Name ="cmdBarCloseForm"
                    Caption ="&Close"
                    OnClick ="=CloseForm()"
                    FontName ="Tahoma"
                End
                Begin ToggleButton
                    OverlapFlags =85
                    AccessKey =65
                    Left =3240
                    Top =60
                    Width =1560
                    Height =300
                    TabIndex =8
                    Name ="tglAll"
                    Caption ="&All Inventory"
                    FontName ="Tahoma"
                    OnClick ="=ToggleInventoryView(\"All\")"
                    GUID = Begin
                        0x66e6b65d88208f46afe7117ff791326e
                    End
                End
                Begin ToggleButton
                    OverlapFlags =85
                    AccessKey =65
                    Left =4860
                    Top =60
                    Width =1560
                    Height =300
                    TabIndex =9
                    Name ="tglAvailable"
                    Caption ="&Available Inventory"
                    FontName ="Tahoma"
                    OnClick ="=ToggleInventoryView(\"Available\")"
                    GUID = Begin
                        0xdbaad3a172628e49a2d717d823b145eb
                    End
                End
                Begin ToggleButton
                    OverlapFlags =85
                    AccessKey =82
                    Left =6480
                    Top =60
                    Width =1560
                    Height =300
                    TabIndex =10
                    Name ="tglReserved"
                    Caption ="&Reserved Inventory"
                    FontName ="Tahoma"
                    OnClick ="=ToggleInventoryView(\"Reserved\")"
                    GUID = Begin
                        0x4a979520f6c7844aa855d770caf8c106
                    End
                End
                Begin ToggleButton
                    OverlapFlags =85
                    AccessKey =83
                    Left =8100
                    Top =60
                    Width =1560
                    Height =300
                    TabIndex =11
                    Name ="tglSold"
                    Caption ="&Sold Inventory"
                    FontName ="Tahoma"
                    OnClick ="=ToggleInventoryView(\"Sold\")"
                    GUID = Begin
                        0x860ca98a443b6a4e9110de432a363719
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons

Dim wHeight As Long, sInvnWhere As String

Private Sub Form_Load()
LoadInvnGrpTree
Me.lvInvn.Sorted = True
Me.tglAll = True
sInvnWhere = ""
End Sub

Private Sub Form_Resize()
On Error GoTo Form_Resize_Err

Dim topHeight As Long, detHeight As Long, curWindowHeight

' Check to see if window was resized
curWindowHeight = GetWindowHeight
If wHeight = curWindowHeight Then
    Exit Sub
End If

wHeight = curWindowHeight

topHeight = 1200    ' height above item subform
detHeight = 6690    ' detail height before resizing

Me.tvInvn.Height = 1000
Me.lvInvn.Height = 1000
Me.Detail0.Height = detHeight

Me.Detail0.Height = wHeight * TwipsPerPixelY - Me.FormFooter1.Height - 1600
Me.tvInvn.Height = Me.Detail0.Height - topHeight - 25
Me.lvInvn.Height = Me.tvInvn.Height

Exit Sub
Form_Resize_Err:
ErrHand Me.Name, "Form_Resize"
Exit Sub

End Sub

Private Sub lvInvn_DblClick()

Dim fr As New Form_fdlgInvnInfo, id As Long, li As ListItem, cG As Node
Set li = Me.lvInvn.SelectedItem

If li Is Nothing Then
  MsgBox "Please select an item group on the left.", vbExclamation
  Exit Sub
End If
id = Val(Mid(li.key, 3))
fr.Filter = "apkInvn = " & id
fr.FilterOn = True
If Me.optHideCosts Then fr.txtInvnCost.Visible = False
fr.Visible = True
Pause fr

If Not fr.blnCancel Then
  li.Text = fr.txtInvnDesc
  li.SubItems(1) = Format(fr.txtInvnCost, "Currency")
End If

End Sub


Private Sub lvInvn_KeyUp(KeyCode As Integer, ByVal Shift As Integer)

If KeyCode = vbKeyDelete Then MsgBox "You can't delete inventory items.", vbExclamation

End Sub

Private Sub optHideCosts_Click()
On Error GoTo optHideCosts_Err

Dim ch As ColumnHeader

If Me.optHideCosts = True Then
  Set ch = Me.lvInvn.ColumnHeaders(2)
  ch.Width = 0
Else
  If SecureAuthorize = False Then
    Me.optHideCosts = True
    Exit Sub
  End If
  Set ch = Me.lvInvn.ColumnHeaders(2)
  ch.Width = 1000
End If

Exit Sub
optHideCosts_Err:
ErrHand Me.Name, "optHideCosts"
Exit Sub

End Sub

Private Sub tvInvn_Click()
On Error GoTo tvInvn_Click_Err

Dim cNode As Node, sSQL As String, cGrp As Long
Dim rstInvn As New Recordset, cLI As ListItem
Dim sli As ListItem, sIndex As Long, sWhere As String

Set cNode = Me.tvInvn.SelectedItem

OpenWaitForm "Loading " & cNode.Text & " inventory..."

cGrp = Val(Mid(cNode.key, 3))
sSQL = "SELECT tblInvn.apkInvn, tblInvn.InvnDesc, tblInvn.InvnCost, tblOrder.OrderNumber, "
sSQL = sSQL & "tblOrder.OrderDate, tblSale.SaleNumber , tblInvoice.InvNumber "
sSQL = sSQL & "FROM tblSaleItem INNER JOIN tblSale ON tblSaleItem.afkSItemSale = tblSale.apkSale RIGHT OUTER JOIN "
sSQL = sSQL & "tblOrder INNER JOIN tblInvn ON tblOrder.apkOrder = tblInvn.afkInvnOrder LEFT OUTER JOIN "
sSQL = sSQL & "tblInvoice INNER JOIN tblInvoiceItem ON tblInvoice.apkInv = tblInvoiceItem.afkIItemInv ON "
sSQL = sSQL & "tblInvn.afkInvnIItem = tblInvoiceItem.apkIItem ON tblSaleItem.apkSItem = tblInvn.afkInvnSItem "
If cNode.key <> "all" Then sWhere = "tblInvn.afkInvnGroup = " & cGrp
If sInvnWhere <> "" Then
  If sWhere <> "" Then sWhere = sWhere & " AND "
  sWhere = sWhere & sInvnWhere
End If
If sWhere <> "" Then sSQL = sSQL & "WHERE " & sWhere

rstInvn.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Me.lvInvn.ListItems.Clear

Do While Not rstInvn.EOF
  Set cLI = Me.lvInvn.ListItems.Add(, "n:" & rstInvn!apkInvn, rstInvn!InvnDesc)
  cLI.SubItems(1) = Format(rstInvn!InvnCost, "Currency")
  cLI.SubItems(2) = Nz(rstInvn!OrderNumber, "")
  cLI.SubItems(3) = Nz(rstInvn!OrderDate, "")
  cLI.SubItems(4) = Nz(rstInvn!SaleNumber, "")
  cLI.SubItems(5) = Nz(rstInvn!InvNumber, "")
  rstInvn.MoveNext
Loop
CloseWaitForm

Exit Sub
tvInvn_Click_Err:
ErrHand Me.Name, "tvInvn_Click"
Exit Sub

End Sub

Private Function LoadInvnGrpTree()

Dim rstGrps As New Recordset, sNodeTxt As String, sRemTxt As String, i As Integer
Dim pNode As Node, cNode As Node, sSQL As String, tNode As Node, flg As Boolean

Set pNode = Me.tvInvn.Nodes.Add(, , "all", "All Groups")

sSQL = "SELECT apkInvnGrp, InvnGrpDesc FROM tblInvnGrp ORDER BY InvnGrpDesc"
rstGrps.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not rstGrps.EOF
  If InStr(rstGrps!InvnGrpDesc, "\") = 0 Then
    Set pNode = Me.tvInvn.Nodes.Add(, , "g:" & rstGrps!apkInvnGrp, rstGrps!InvnGrpDesc)
  Else
    sRemTxt = rstGrps!InvnGrpDesc
    Set cNode = Nothing
    Do While InStr(sRemTxt, "\")
      sNodeTxt = Left(sRemTxt, InStr(sRemTxt, "\") - 1)
      sRemTxt = Mid(sRemTxt, InStr(sRemTxt, "\") + 1)
      If cNode Is Nothing Then   ' base case, look through base children
        flg = False
        For Each tNode In Me.tvInvn.Nodes
          If tNode.Text = sNodeTxt Then
            flg = True
            Set cNode = tNode
          End If
        Next tNode
        If Not flg Then Set cNode = Me.tvInvn.Nodes.Add(, , , sNodeTxt)
      Else  ' we already have a cNode, so we want to find the child
        flg = False
        For i = 1 To cNode.Children
          If i = 1 Then
            Set tNode = cNode.FirstSibling
          Else
            Set tNode = cNode.Next
          End If
          If tNode.Text = sNodeTxt Then
            flg = True
            Set cNode = tNode
          End If
        Next i
        If Not flg Then Set cNode = Me.tvInvn.Nodes.Add(cNode, tvwChild, , sNodeTxt)
      End If
    Loop
    ' now we just have a string left which should be added to cNode
    Set pNode = Me.tvInvn.Nodes.Add(cNode, tvwChild, "g:" & rstGrps!apkInvnGrp, sRemTxt)
  End If
  rstGrps.MoveNext
Loop
rstGrps.Close

End Function

Public Function ToggleInventoryView(sView As String)

Me.tglAll = False
Me.tglAvailable = False
Me.tglReserved = False
Me.tglSold = False
Select Case sView
  Case "All"
    Me.tglAll = True
    sInvnWhere = ""
  Case "Available"
    Me.tglAvailable = True
    sInvnWhere = "tblSale.apkSale IS NULL AND tblInvoice.apkInv IS NULL"
  Case "Reserved"
    Me.tglReserved = True
    sInvnWhere = "tblSale.apkSale IS NOT NULL AND tblInvoice.apkInv IS NULL"
  Case "Sold"
    Me.tglSold = True
    sInvnWhere = "tblInvoice.apkInv IS NOT NULL"
End Select

Dim n As Node
Set n = Me.tvInvn.SelectedItem
If Not (n Is Nothing) Then
  tvInvn_Click
End If

End Function