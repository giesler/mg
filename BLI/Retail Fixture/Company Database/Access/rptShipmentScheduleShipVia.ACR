Version =19
VersionRequired =19
Checksum =1651905972
Begin Report
    LayoutForPrint = NotDefault
    DefaultView =0
    AllowUpdating =4
    DateGrouping =1
    GrpKeepTogether =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =10807
    DatasheetFontHeight =10
    ItemSuffix =42
    Left =345
    Top =135
    Right =8595
    Bottom =4755
    DatasheetGridlinesColor =12632256
    OnNoData ="[Event Procedure]"
    Toolbar ="RFReportToolBar"
    RecSrcDt = Begin
        0x0f4ea7969922e240
    End
    InputParameters ="GetSPVar(\"ShipFromDate\"), GetSPVar(\"ShipToDate\"), GetSPVar(\"SoldName\"), Ge"
        "tSPVar(\"Medite\"), GetSPVar(\"StoreSelName\"), GetSPVar(\"ShipVia\"), GetSPVar("
        "\"RefNum\")"
    RecordSource ="dbo.sp_Report_ShipmentSchedule"
    Caption ="Shipment Schedule Ship Via"
    OnOpen ="[Event Procedure]"
    MenuBar ="RFReportMenuBar"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xd0020000d0020000400200001a03000000000000372a0000d302000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800701000100ea0a6f08640001000f00680102000100 ,
        0x6801020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =2
            FontName ="Arial"
        End
        Begin TextBox
            OldBorderStyle =0
            TextFontFamily =2
            FontName ="Arial"
        End
        Begin UnboundObjectFrame
            OldBorderStyle =1
        End
        Begin BreakLevel
            GroupFooter = NotDefault
            ControlSource ="Ship_Via"
        End
        Begin PageHeader
            Height =3240
            Name ="PageHeader"
            Begin
                Begin Label
                    TextFontFamily =34
                    Top =2760
                    Width =1500
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label19"
                    Caption ="CITY/STATE"
                End
                Begin Label
                    TextFontFamily =34
                    Left =1500
                    Top =2760
                    Width =1440
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label20"
                    Caption ="PO #"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =2940
                    Top =2640
                    Width =840
                    Height =480
                    FontSize =10
                    FontWeight =700
                    Name ="Label22"
                    Caption ="ARRIVE\015\012DATE"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =3780
                    Top =2640
                    Width =840
                    Height =480
                    FontSize =10
                    FontWeight =700
                    Name ="Label23"
                    Caption ="SHIP\015\012DATE"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =4620
                    Top =2760
                    Width =960
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label24"
                    Caption ="WEIGHT"
                End
                Begin Label
                    TextFontFamily =34
                    Left =6480
                    Top =2760
                    Width =1980
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label25"
                    Caption ="COMMENTS"
                End
                Begin Line
                    Top =3120
                    Width =10800
                    Name ="Line26"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =8460
                    Top =2760
                    Width =1440
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label36"
                    Caption ="SHIP TO"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =5580
                    Top =2640
                    Width =795
                    Height =480
                    FontSize =10
                    FontWeight =700
                    Name ="Label38"
                    Caption ="FT of Truck"
                End
                Begin Line
                    BorderWidth =1
                    Top =691
                    Width =10800
                    Name ="Line0"
                End
                Begin Subform
                    OldBorderStyle =0
                    Width =7140
                    Height =1047
                    Name ="subLogo"
                    SourceObject ="Report.rsubLogo"
                End
                Begin TextBox
                    FontUnderline = NotDefault
                    TextAlign =2
                    TextFontFamily =34
                    Left =7
                    Top =1080
                    Width =10800
                    Height =705
                    FontSize =26
                    TabIndex =1
                    Name ="Label5"
                    ControlSource ="=\"Shipment Schedule for \" & [Ship_Via]"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Top =1920
                    Width =10800
                    Height =360
                    FontSize =12
                    FontWeight =700
                    Name ="lblCriteria"
                    GUID = Begin
                        0x650a4f88cb190345a667c5068312c8a4
                    End
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =9870
                    Top =2760
                    Width =885
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label40"
                    Caption ="STORE #"
                    GUID = Begin
                        0x3ab7a49030f1da478f104621c316d742
                    End
                End
            End
        End
        Begin Section
            KeepTogether = NotDefault
            CanGrow = NotDefault
            Height =723
            Name ="Detail"
            Begin
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =3780
                    Width =840
                    Height =720
                    FontSize =10
                    Name ="Ship_Date"
                    ControlSource ="Ship_Date"
                    Format ="m/d/yy"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextFontFamily =34
                    Width =1500
                    Height =720
                    FontSize =10
                    TabIndex =1
                    Name ="CITY_STATE"
                    ControlSource ="CITY_STATE"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =2940
                    Width =840
                    Height =720
                    FontSize =10
                    TabIndex =2
                    Name ="Arrive_Date"
                    ControlSource ="Arrive_Date"
                    Format ="m/d/yy"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =4620
                    Width =960
                    Height =720
                    FontSize =10
                    TabIndex =3
                    Name ="txtExtendedWeight"
                    ControlSource ="ExtWeight"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    TextFontFamily =34
                    Left =6300
                    Width =2160
                    Height =723
                    FontSize =10
                    TabIndex =4
                    Name ="FirstOfComments"
                    ControlSource ="Comments"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextFontFamily =34
                    Left =1500
                    Height =720
                    FontSize =11
                    TabIndex =5
                    Name ="txtPO"
                    ControlSource ="=SplitPO([PONumber])"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =8460
                    Height =723
                    FontSize =10
                    TabIndex =6
                    Name ="Priority"
                    ControlSource ="Ship_Name"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =5580
                    Width =720
                    Height =720
                    FontSize =10
                    TabIndex =7
                    Name ="Text39"
                    ControlSource ="FTofTruckAmount"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =9900
                    Width =840
                    Height =723
                    FontSize =10
                    TabIndex =8
                    Name ="Text41"
                    ControlSource ="Ship_StoreNo"
                    GUID = Begin
                        0x9ab8b990efc2de48915bbabf63661820
                    End
                End
            End
        End
        Begin BreakFooter
            KeepTogether = NotDefault
            ForceNewPage =2
            Height =0
            Name ="GroupFooter0"
            GUID = Begin
                0xf43b59e39d03bc4c9408af240cb13ce3
            End
        End
        Begin PageFooter
            Height =300
            Name ="PageFooter"
            Begin
                Begin Line
                    BorderWidth =1
                    Width =10695
                    Name ="Line55"
                    GUID = Begin
                        0x7650b0799b25fa41a246c5c9f76804be
                    End
                End
                Begin TextBox
                    FontItalic = NotDefault
                    TextAlign =2
                    TextFontFamily =34
                    Left =3240
                    Top =60
                    Width =4200
                    Name ="Text54"
                    ControlSource ="=\"Printed \" & Date()"
                    GUID = Begin
                        0xaddf5b6eb756714f96304e1dcb29d27f
                    End
                End
                Begin Label
                    FontItalic = NotDefault
                    TextAlign =1
                    TextFontFamily =34
                    Left =60
                    Top =60
                    Width =3120
                    Height =240
                    Name ="Text56"
                    Caption ="Retail Fixture, LLC."
                    GUID = Begin
                        0xa166b3331ee51e44b6310d59c4bca659
                    End
                End
                Begin TextBox
                    FontItalic = NotDefault
                    TextAlign =3
                    TextFontFamily =34
                    Left =7500
                    Top =60
                    Width =3120
                    TabIndex =1
                    Name ="Text57"
                    ControlSource ="=\"Page \" & [Page] & \" of \" & [Pages]"
                    GUID = Begin
                        0xf8bda03d6847dd4181b4b2dadcb79b23
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub Report_NoData(Cancel As Integer)
MsgBox "There were no POs for the criteria entered: " & vbCrLf & Me.lblCriteria.Caption, vbExclamation
Cancel = True
End Sub


Private Sub Report_Open(Cancel As Integer)
On Error GoTo errHandler

  Dim fC As Form_frptShipmentSchedule, strCrit As String
  Set fC = New Form_frptShipmentSchedule
  fC.Caption = Me.Caption
  fC.lblDate.Caption = "Ship Date:"
  
  Pause fC

  If fC.mblnCancel Then
    Cancel = True
  Else
    SetSPVar "ShipFromDate", fC.datFrom
    SetSPVar "ShipToDate", fC.datTo
    SetSPVar "SoldName", fC.cmbSoldName
    If fC.lstWheatboard = 1 Then
      SetSPVar "Medite", 1
    ElseIf fC.lstWheatboard = 2 Then
      SetSPVar "Medite", 0
    Else
      SetSPVar "Medite", Null
    End If
    SetSPVar "StoreSelName", Null
    SetSPVar "ShipVia", fC.cmbShipVia
    SetSPVar "RefNum", fC.txtRefNum
    strCrit = FormatFromTo(fC.datFrom, fC.datTo)
    If strCrit <> "" Then strCrit = "Ship Date " + strCrit
    If fC.cmbSoldName <> "" Then
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit + "Customer: " + fC.cmbSoldName
    End If
    If fC.lstWheatboard = 1 Then        ' only medite
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit & "Wheatboard Shipments"
    ElseIf fC.lstWheatboard = 2 Then    ' only non medite
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit & "Non-Wheatboard Shipments"
    End If
    If fC.txtRefNum <> "" Then
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit & "Ref #: " & fC.txtRefNum
    End If
    
    'Store
    gConn.Execute "DELETE FROM ztmpStoreSel WHERE StoreSelName = '" + GetNTUserName() + "'"
    If fC.lstStore.ItemsSelected.Count > 0 Then
      SetSPVar "StoreSelName", GetNTUserName()
      Dim crit As String, msg As String, varItm As Variant
      If strCrit <> "" Then strCrit = strCrit + ", "
      For Each varItm In fC.lstStore.ItemsSelected
        gConn.Execute "insert ztmpStoreSel (Store, StoreSelName) values ('" + DQ(fC.lstStore.ItemData(varItm)) + "', '" + GetNTUserName() + "')"
        If msg <> "" Then msg = msg & ", " Else msg = "Store: "
        msg = msg & fC.lstStore.ItemData(varItm)
      Next varItm
      strCrit = strCrit & msg
    End If
    If fC.cmbShipVia <> "" Then
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit + "Ship Via: " + fC.cmbShipVia
    End If
    Me.lblCriteria.Caption = strCrit
  End If
  
  Set fC = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "Report_Open"
Exit Sub
End Sub