Version =19
VersionRequired =19
Checksum =1095350493
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =6840
    DatasheetFontHeight =10
    ItemSuffix =44
    Left =4215
    Top =2235
    Right =11055
    Bottom =5820
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x40d23033b3f6e140
    End
    Caption ="PO Item"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800501000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin CustomControl
            SpecialEffect =2
        End
        Begin Section
            CanGrow = NotDefault
            Height =3960
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =85
                    Left =1380
                    Top =480
                    Width =4800
                    ColumnWidth =3690
                    TabIndex =2
                    BackColor =-2147483633
                    Name ="txtDescription"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =480
                            Width =1065
                            Height =240
                            Name ="Label10"
                            Caption ="Description:"
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =3180
                    Top =1200
                    Width =1260
                    ColumnWidth =780
                    TabIndex =5
                    BackColor =-2147483633
                    Name ="txtPrice"
                    Format ="$#,##0.00;($#,##0.00)"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2340
                            Top =1200
                            Width =765
                            Height =240
                            Name ="Label11"
                            Caption ="Price:"
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =240
                    Top =2010
                    Width =1505
                    TabIndex =9
                    Name ="chkSubItems"
                    DefaultValue ="False"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =470
                            Top =1980
                            Width =1215
                            Height =240
                            Name ="Label23"
                            Caption ="Breakdown"
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    AccessKey =68
                    Left =5820
                    Top =2940
                    Width =840
                    Height =300
                    TabIndex =13
                    Name ="cmdSubItemDelete"
                    Caption ="&Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =1380
                    Top =1200
                    Width =720
                    TabIndex =4
                    BackColor =-2147483633
                    Name ="txtQuantity"
                    AfterUpdate ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =540
                            Top =1200
                            Width =765
                            Height =240
                            Name ="Label27"
                            Caption ="Quantity:"
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =4320
                    Left =1380
                    Top =120
                    Width =1500
                    ColumnWidth =855
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"50\""
                    GUID = Begin
                        0x2e352a2403cf8d4d9b692438d38f9839
                    End
                    Name ="cmbMaterial"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="select material, Description from tbl_Catalog order by Material"
                    ColumnWidths ="1440;2880"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =120
                            Width =1065
                            Height =240
                            Name ="Label9"
                            Caption ="RF Material:"
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =4320
                    Left =4680
                    Top =120
                    Width =1500
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"50\""
                    GUID = Begin
                        0x6b43c9bdf75ced41a73c78af6092ef29
                    End
                    Name ="cmbCustMaterial"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="select CustMaterial, Description, Material from Tbl_Catalog where CustMaterial <"
                        "> '' and CustMaterial is not null"
                    ColumnWidths ="1440;2880;0"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =3360
                            Top =120
                            Width =1245
                            Height =240
                            Name ="Label29"
                            Caption ="Cust Material:"
                            GUID = Begin
                                0x0275da4ee09bcd41a612991945b29d20
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =83
                    Left =4560
                    Top =3540
                    Width =1020
                    Height =300
                    TabIndex =15
                    Name ="cmdSave"
                    Caption ="&Save"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    AccessKey =67
                    Left =5700
                    Top =3540
                    Width =1020
                    Height =300
                    TabIndex =16
                    Name ="cmdCancel"
                    Caption ="&Cancel"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =78
                    Left =3420
                    Top =3540
                    Width =1020
                    Height =300
                    TabIndex =14
                    Name ="cmdSaveNew"
                    Caption ="Save && &New"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xa3b434f71b48f145ae50bf3a8c5d80e4
                    End
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =247
                    Left =120
                    Top =2220
                    Width =5640
                    Height =1200
                    AutoActivate =1
                    TabIndex =10
                    Name ="lvSubItems"
                    OleData = Begin
                        0x000e0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffdfffffffeffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000feffffff00000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000052006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf02836280000000000000000000000005037e0031a3fc10105000000c0010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000012010000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff03000000040000000500000006000000feffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0400ffff79061e007800ffffffffffffffffffffffff7f0620007a00ffffffff ,
                        0xffffffff4bf0d1bd8b85d111b16a00c0f02836282143341208000000dc260000 ,
                        0x450800004e087deb010006001c000000000000000000000023820000dc260000 ,
                        0x01efcdab00000500000000000700000008000080050000800001038000000000 ,
                        0x00000000000000001fdeecbd01000500287dea0b040020000000000000000000 ,
                        0x00000a0000000000000000000000000000000a0000005375624974656d494400 ,
                        0x20000100000000003a1100000c0000000000000000000000000000000c000000 ,
                        0x4465736372697074696f6e0020000200010000002b0500000400000000000000 ,
                        0x0000000000000000040000005174790020000300010000002b05000006000000 ,
                        0x00000000000000000000000006000000507269636500ffffffffffff1100b401 ,
                        0x04000000000215003893ea0bffffffffffffffff0000000036b919800d008900 ,
                        0x04005400d8ca270ae0011500f00800000104ffff33000000702ded0400000000 ,
                        0x00000000000000002831000090310000e8300000f40e0000ffffffffffffffff ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                    GUID = Begin
                        0x249a64f299189c49a0dcd4bd72b593d3
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    Left =5460
                    Top =1200
                    Width =720
                    TabIndex =6
                    BackColor =-2147483633
                    Name ="txtUnit"
                    GUID = Begin
                        0x9503abd1ad8bd147832e6746d8f92251
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =4620
                            Top =1200
                            Width =765
                            Height =240
                            Name ="Label33"
                            Caption ="Unit:"
                            GUID = Begin
                                0xafbed8ea2f1bc14ba36db4e584203c4a
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =85
                    Left =1380
                    Top =840
                    Width =1260
                    TabIndex =3
                    BackColor =-2147483633
                    Name ="txtPhase"
                    GUID = Begin
                        0xd12c3b710a344c4b9d1425f14e674c1e
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =540
                            Top =840
                            Width =765
                            Height =240
                            Name ="Label35"
                            Caption ="Phase:"
                            GUID = Begin
                                0xce86c789de738a4094051d750fab3f22
                            End
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    AccessKey =65
                    Left =5820
                    Top =2220
                    Width =840
                    Height =300
                    TabIndex =11
                    Name ="cmdSubItemAdd"
                    Caption ="&Add"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0x099e3400bc428a4bbd534601bc21c6ec
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    AccessKey =69
                    Left =5820
                    Top =2580
                    Width =840
                    Height =300
                    TabIndex =12
                    Name ="cmdSubItemEdit"
                    Caption ="&Edit"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0x083aa62daa13a74f8c0de3397a1e9723
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =1380
                    Top =1560
                    Width =1260
                    TabIndex =7
                    BackColor =-2147483633
                    Name ="txtWeight"
                    GUID = Begin
                        0x35078d498a4a924fadd07519c2f10a02
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =540
                            Top =1560
                            Width =765
                            Height =240
                            Name ="Label41"
                            Caption ="Weight:"
                            GUID = Begin
                                0xf59800a4a5b06c41995379c6e84d4e17
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =4920
                    Top =1560
                    Width =1260
                    TabIndex =8
                    BackColor =-2147483633
                    Name ="txtTotal"
                    Format ="$#,##0.00;($#,##0.00)"
                    GUID = Begin
                        0x1d0fedce1e142e4a936746033236f6d0
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =4080
                            Top =1560
                            Width =765
                            Height =240
                            Name ="Label43"
                            Caption ="Total:"
                            GUID = Begin
                                0xaed88b9051f1da4c8b78c29bd9405682
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private mblnCancel As Boolean
Private mblnAddNew As Boolean
Public flgAdd As Boolean
Private mintID As Long
Private mintPOID As Long
Private msngSingleItemWeight As Single
Private mcolDeletedSubItems As Collection

Public Property Let POID(v As Long)
  mintPOID = v
End Property

Public Property Get POItemID() As Long
  POItemID = mintID
End Property

Public Property Get Cancel() As Boolean
  Cancel = mblnCancel
End Property

Public Property Get AddNew() As Boolean
  AddNew = mblnAddNew
End Property

Private Sub chkSubItems_Click()
On Error GoTo errHandler

  If chkSubItems Then
    lvSubItems.ListItems.Clear
    cmdSubItemAdd.Enabled = True
    cmdSubItemEdit.Enabled = True
    cmdSubItemDelete.Enabled = True
    cmdSubItemAdd.Enabled = True
    cmdSubItemEdit.Enabled = True
    cmdSubItemDelete.Enabled = True
  Else
    lvSubItems.ListItems.Clear
    cmdSubItemAdd.Enabled = False
    cmdSubItemEdit.Enabled = False
    cmdSubItemDelete.Enabled = False
    cmdSubItemAdd.Enabled = False
    cmdSubItemEdit.Enabled = False
    cmdSubItemDelete.Enabled = False
  End If


Exit Sub
errHandler:
ErrHand Me.Name, "chkSubItems_Click"
Exit Sub
End Sub

Private Sub cmbCustMaterial_Click()
On Error GoTo errHandler

  If cmbCustMaterial = "" Then Exit Sub
  cmbMaterial = cmbCustMaterial.Column(2)
  cmbMaterial_Click
  
Exit Sub
errHandler:
ErrHand Me.Name, "cmbCustMaterial_Click"
Exit Sub
End Sub

Private Sub cmbMaterial_Click()
On Error GoTo errHandler

  Dim rs As Recordset
  Set rs = New Recordset
  
  ' See if we have a new record to add
  If mintID = 0 Then
    rs.Open "dbo.sp_Form_POItemAdd " & mintPOID & ", '" & cmbMaterial.Column(0) & "'", gConn, adOpenForwardOnly, adLockReadOnly
    LoadItem rs.Fields(0).Value
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "cmbMaterial_Click"
Exit Sub
End Sub

Private Sub cmdCancel_Click()

  mblnCancel = True
  mblnAddNew = False
  Visible = False
  
End Sub

Public Sub LoadItem(plngItemId As Long)
On Error GoTo errHandler

  Dim strSQL As String, rs As Recordset
  Set rs = New Recordset
  
  ' Save the id
  mintID = plngItemId
  
  ' Load the RS
  rs.Open "dbo.sp_Form_POItem " & mintID, gConn, adOpenForwardOnly, adLockReadOnly
  
  ' Set the fields
  cmbMaterial = rs.Fields("Material").Value
  cmbMaterial.BackColor = Detail.BackColor
  cmbMaterial.TabStop = False
  cmbMaterial.Locked = True
  cmbCustMaterial = Nz(rs.Fields("CustMaterial").Value, "")
  cmbCustMaterial.BackColor = Detail.BackColor
  cmbCustMaterial.TabStop = False
  cmbCustMaterial.Locked = True
  txtDescription = Nz(rs.Fields("Description").Value, "")
  txtPrice = Nz(rs.Fields("Price").Value, 0)
  txtQuantity = Nz(rs.Fields("Quantity").Value, 0)
  txtUnit = Nz(rs.Fields("Unit").Value, "")
  txtPhase = Nz(rs.Fields("Phase").Value, "")
  chkSubItems = Nz(rs.Fields("SubItems").Value, False)
  msngSingleItemWeight = Nz(rs.Fields("SingleItemWeight").Value, 0)
  If txtQuantity <> "" Then
    txtQuantity_AfterUpdate
  End If
  
  ' reenable fields
  txtDescription.Locked = False
  txtDescription.BackColor = 16777215
  txtPhase.Locked = False
  txtPhase.BackColor = 16777215
  txtQuantity.Locked = False
  txtQuantity.BackColor = 16777215
  txtPrice.Locked = False
  txtPrice.BackColor = 16777215
  txtUnit.Locked = False
  txtUnit.BackColor = 16777215
    
  Visible = True
  txtQuantity.SetFocus
  
  ' Load sub items
  chkSubItems_Click
  If chkSubItems Then LoadSubItems
  Set mcolDeletedSubItems = New Collection

  Set rs = Nothing
  
Exit Sub
errHandler:
ErrHand Me.Name, "LoadItem"
Exit Sub
End Sub

Private Sub LoadSubItems()
On Error GoTo errHandler

  Dim rs As Recordset, li As ListItem
  Set rs = New Recordset
  lvSubItems.ListItems.Clear
  
  rs.Open "dbo.sp_Form_POItemSubItems " & mintID, gConn, adOpenForwardOnly, adLockReadOnly
  Do While Not rs.EOF
    Set li = Me.lvSubItems.ListItems.Add(, , rs.Fields("apkItem").Value)
    li.SubItems(1) = Nz(rs.Fields("ItemDesc").Value, "")
    li.SubItems(2) = Nz(rs.Fields("ItemQty").Value, "")
    li.SubItems(3) = Nz(Format(rs.Fields("ItemPrice").Value, "Currency"), "")
    rs.MoveNext
  Loop
  rs.Close
  
  Set rs = Nothing
  
Exit Sub
errHandler:
ErrHand Me.Name, "LoadSubItems"
Exit Sub
End Sub

Private Sub cmdSave_Click()

  SaveChanges
  
  mblnCancel = False
  mblnAddNew = False
  Visible = False
  
End Sub

Private Sub SaveChanges()
On Error GoTo errHandler

  Dim strSQL As String, li As ListItem, v As Variant
  
  ' Update PO item
  strSQL = "dbo.sp_Form_POItemUpdate " & mintID & ", " & SQLFormatString(txtDescription) & ", " & SQLFormatString(txtPhase) & ", "
  strSQL = strSQL & txtQuantity & ", " & txtPrice & ", '" & txtUnit & "', " & IIf(chkSubItems, 1, 0)
  gConn.Execute strSQL
  
  ' loop through sub item additions and deletions
  For Each li In lvSubItems.ListItems
    If li.Tag = "add" Then
      strSQL = "dbo.sp_Form_POItemSubItemAdd " & mintID & ", " & SQLFormatString(li.SubItems(1)) & ", "
      strSQL = strSQL & li.SubItems(2) & ", " & li.SubItems(3)
      gConn.Execute strSQL
    ElseIf li.Tag = "edit" Then
      strSQL = "dbo.sp_Form_POItemSubItemEdit " & li.Text & ", " & SQLFormatString(li.SubItems(1)) & ", "
      strSQL = strSQL & li.SubItems(2) & ", " & li.SubItems(3)
      gConn.Execute strSQL
    End If
  Next li

  ' loop through any items in delete colleciton
  For Each v In mcolDeletedSubItems
    strSQL = "dbo.sp_Form_POItemSubItemDelete " & v
    gConn.Execute strSQL
  Next v
  
Exit Sub
errHandler:
ErrHand Me.Name, "SaveChanges"
Exit Sub
End Sub

Private Sub cmdSaveNew_Click()

  SaveChanges
  
  mblnCancel = False
  mblnAddNew = True
  Visible = False

End Sub

Private Sub cmdSubItemAdd_Click()
On Error GoTo errHandler

  Dim f As Form_fdlgPOItemSubItem, li As ListItem
  Set f = New Form_fdlgPOItemSubItem
  
  Pause f
  
  If Not f.Cancel Then
    Set li = lvSubItems.ListItems.Add()
    li.SubItems(1) = f.txtDescription
    li.SubItems(2) = f.txtQuantity
    li.SubItems(3) = Format(f.txtPrice, "Currency")
    li.Tag = "add"
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "cmdSubItemAdd"
Exit Sub
End Sub

Private Sub cmdSubItemDelete_Click()
On Error GoTo errHandler

  Dim li As ListItem
  Set li = Me.lvSubItems.SelectedItem
  
  If li Is Nothing Then Exit Sub
  
  If MsgBox("Are you sure you want to delete '" & li.SubItems(1) & "' from this breakdown?  Note:  This will not affect any other POs or invoices, and will also not change the default catalog listing for this item.", vbQuestion + vbYesNo) = vbYes Then
    If li.Tag <> "add" Then
      mcolDeletedSubItems.Add li.Text
    End If
    lvSubItems.ListItems.Remove li.Index
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "cmdDelete"
Exit Sub
End Sub

Private Sub cmdSubItemEdit_Click()
On Error GoTo errHandler

  Dim li As ListItem
  Set li = Me.lvSubItems.SelectedItem
  
  If li Is Nothing Then Exit Sub
  
  Dim f As Form_fdlgPOItemSubItem
  Set f = New Form_fdlgPOItemSubItem
  
  f.txtDescription = li.SubItems(1)
  f.txtQuantity = li.SubItems(2)
  f.txtPrice = li.SubItems(3)
  
  Pause f
  
  If Not f.Cancel Then
    li.SubItems(1) = f.txtDescription
    li.SubItems(2) = f.txtQuantity
    li.SubItems(3) = Format(f.txtPrice, "Currency")
    li.Tag = "edit"
  End If
  
  Set f = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "cmdSubItemEdit"
Exit Sub
End Sub

Private Sub txtQuantity_AfterUpdate()

  Dim sngQuantity As Single
  
  If txtQuantity = "" Then Exit Sub
  
  sngQuantity = Val(txtQuantity)
  
  txtWeight = msngSingleItemWeight * sngQuantity
  txtTotal = sngQuantity * Val(txtPrice)

End Sub