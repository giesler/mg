Version =19
VersionRequired =19
Checksum =-1081101962
Begin Report
    LayoutForPrint = NotDefault
    DefaultView =0
    AllowUpdating =4
    DateGrouping =1
    GrpKeepTogether =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =10807
    DatasheetFontHeight =10
    ItemSuffix =42
    Left =750
    Top =525
    Right =9000
    Bottom =5145
    DatasheetGridlinesColor =12632256
    OnNoData ="[Event Procedure]"
    Toolbar ="RFReportToolBar"
    RecSrcDt = Begin
        0xbde74a5092f6e140
    End
    InputParameters ="GetSPVar(\"ShipFromDate\"), GetSPVar(\"ShipToDate\"), GetSPVar(\"SoldName\"), Ge"
        "tSPVar(\"StoreSelName\"), GetSPVar(\"OrderFromDate\"), GetSPVar(\"OrderToDate\")"
    RecordSource ="dbo.sp_Report_GapOrderConf"
    Caption ="Gap Order Confirmation"
    OnOpen ="[Event Procedure]"
    MenuBar ="RFReportMenuBar"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xd0020000d0020000400200001a03000000000000372a0000d302000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800701000100ea0a6f08640001000f00680102000100 ,
        0x6801020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =2
            FontName ="Arial"
        End
        Begin TextBox
            OldBorderStyle =0
            TextFontFamily =2
            FontName ="Arial"
        End
        Begin UnboundObjectFrame
            OldBorderStyle =1
        End
        Begin BreakLevel
            GroupHeader = NotDefault
            ControlSource ="Date_Ordered"
        End
        Begin PageHeader
            Height =3240
            Name ="PageHeader"
            Begin
                Begin Label
                    FontUnderline = NotDefault
                    TextAlign =2
                    TextFontFamily =34
                    Left =7
                    Top =1080
                    Width =10800
                    Height =705
                    FontSize =26
                    ForeColor =8388736
                    Name ="Label5"
                    Caption ="GAP ORDER CONFIRMATION"
                End
                Begin Label
                    TextFontFamily =34
                    Left =120
                    Top =2760
                    Width =1680
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label19"
                    Caption ="CITY/STATE"
                End
                Begin Label
                    TextFontFamily =34
                    Left =1800
                    Top =2760
                    Width =1440
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label20"
                    Caption ="PO #"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =3960
                    Top =2640
                    Width =840
                    Height =480
                    FontSize =10
                    FontWeight =700
                    Name ="Label22"
                    Caption ="ARRIVE\015\012DATE"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =4920
                    Top =2640
                    Width =720
                    Height =480
                    FontSize =10
                    FontWeight =700
                    Name ="Label23"
                    Caption ="SHIP\015\012DATE"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =5760
                    Top =2760
                    Width =1080
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label24"
                    Caption ="CARRIER"
                End
                Begin Label
                    TextFontFamily =34
                    Left =6840
                    Top =2760
                    Width =2520
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label25"
                    Caption ="COMMENTS"
                End
                Begin Line
                    Top =3120
                    Width =10800
                    Name ="Line26"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =9360
                    Top =2760
                    Width =1440
                    Height =360
                    FontSize =10
                    FontWeight =700
                    Name ="Label36"
                    Caption ="Priority"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Left =3240
                    Top =2640
                    Width =795
                    Height =480
                    FontSize =10
                    FontWeight =700
                    Name ="Label38"
                    Caption ="SHELF TYPE"
                End
                Begin Line
                    BorderWidth =1
                    Top =691
                    Width =10800
                    Name ="Line0"
                End
                Begin Subform
                    OldBorderStyle =0
                    Width =7140
                    Height =1047
                    Name ="subLogo"
                    SourceObject ="Report.rsubLogo"
                End
                Begin Label
                    TextAlign =2
                    TextFontFamily =34
                    Top =1920
                    Width =10800
                    Height =360
                    FontSize =12
                    FontWeight =700
                    Name ="lblCriteria"
                    GUID = Begin
                        0x4d887a17bbaa49459218311999237475
                    End
                End
            End
        End
        Begin BreakHeader
            KeepTogether = NotDefault
            Height =360
            Name ="GroupHeader0"
            Begin
                Begin TextBox
                    TextFontFamily =34
                    Left =120
                    Top =60
                    Width =4320
                    Height =300
                    FontSize =10
                    FontWeight =700
                    Name ="txtdate"
                    ControlSource ="=\"Date Ordered: \" & [Date_Ordered]"
                End
            End
        End
        Begin Section
            KeepTogether = NotDefault
            CanGrow = NotDefault
            Height =723
            Name ="Detail"
            Begin
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =4800
                    Width =960
                    Height =720
                    FontSize =10
                    Name ="Ship_Date"
                    ControlSource ="Ship_Date"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextFontFamily =34
                    Left =120
                    Width =1680
                    Height =720
                    FontSize =10
                    TabIndex =1
                    Name ="CITY_STATE"
                    ControlSource ="CITY_STATE"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =3960
                    Width =840
                    Height =720
                    FontSize =10
                    TabIndex =2
                    Name ="Arrive_Date"
                    ControlSource ="Arrive_Date"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =5760
                    Width =1080
                    Height =720
                    FontSize =10
                    TabIndex =3
                    Name ="Ship_via"
                    ControlSource ="Ship_via"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    TextFontFamily =34
                    Left =6840
                    Width =2520
                    Height =723
                    FontSize =10
                    TabIndex =4
                    Name ="FirstOfComments"
                    ControlSource ="Comments"
                End
                Begin TextBox
                    CanGrow = NotDefault
                    OldBorderStyle =1
                    TextFontFamily =34
                    Left =1800
                    Height =720
                    FontSize =11
                    TabIndex =5
                    Name ="PO"
                    ControlSource ="PONumber"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =9360
                    Height =723
                    FontSize =10
                    TabIndex =6
                    Name ="Priority"
                    ControlSource ="Priority"
                End
                Begin TextBox
                    OldBorderStyle =1
                    TextAlign =2
                    TextFontFamily =34
                    Left =3240
                    Width =720
                    Height =720
                    FontSize =10
                    TabIndex =7
                    Name ="Text39"
                    ControlSource ="ShelfType"
                End
            End
        End
        Begin PageFooter
            Height =300
            Name ="PageFooter"
            Begin
                Begin Line
                    BorderWidth =1
                    Width =10695
                    Name ="Line55"
                    GUID = Begin
                        0x5e605e8543becd459e01c31f5af9f3b4
                    End
                End
                Begin TextBox
                    FontItalic = NotDefault
                    TextAlign =2
                    TextFontFamily =34
                    Left =3240
                    Top =60
                    Width =4200
                    Name ="Text47"
                    ControlSource ="=\"Printed \" & Date()"
                    GUID = Begin
                        0xd7fde14bec73424985cb3415199eefa5
                    End
                End
                Begin Label
                    FontItalic = NotDefault
                    TextAlign =1
                    TextFontFamily =34
                    Left =60
                    Top =60
                    Width =3120
                    Height =240
                    Name ="Text56"
                    Caption ="Retail Fixture, LLC."
                    GUID = Begin
                        0x5ec6d48549c97c4d9685c91948fce576
                    End
                End
                Begin TextBox
                    FontItalic = NotDefault
                    TextAlign =3
                    TextFontFamily =34
                    Left =7500
                    Top =60
                    Width =3120
                    TabIndex =1
                    Name ="Text57"
                    ControlSource ="=\"Page \" & [Page] & \" of \" & [Pages]"
                    GUID = Begin
                        0xfc0baa3f2ce6bf4d83db9d9ec22e5115
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub Report_NoData(Cancel As Integer)
MsgBox "There were no POs for the criteria entered: " & vbCrLf & Me.lblCriteria.Caption, vbExclamation
Cancel = True
End Sub


Private Sub Report_Open(Cancel As Integer)
On Error GoTo errHandler

  Dim fC As Form_frptGapOrderConf, strCrit As String, strTemp As String
  Set fC = New Form_frptGapOrderConf
  fC.Caption = Me.Caption
  
  Pause fC

  If fC.mblnCancel Then
    Cancel = True
  Else
    SetSPVar "ShipFromDate", fC.datFrom
    SetSPVar "ShipToDate", fC.datTo
    SetSPVar "OrderFromDate", fC.datOrderFrom
    SetSPVar "OrderToDate", fC.datOrderTo
    SetSPVar "SoldName", fC.cmbSoldName
    SetSPVar "StoreSelName", Null
    strTemp = FormatFromTo(fC.datOrderFrom, fC.datOrderTo)
    If strTemp <> "" Then
      strTemp = "Order Date " + strTemp
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit + strTemp
    End If
    strTemp = FormatFromTo(fC.datFrom, fC.datTo)
    If strTemp <> "" Then
      strTemp = "Ship Date " + strTemp
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit + strTemp
    End If
    If fC.cmbSoldName <> "" Then
      If strCrit <> "" Then strCrit = strCrit + ", "
      strCrit = strCrit + "Customer: " + fC.cmbSoldName
    End If
    
    'Store
    gConn.Execute "DELETE FROM ztmpStoreSel WHERE StoreSelName = '" + GetNTUserName() + "'"
    If fC.lstStore.ItemsSelected.Count > 0 Then
      SetSPVar "StoreSelName", GetNTUserName()
      Dim crit As String, msg As String, varItm As Variant
      If strCrit <> "" Then strCrit = strCrit + ", "
      For Each varItm In fC.lstStore.ItemsSelected
        gConn.Execute "insert ztmpStoreSel (Store, StoreSelName) values ('" + DQ(fC.lstStore.ItemData(varItm)) + "', '" + GetNTUserName() + "')"
        If msg <> "" Then msg = msg & ", " Else msg = "Store: "
        msg = msg & fC.lstStore.ItemData(varItm)
      Next varItm
      strCrit = strCrit & msg
    End If
    Me.lblCriteria.Caption = strCrit
  End If
  
  Set fC = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "Report_Open"
Exit Sub
End Sub