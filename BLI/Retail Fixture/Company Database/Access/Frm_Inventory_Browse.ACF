Version =19
VersionRequired =19
Checksum =-1102081569
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowUpdating =4
    ScrollBars =2
    ViewsAllowed =1
    GridX =24
    GridY =24
    Width =9639
    ItemSuffix =130
    Left =795
    Top =1110
    Right =10680
    Bottom =5775
    RecSrcDt = Begin
        0x6e638b0db4f6e140
    End
    UniqueTable ="dbo.Tbl_Catalog"
    RecordSource ="SELECT dbo.Tbl_Catalog.*, dbo.Tbl_Catalog_Headings.Heading_Desc, dbo.Tbl_Catalog"
        ".Inventory - dbo.Tbl_Catalog.[Committed] AS Available FROM dbo.Tbl_Catalog_Headi"
        "ngs INNER JOIN dbo.Tbl_Catalog ON dbo.Tbl_Catalog_Headings.apkHeading = dbo.Tbl_"
        "Catalog.afkCatalogHeading ORDER BY dbo.Tbl_Catalog_Headings.Heading_Number, dbo."
        "Tbl_Catalog.Material"
    Caption ="Inventory"
    MenuBar ="RFFormMenuBar"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c0034020367000401000100ea0a6f086400010001002c0101000100 ,
        0x2c01020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
        End
        Begin FormHeader
            CanGrow = NotDefault
            Height =1080
            BackColor =-2147483633
            Name ="FormHeader0"
            Begin
                Begin Label
                    OverlapFlags =93
                    Left =300
                    Top =840
                    Width =2280
                    Height =240
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Heading_Number"
                    Caption ="Heading"
                End
                Begin Label
                    OverlapFlags =95
                    Left =2580
                    Top =840
                    Width =1080
                    Height =240
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Material"
                    Caption ="Material"
                End
                Begin Label
                    OverlapFlags =87
                    Left =3660
                    Top =840
                    Width =3240
                    Height =240
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Text7"
                    Caption ="Description"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =6924
                    Top =840
                    Width =720
                    Height =240
                    BorderColor =4210752
                    Name ="Quanity"
                    Caption ="Qty"
                End
                Begin Label
                    OverlapFlags =95
                    Left =7644
                    Top =840
                    Width =864
                    Height =240
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Committed"
                    Caption ="Committed"
                End
                Begin Label
                    OverlapFlags =87
                    Left =8508
                    Top =840
                    Width =864
                    Height =240
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Label126"
                    Caption ="Available"
                End
                Begin ComboBox
                    OverlapFlags =85
                    ListWidth =1440
                    Left =3060
                    Top =540
                    Width =2940
                    ColumnInfo ="\"\";\"\";\"10\";\"255\""
                    Name ="comFindHeading"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT  Tbl_Catalog_Headings.Heading_Desc FROM Tbl_Catalog_Headings ORDER BY Tbl"
                        "_Catalog_Headings.Heading_Desc"
                    ColumnWidths ="1440"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =780
                            Top =540
                            Width =2160
                            Height =240
                            Name ="comFindHeading_Label"
                            Caption ="Jump to a heading:"
                        End
                    End
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    Left =120
                    Top =60
                    Width =4395
                    Height =420
                    FontSize =14
                    FontWeight =700
                    ForeColor =128
                    Name ="Label - Page"
                    Caption ="Inventory"
                    EventProcPrefix ="Label___Page"
                    GUID = Begin
                        0x331f286e5b5b784884e102ca815a29c4
                    End
                End
                Begin Line
                    BorderWidth =2
                    OverlapFlags =87
                    Top =480
                    Width =9639
                    BorderColor =32768
                    Name ="Line9"
                    GUID = Begin
                        0x163ce3235bea0744b2c88efb2c7ec748
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =240
            BackColor =-2147483633
            Name ="Detail0"
            Begin
                Begin TextBox
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =93
                    TextAlign =2
                    Left =6912
                    Width =720
                    BorderColor =4210752
                    Name ="Text121"
                    ControlSource ="Inventory"
                    StatusBarText ="Quanity Entered"
                End
                Begin TextBox
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =7632
                    Width =864
                    TabIndex =2
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Text123"
                    ControlSource ="Committed"
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =2568
                    Width =1080
                    TabIndex =3
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Text124"
                    ControlSource ="Material"
                    StatusBarText ="Material # (Catalog #)"
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =3648
                    Width =3240
                    TabIndex =4
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Text125"
                    ControlSource ="Description"
                    StatusBarText ="Material Number (Catalog #)"
                End
                Begin TextBox
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =8496
                    Width =864
                    TabIndex =5
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Text127"
                    ControlSource ="Available"
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =288
                    Width =2280
                    TabIndex =1
                    BackColor =-2147483633
                    BorderColor =4210752
                    Name ="Combo122"
                    ControlSource ="Heading_Desc"
                    StatusBarText ="heading the item falls under"
                End
            End
        End
        Begin FormFooter
            Height =480
            BackColor =8421376
            Name ="FormFooter1"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =67
                    TextFontFamily =34
                    Left =8340
                    Top =60
                    Width =1008
                    FontWeight =400
                    Name ="Close"
                    Caption ="&Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons

Private Sub Close_Click()
    DoCmd.Close
End Sub

Private Sub comFindHeading_Click()
On Error GoTo comFindHeading_Err

  Dim rs As Recordset
  If IsNull(Me.comFindHeading) Then Exit Sub
  
  Set rs = Me.RecordsetClone
  rs.MoveFirst
  rs.Find "Heading_Desc = '" + Me.comFindHeading + "'"
  If rs.EOF Then
    MsgBox "There is no inventory under the heading '" + Me.comFindHeading + "'."
  Else
    Me.Bookmark = rs.Bookmark
  End If
  Set rs = Nothing
  
Exit Sub
comFindHeading_Err:
ErrHand Me.Name, "comFindHeading"
Exit Sub

End Sub

Private Sub Form_Load()
On Error GoTo errHandler
  
  If MsgBox("Inventory should now be managed in the RFC Catalog.  Would you like to open the RFC Catalog instead?", vbQuestion + vbYesNo) = vbYes Then
    DoCmd.Close acForm, Me.Name
    DoCmd.OpenForm "frmCatalog"
    Exit Sub
  End If
  
  Dim strSQL As String

  OpenWaitForm "Updating totals..."
  gConn.Execute "delete from ztmpCommittedTotals"
  strSQL = "INSERT INTO ztmpCommittedTotals ( Material, qtyCommitted ) "
  strSQL = strSQL + "SELECT Tbl_PO_Items.Material, Sum(Tbl_PO_Items.Quanity) AS qtyCommitted "
  strSQL = strSQL + "FROM Tbl_PO INNER JOIN (Tbl_PO_Items LEFT JOIN Tbl_Invoice ON Tbl_PO_Items.ID = Tbl_Invoice.ID) ON Tbl_PO.ID = Tbl_PO_Items.ID "
  strSQL = strSQL + "WHERE (((Tbl_PO.CANCELPO) = 0)) GROUP BY Tbl_PO_Items.Material, Tbl_Invoice.ID "
  strSQL = strSQL + "HAVING (((Tbl_Invoice.ID) Is Null))"
  gConn.Execute strSQL
  strSQL = "UPDATE Tbl_Catalog SET Tbl_Catalog.[Committed] = ztmpCommittedTotals.qtyCommitted FROM Tbl_Catalog INNER JOIN ztmpCommittedTotals ON Tbl_Catalog.Material = ztmpCommittedTotals.Material"
  gConn.Execute strSQL
  CloseWaitForm

Exit Sub
errHandler:
ErrHand Me.Name, "Form_Load"
Exit Sub
End Sub