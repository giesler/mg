Version =19
VersionRequired =19
Checksum =591733328
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    GridX =24
    GridY =24
    Width =11880
    ItemSuffix =165
    Left =795
    Top =720
    Right =11505
    Bottom =6495
    RecSrcDt = Begin
        0x8595809c7478e140
    End
    Caption ="Catalog"
    MenuBar ="RFFormMenuBar"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c0034020367000401000100ea0a6f086400010001002c0101000100 ,
        0x2c01020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ListBox
            SpecialEffect =2
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
        End
        Begin FormHeader
            CanGrow = NotDefault
            Height =480
            BackColor =-2147483633
            Name ="FormHeader0"
            Begin
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    Left =120
                    Top =60
                    Width =1860
                    Height =420
                    FontSize =14
                    FontWeight =700
                    ForeColor =128
                    Name ="Label - Page"
                    Caption ="Catalog"
                    EventProcPrefix ="Label___Page"
                End
                Begin Line
                    BorderWidth =2
                    OverlapFlags =87
                    Top =480
                    Width =11880
                    BorderColor =32768
                    Name ="Line9"
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    ListWidth =2145
                    Left =9600
                    Top =120
                    Width =2160
                    GUID = Begin
                        0xe349527ba0285c42819225783a4de310
                    End
                    Name ="comShow"
                    RowSourceType ="Value List"
                    RowSource ="\"Catalog Information\";\"Inventory Information\""
                    ColumnWidths ="2145"
                    DefaultValue ="\"Catalog Information\""
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =8880
                            Top =120
                            Width =600
                            Height =240
                            Name ="Show:_Label"
                            Caption ="Show:"
                            EventProcPrefix ="Show__Label"
                            GUID = Begin
                                0xa695ab01b4438144b493a03cb058ba7b
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =87
                    IMESentenceMode =3
                    Left =3300
                    Top =120
                    Width =1200
                    TabIndex =1
                    Name ="txtMaterial"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    GUID = Begin
                        0x63b3662f71dac040aedf12c1dc399ae4
                    End
                    Begin
                        Begin Label
                            OverlapFlags =95
                            Left =1980
                            Top =120
                            Width =1320
                            Height =240
                            Name ="Label160"
                            Caption ="Find RF Material:"
                            GUID = Begin
                                0x41cc38503fe9ce43901ce91102381ec0
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =70
                    TextFontFamily =34
                    Left =4560
                    Top =120
                    Width =540
                    Height =240
                    FontSize =6
                    FontWeight =400
                    TabIndex =2
                    Name ="cmdFindMaterial"
                    Caption ="&Find"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0x88f47103ca08fa4aabb8e5d7e6623eab
                    End
                End
                Begin TextBox
                    OverlapFlags =87
                    IMESentenceMode =3
                    Left =6900
                    Top =120
                    Width =1200
                    TabIndex =3
                    Name ="txtCustMaterial"
                    OnGotFocus ="[Event Procedure]"
                    OnLostFocus ="[Event Procedure]"
                    GUID = Begin
                        0xa0760d60854882448231499fb46f3dc3
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =5400
                            Top =120
                            Width =1500
                            Height =240
                            Name ="Label163"
                            Caption ="Find Cust Material:"
                            GUID = Begin
                                0x52ade3ad0d6faf489bdbd28d1971e6fe
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =70
                    TextFontFamily =34
                    Left =8160
                    Top =120
                    Width =540
                    Height =240
                    FontSize =6
                    FontWeight =400
                    TabIndex =4
                    Name ="cmdFindCustMaterial"
                    Caption ="&Find"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0xd0cf5180d940d5418f662e6ad0a0f4ec
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =6120
            BackColor =-2147483633
            Name ="Detail0"
            Begin
                Begin ListBox
                    ColumnHeads = NotDefault
                    OverlapFlags =87
                    ColumnCount =4
                    Left =180
                    Top =300
                    Width =10080
                    Height =1680
                    Name ="lstCatHeadings"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT Tbl_Catalog_Headings.apkHeading, Tbl_Catalog_Headings.Heading_Number AS ["
                        "Order], Tbl_Catalog_Headings.Heading_Desc AS Description, tblSold.SoldName AS Cu"
                        "stomer FROM Tbl_Catalog_Headings LEFT JOIN tblSold ON Tbl_Catalog_Headings.afkHe"
                        "adCust = tblSold.apkSold ORDER BY Tbl_Catalog_Headings.Heading_Number"
                    ColumnWidths ="0;720;6480;1860"
                    OnDblClick ="[Event Procedure]"
                    DefaultValue ="=Null"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =300
                            Top =60
                            Width =2280
                            Height =240
                            Name ="Catalog Headings_Label"
                            Caption ="Catalog Headings"
                            EventProcPrefix ="Catalog_Headings_Label"
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =84
                    TextFontFamily =34
                    Left =10320
                    Top =360
                    Width =960
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =1
                    Name ="cmdCHEdit"
                    Caption ="Edi&t"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10320
                    Top =1080
                    Width =960
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =2
                    Name ="cmdCHDelete"
                    Caption ="Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
                Begin ListBox
                    ColumnHeads = NotDefault
                    Visible = NotDefault
                    OverlapFlags =215
                    ColumnCount =11
                    Left =180
                    Top =2280
                    Width =10080
                    Height =3720
                    TabIndex =3
                    Name ="lstCatalogItems"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;1080;720;4680;1080;720;360;360;360;360;360"
                    OnDblClick ="[Event Procedure]"
                    DefaultValue ="=Null"
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =300
                            Top =2040
                            Width =7680
                            Height =240
                            Name ="lblCatItems"
                            Caption ="Catalog Items"
                        End
                    End
                End
                Begin Label
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =180
                    Top =2280
                    Width =9840
                    Height =3720
                    Name ="lblCatSelect"
                    Caption ="Select a catalog heading above."
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =69
                    TextFontFamily =34
                    Left =10320
                    Top =2340
                    Width =960
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =4
                    Name ="cmdCIEdit"
                    Caption ="&Edit"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =68
                    TextFontFamily =34
                    Left =10320
                    Top =3060
                    Width =960
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =5
                    Name ="cmdCIDelete"
                    Caption ="&Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =78
                    TextFontFamily =34
                    Left =10320
                    Top =2700
                    Width =960
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =6
                    Name ="cmdCINew"
                    Caption ="&New"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10320
                    Top =720
                    Width =960
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =7
                    Name ="cmdCHNew"
                    Caption ="New"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
                Begin Label
                    OverlapFlags =85
                    Left =10320
                    Top =3480
                    Width =1440
                    Height =1140
                    Name ="Label154"
                    Caption ="Wh=Wheatboard\015\012Ac=Active\015\012Hid=Hide\015\012Brk=Breakdown\015\012CW=Ca"
                        "shwrap"
                    GUID = Begin
                        0xe965ca411283cd46b543951badc90ab6
                    End
                End
            End
        End
        Begin FormFooter
            Height =480
            BackColor =8421376
            Name ="FormFooter1"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =67
                    TextFontFamily =34
                    Left =7920
                    Top =60
                    Width =864
                    FontWeight =400
                    Name ="cmdClose"
                    Caption ="&Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons

Public mblnCatalogItems As Boolean

Private Sub Close_Click()
    DoCmd.Close
End Sub

Private Sub Command107_Click()
    DoCmd.OpenForm "frm_purchase_orders", , , , acFormAdd
    
End Sub

Private Sub cmdCHDelete_Click()

If IsNull(Me.lstCatHeadings) Then
    MsgBox "You must select a catalog heading to delete!", vbExclamation
    Exit Sub
End If

If MsgBox("Are you sure you want to delete this catalog heading?  Deleting it also deletes all items under this heading.", vbQuestion + vbYesNo) = vbYes Then
    gConn.Execute "delete from Tbl_Catalog Where afkCatalogHeading = " & Me.lstCatHeadings
    gConn.Execute "Delete from [Tbl_Catalog_Headings] Where apkHeading = " & Me.lstCatHeadings
    Me.lstCatHeadings.Requery
    Me.lstCatHeadings = Null
End If
Me.lstCatalogItems.Visible = False


End Sub

Private Sub cmdCHEdit_Click()
If IsNull(Me.lstCatHeadings) Then
    MsgBox "You must select an catalog heading to edit!" & vbCrLf & "Note:  You can also simply double click a heading to edit it.", vbExclamation
    Exit Sub
End If
lstCatHeadings_DblClick (False)

End Sub

Private Sub cmdCHNew_Click()

Dim fAdd As New Form_fdlgCatalogHeading
fAdd.DataEntry = True
fAdd.Visible = True
Pause fAdd
If Not fAdd.bolCancel Then
    Me.lstCatHeadings.Requery
End If
Set fAdd = Nothing


End Sub

Private Sub cmdCIDelete_Click()

If IsNull(Me.lstCatalogItems) Then
    MsgBox "You must select a catalog item to delete!", vbExclamation
    Exit Sub
End If

If MsgBox("Are you sure you want to delete '" & Me.lstCatalogItems.Column(2) & "'?", vbQuestion + vbYesNo) = vbYes Then
    gConn.Execute "Delete From [Tbl_Catalog] Where apkCatalogItem = " & Me.lstCatalogItems
    Me.lstCatalogItems.Requery
    Me.lstCatalogItems = Null
End If

End Sub

Private Sub cmdCIEdit_Click()

If IsNull(Me.lstCatalogItems) Then
    MsgBox "You must select an catalog item to edit!" & vbCrLf & "Note:  You can also simply double click an item to edit it.", vbExclamation
    Exit Sub
End If
lstCatalogItems_DblClick (False)

End Sub

Private Sub cmdCINew_Click()

If IsNull(Me.lstCatHeadings) Then
    MsgBox "You must select an catalog heading to add new items to!", vbExclamation
    Exit Sub
End If

Dim fAdd As New Form_fdlgCatalogItem
fAdd.flgAdd = True
fAdd.DataEntry = True
fAdd.comafkCatalogHeading = Me.lstCatHeadings
fAdd.Visible = True
Pause fAdd
If Not fAdd.bolCancel Then
    Me.lstCatalogItems.Requery
End If
Set fAdd = Nothing

End Sub

Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click


    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.Description
    Resume Exit_cmdClose_Click
    
End Sub

Private Sub cmdFindCustMaterial_Click()
On Error GoTo errHandler

    If IsNull(Me.txtCustMaterial) Or Me.txtCustMaterial = "" Then
        MsgBox "You must enter a cust material to find it!", vbExclamation
        Exit Sub
    End If
    
    Dim rs As Recordset
    Set rs = New Recordset
    
    rs.Open "select afkCatalogHeading, apkCatalogItem from Tbl_Catalog where custmaterial = '" & Me.txtCustMaterial & "'", gConn, adOpenForwardOnly, adLockReadOnly
    
    If rs.BOF And rs.EOF Then
        MsgBox "The customer material '" & Me.txtCustMaterial & "' was not found.", vbExclamation
    Else
        Me.lstCatHeadings.Value = rs.Fields("afkCatalogHeading")
        lstCatHeadings_Click
        Me.lstCatalogItems.Value = rs.Fields("apkCatalogItem")
    End If
    
    rs.Close
    Set rs = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "cmdFindCustMaterial"
Exit Sub

End Sub

Private Sub cmdFindMaterial_Click()
On Error GoTo errHandler

    If IsNull(Me.txtMaterial) Or Me.txtMaterial = "" Then
        MsgBox "You must enter a material to find it!", vbExclamation
        Exit Sub
    End If
    
    Dim rs As Recordset
    Set rs = New Recordset
    
    rs.Open "select afkCatalogHeading, apkCatalogItem from Tbl_Catalog where material = '" & Me.txtMaterial & "'", gConn, adOpenForwardOnly, adLockReadOnly
    
    If rs.BOF And rs.EOF Then
        MsgBox "The material '" & Me.txtMaterial & "' was not found.", vbExclamation
    Else
        Me.lstCatHeadings.Value = rs.Fields("afkCatalogHeading")
        lstCatHeadings_Click
        Me.lstCatalogItems.Value = rs.Fields("apkCatalogItem")
    End If
    
    rs.Close
    Set rs = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "cmdFindMaterial"
Exit Sub
End Sub

Private Sub comShow_Click()
On Error GoTo errHandler

  If IsNull(Me.comShow) Then Exit Sub
  If Me.comShow = "Catalog Information" Then
    mblnCatalogItems = True
    Me.lstCatalogItems.ColumnCount = 10
    Me.lstCatalogItems.ColumnWidths = "0"";0.75"";0.75"";3.25"";0.5"";0.45"";0.25"";0.25"";0.25"";0.25"";0.25"""
  Else
    mblnCatalogItems = False
    Me.lstCatalogItems.ColumnCount = 8
    Me.lstCatalogItems.ColumnWidths = "0"";0.75"";0.75"";3.25"";0.5"";0.45"";0.5"";0.5"";0.5"""
  End If
  If Not IsNull(Me.lstCatHeadings) Then lstCatHeadings_Click

Exit Sub
errHandler:
ErrHand Me.Name, "comShow"
Exit Sub
End Sub

Private Sub Form_Load()
On Error GoTo errHandler

  mblnCatalogItems = True
  
  OpenWaitForm "Updating totals..."
  gConn.Execute "delete from ztmpCommittedTotals"
  strSQL = "INSERT INTO ztmpCommittedTotals ( Material, qtyCommitted ) "
  strSQL = strSQL + "SELECT Tbl_PO_Items.Material, Sum(Tbl_PO_Items.Quanity) AS qtyCommitted "
  strSQL = strSQL + "FROM Tbl_PO INNER JOIN (Tbl_PO_Items LEFT JOIN Tbl_Invoice ON Tbl_PO_Items.ID = Tbl_Invoice.ID) ON Tbl_PO.ID = Tbl_PO_Items.ID "
  strSQL = strSQL + "WHERE (((Tbl_PO.CANCELPO) = 0)) GROUP BY Tbl_PO_Items.Material, Tbl_Invoice.ID "
  strSQL = strSQL + "HAVING (((Tbl_Invoice.ID) Is Null))"
  gConn.Execute strSQL
  strSQL = "UPDATE Tbl_Catalog SET Tbl_Catalog.[Committed] = ztmpCommittedTotals.qtyCommitted FROM Tbl_Catalog INNER JOIN ztmpCommittedTotals ON Tbl_Catalog.Material = ztmpCommittedTotals.Material"
  gConn.Execute strSQL
  CloseWaitForm
  
  comShow_Click

Exit Sub
errHandler:
ErrHand Me.Name, "Form_Load"
Exit Sub
End Sub

Private Sub lstCatalogItems_DblClick(Cancel As Integer)
On Error GoTo errHandler

  Dim fCH As New Form_fdlgCatalogItem, pk As Long
  
  pk = Me.lstCatalogItems
  
  fCH.Filter = "apkCatalogItem = " & pk
  fCH.FilterOn = True
  fCH.mblnCatalogItems = mblnCatalogItems
  Pause fCH
  
  If Not fCH.bolCancel Then
    Me.lstCatalogItems.Requery
  End If

  Set fCH = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "lstCatalogItems_DblClick_Err"
Exit Sub
End Sub

Private Sub lstCatHeadings_Click()
On Error GoTo errHandler
  
  Dim strSQL As String
  
  If mblnCatalogItems Then
    strSQL = "SELECT apkCatalogItem, Material, CustMaterial, Description, Price, Weight, "
    strSQL = strSQL + "CASE Medite WHEN 1 THEN 'Y' ELSE 'N' END AS Wh, "
    strSQL = strSQL + "CASE Active WHEN 1 THEN 'Y' ELSE 'N' END AS Act, "
    strSQL = strSQL + "CASE Hide WHEN 1 THEN 'Y' ELSE 'N' END AS Hid, "
    strSQL = strSQL + "CASE SubItems WHEN 1 THEN 'Y' ELSE 'N' END AS Brk, "
    strSQL = strSQL + "CASE CashWrap WHEN 1 THEN 'Y' ELSE 'N' END AS CW "
    strSQL = strSQL + "FROM Tbl_Catalog WHERE afkCatalogHeading = " & Me.lstCatHeadings & " ORDER BY Material"
  Else
    strSQL = "SELECT apkCatalogItem, Material, CustMaterial, Description, Price, Weight, "
    strSQL = strSQL + "Inventory AS Qty, "
    strSQL = strSQL + "[Committed] AS Cmtd, "
    strSQL = strSQL + "Inventory - [Committed] AS Avail "
    strSQL = strSQL + "FROM Tbl_Catalog WHERE afkCatalogHeading = " & Me.lstCatHeadings & " ORDER BY Material"
    Debug.Print strSQL
  End If
  
  Me.lstCatalogItems.RowSource = strSQL
  Me.lstCatalogItems.Requery
  Me.lstCatalogItems.Visible = True
  
  Me.lblCatItems.Caption = Me.lstCatHeadings.Column(2)

Exit Sub
errHandler:
ErrHand Me.Name, "CatHeadings_Click"
Exit Sub
End Sub

Private Sub lstCatHeadings_DblClick(Cancel As Integer)
On Error GoTo lstCatHeadingsDBCL_Err

Dim fCH As New Form_fdlgCatalogHeading, pk As Long, row As Long

pk = Me.lstCatHeadings

fCH.Filter = "apkHeading = " & pk
fCH.FilterOn = True

Pause fCH

If Not fCH.bolCancel Then
    Me.lstCatHeadings.Requery
End If

Set fCH = Nothing

Exit Sub
lstCatHeadingsDBCL_Err:
ErrHand Me.Name, "lstCatHeadings_DBCL"
Exit Sub

End Sub

Private Sub txtCustMaterial_GotFocus()
  cmdFindCustMaterial.Default = True
End Sub

Private Sub txtCustMaterial_LostFocus()
  cmdFindCustMaterial.Default = False
End Sub

Private Sub txtMaterial_Enter()
    cmdFindMaterial.Default = True
End Sub

Private Sub txtMaterial_Exit(Cancel As Integer)
    cmdFindMaterial.Default = False
End Sub