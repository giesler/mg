Version =19
VersionRequired =19
Checksum =-195780448
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =5640
    DatasheetFontHeight =10
    ItemSuffix =32
    Left =7635
    Top =5625
    Right =13275
    Bottom =9450
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x8c25bf786c7be140
    End
    Caption ="Cashwrap Shipments for Fisher"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800501000100ea0a6f08640001000f00680101000100 ,
        0x6801020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Section
            Height =4140
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =79
                    Left =3060
                    Top =3720
                    Width =1020
                    Height =300
                    TabIndex =8
                    Name ="cmdOK"
                    Caption ="&OK"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    AccessKey =67
                    Left =4200
                    Top =3720
                    Width =1020
                    Height =300
                    TabIndex =9
                    Name ="cmdCancel"
                    Caption ="&Cancel"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =120
                    Top =120
                    Width =5400
                    Height =405
                    BackColor =-2147483624
                    ForeColor =-2147483625
                    Name ="Label17"
                    Caption ="You can enter any information you want.  Note: Cashwrap materials are automatica"
                        "lly selected."
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =66
                    Left =4200
                    Top =3060
                    Width =1020
                    Height =300
                    TabIndex =6
                    Name ="cmdBrowse"
                    Caption ="&Browse"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x69d8f4e6992cd3119033004033532b7f
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =1230
                    Top =3060
                    Width =2850
                    TabIndex =5
                    Name ="txtFileName"
                    DefaultValue ="\"c:\\Cashwrap Shipments for Fisher.html\""
                    GUID = Begin
                        0x6fd8f4e6992cd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =120
                            Top =3060
                            Width =1020
                            Height =240
                            Name ="Label20"
                            Caption ="Save As:"
                            GUID = Begin
                                0x70d8f4e6992cd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =1260
                    Top =3420
                    Width =2945
                    TabIndex =7
                    Name ="chkLaunchPage"
                    DefaultValue ="True"
                    GUID = Begin
                        0x5ad9f4e6992cd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1490
                            Top =3390
                            Width =2655
                            Height =240
                            Name ="Label23"
                            Caption ="View report in web browser."
                            GUID = Begin
                                0x5cd9f4e6992cd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =93
                    Left =1350
                    Top =960
                    Width =1080
                    Name ="datFrom"
                    InputMask ="99/99/00;0;_"
                    GUID = Begin
                        0x869a95a8422fd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =240
                            Top =960
                            Width =1020
                            Height =240
                            Name ="Label1"
                            Caption ="From:"
                            GUID = Begin
                                0x879a95a8422fd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =93
                    Left =1350
                    Top =1320
                    Width =1080
                    TabIndex =1
                    Name ="datTo"
                    InputMask ="99/99/00;0;_"
                    GUID = Begin
                        0x889a95a8422fd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =240
                            Top =1320
                            Width =1020
                            Height =240
                            Name ="Label24"
                            Caption ="To:"
                            GUID = Begin
                                0x899a95a8422fd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =5
                    Top =2970
                    Width =5580
                    Name ="Line26"
                    GUID = Begin
                        0x8c9a95a8422fd3119033004033532b7f
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    ListWidth =3600
                    Left =1350
                    Top =1800
                    Width =1770
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    GUID = Begin
                        0xb80271dcac4ad311bb05004033532b7f
                    End
                    Name ="comCustomer"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tblSold.SoldName FROM tblSold ORDER BY tblSold.SoldName"
                    ColumnWidths ="2520"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =1800
                            Width =1020
                            Height =240
                            Name ="Label25"
                            Caption ="Customer:"
                            GUID = Begin
                                0xbb0271dcac4ad311bb05004033532b7f
                            End
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    AccessKey =83
                    Left =1380
                    Top =2550
                    Width =2040
                    Height =180
                    TabIndex =4
                    Name ="chkShade"
                    DefaultValue ="True"
                    GUID = Begin
                        0xec0271dcac4ad311bb05004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1610
                            Top =2520
                            Width =1815
                            Height =240
                            Name ="Label28"
                            Caption ="&Shade every other line"
                            GUID = Begin
                                0xee0271dcac4ad311bb05004033532b7f
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =3660
                    Top =660
                    Width =660
                    Height =240
                    Name ="Label9"
                    Caption ="Store: "
                    GUID = Begin
                        0xb90a70bca3d53c4daf70161474162ccd
                    End
                End
                Begin ListBox
                    OverlapFlags =85
                    MultiSelect =1
                    Left =3600
                    Top =960
                    Width =1920
                    Height =1500
                    TabIndex =10
                    Name ="lstStore"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuStore.StoreName FROM tlkuStore ORDER BY tlkuStore.StoreName"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x719cbf1b34fc6c4d88298d455d233097
                    End
                End
                Begin Rectangle
                    OverlapFlags =255
                    Left =120
                    Top =780
                    Width =3240
                    Height =900
                    Name ="Box31"
                    GUID = Begin
                        0x7667383733dbb74e82eaff61821d2530
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =247
                    Left =300
                    Top =660
                    Width =1560
                    TabIndex =11
                    GUID = Begin
                        0xf3ddb33875da7148ad93ee2da47f6cb3
                    End
                    Name ="comDate"
                    RowSourceType ="Value List"
                    RowSource ="Date Shipped;Date Ordered"
                    DefaultValue ="\"Date Shipped\""
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1290
                    Top =2160
                    Width =1800
                    TabIndex =3
                    Name ="txtRefNum"
                    GUID = Begin
                        0x8301649e79de164a979a00a9093051ce
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =300
                            Top =2160
                            Width =915
                            Height =240
                            Name ="Label33"
                            Caption ="Ref Num:"
                            GUID = Begin
                                0x70add7addc82264a81a9e9f3701441f0
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Public blnCancel As Boolean

Private Sub cmdBrowse_Click()

Dim msaof As MSA_OPENFILENAME
    
' Set options for the dialog box.
msaof.strDialogTitle = "Save file as?"
msaof.strFilter = MSA_CreateFilterString("Web Page (*.html)", "*.html", "All Files", "*.*")
msaof.strDefaultExtension = "html"

' Call the Open File dialog routine.
MSA_GetSaveFileName msaof
   
Me.txtFileName = Trim(msaof.strFullPathReturned)

End Sub

Private Sub cmdCancel_Click()

Me.Visible = False

End Sub

Private Sub cmdOK_Click()

If IsNull(Me.txtFileName) Then
    MsgBox "You must enter the filename to save this report as.", vbExclamation
    Me.cmdBrowse.SetFocus
    Exit Sub
End If

OpenWaitForm "Building Cashwrap Shipments web page..."

' Build criteria string
Dim strMsg As String, strFilter As String, varItm As Variant

'Date
If Me.comDate = "Date Shipped" Then
  If Me.datFrom <> "" Or Me.datTo <> "" Then
      If strFilter <> "" Then strFilter = strFilter + " AND "
      strFilter = strFilter & "[Ship_Date] " & FromToDateCriteria(Me.datFrom, Me.datTo)
      If strMsg <> "" Then strMsg = strMsg + ", "
      strMsg = strMsg & "Ship date " & FormatFromTo(Me.datFrom, Me.datTo)
  End If
ElseIf Me.comDate = "Date Ordered" Then
  If Me.datFrom <> "" Or Me.datTo <> "" Then
      If strFilter <> "" Then strFilter = strFilter + " AND "
      strFilter = strFilter & "[Date_Ordered] " & FromToDateCriteria(Me.datFrom, Me.datTo)
      If strMsg <> "" Then strMsg = strMsg + ", "
      strMsg = strMsg & "PO date " & FormatFromTo(Me.datFrom, Me.datTo)
  End If
End If

'Customer
If Me.comCustomer <> "" Then
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter + "[SoldName] = '" & Me.comCustomer & "'"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg + "Customer: " & Me.comCustomer
End If

' Ref Num
If Me.txtRefNum <> "" Then
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter + "[RefNum] = '" & Me.txtRefNum & "'"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg + "Ref Num: " & Me.txtRefNum
End If

'Store
If Me.lstStore.ItemsSelected.Count > 0 Then
    Dim crit As String, msg As String
    If strFilter <> "" Then strFilter = strFilter + " AND "
    If strMsg <> "" Then strMsg = strMsg + ", "
    For Each varItm In Me.lstStore.ItemsSelected
        If crit <> "" Then crit = crit & " OR "
        crit = crit & "Store = " & "'" & DQ(Me.lstStore.ItemData(varItm)) & "'"
        If msg <> "" Then
            msg = msg & ", "
        Else
            msg = "Store: "
        End If
        msg = msg & Me.lstStore.ItemData(varItm)
    Next varItm
    strFilter = strFilter & "(" & crit & ")"
    strMsg = strMsg & msg
End If

If OutputCWF2Page(Me.txtFileName, strFilter, strMsg, Me.chkShade, Me.comDate) = False Then
  CloseWaitForm
  Exit Sub
End If

CloseWaitForm

If Me.chkLaunchPage Then
    Call LaunchURL(Me, Me.txtFileName)
End If

Me.Visible = False

End Sub