Version =19
VersionRequired =19
Checksum =456175383
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =5580
    DatasheetFontHeight =10
    ItemSuffix =32
    Left =7770
    Top =3135
    Right =13350
    Bottom =8520
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x8c25bf786c7be140
    End
    Caption ="PO Summary"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800501000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Section
            Height =5400
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =1380
                    Top =840
                    Width =1770
                    TabIndex =1
                    Name ="curPOAmount"
                    Format ="$#,##0.00;($#,##0.00)"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =840
                            Width =1020
                            Height =240
                            ForeColor =255
                            Name ="Label3"
                            Caption ="PO Amount:"
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =79
                    Left =3120
                    Top =4920
                    Width =1020
                    Height =300
                    TabIndex =12
                    Name ="cmdOK"
                    Caption ="&OK"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    AccessKey =67
                    Left =4260
                    Top =4920
                    Width =1020
                    Height =300
                    TabIndex =13
                    Name ="cmdCancel"
                    Caption ="&Cancel"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =120
                    Top =120
                    Width =5460
                    Height =240
                    BackColor =-2147483624
                    ForeColor =-2147483625
                    Name ="Label17"
                    Caption ="You must fill in values for the fields in red.  Other fields are optional."
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =66
                    Left =4260
                    Top =4260
                    Width =1020
                    Height =300
                    TabIndex =10
                    Name ="cmdBrowse"
                    Caption ="&Browse"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x69d8f4e6992cd3119033004033532b7f
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =1320
                    Top =4260
                    Width =2850
                    TabIndex =9
                    Name ="txtFileName"
                    DefaultValue ="\"c:\\PO Summary.html\""
                    GUID = Begin
                        0x6fd8f4e6992cd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =180
                            Top =4260
                            Width =1020
                            Height =240
                            Name ="Label20"
                            Caption ="Save As:"
                            GUID = Begin
                                0x70d8f4e6992cd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =1320
                    Top =4620
                    Width =2945
                    TabIndex =11
                    Name ="chkLaunchPage"
                    DefaultValue ="True"
                    GUID = Begin
                        0x5ad9f4e6992cd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1560
                            Top =4620
                            Width =2655
                            Height =240
                            Name ="Label23"
                            Caption ="View report in web browser."
                            GUID = Begin
                                0x5cd9f4e6992cd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =3480
                    Top =480
                    Width =1080
                    Height =240
                    Name ="Label9"
                    Caption ="Store: "
                    GUID = Begin
                        0x549a95a8422fd3119033004033532b7f
                    End
                End
                Begin ListBox
                    OverlapFlags =85
                    MultiSelect =1
                    Left =3480
                    Top =780
                    Width =1920
                    Height =2520
                    TabIndex =8
                    Name ="lstStore"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuStore.StoreName FROM tlkuStore ORDER BY tlkuStore.StoreName"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x579a95a8422fd3119033004033532b7f
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =1380
                    Top =1560
                    Width =1080
                    TabIndex =3
                    Name ="datFrom"
                    InputMask ="99/99/00;0;_"
                    GUID = Begin
                        0x869a95a8422fd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =1560
                            Width =1020
                            Height =240
                            Name ="Label1"
                            Caption ="From:"
                            GUID = Begin
                                0x879a95a8422fd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =1380
                    Top =1920
                    Width =1080
                    TabIndex =4
                    Name ="datTo"
                    InputMask ="99/99/00;0;_"
                    GUID = Begin
                        0x889a95a8422fd3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =1920
                            Width =1020
                            Height =240
                            Name ="Label24"
                            Caption ="To:"
                            GUID = Begin
                                0x899a95a8422fd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    ListWidth =3600
                    Left =1380
                    Top =2280
                    Width =1770
                    TabIndex =5
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    GUID = Begin
                        0x8a9a95a8422fd3119033004033532b7f
                    End
                    Name ="comCustomer"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tblSold.SoldName FROM tblSold ORDER BY tblSold.SoldName"
                    ColumnWidths ="3600"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =2280
                            Width =1020
                            Height =240
                            Name ="Label25"
                            Caption ="Customer:"
                            GUID = Begin
                                0x8b9a95a8422fd3119033004033532b7f
                            End
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =5
                    Top =4140
                    Width =5580
                    Name ="Line26"
                    GUID = Begin
                        0x8c9a95a8422fd3119033004033532b7f
                    End
                End
                Begin ListBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    ColumnCount =2
                    Left =1320
                    Top =3000
                    Width =1920
                    Height =660
                    TabIndex =7
                    Name ="lstWheatboard"
                    RowSourceType ="Value List"
                    RowSource ="1;\"Wheatboard\";2;\"Non-Wheatboard\";3;\"Both Wheat And Non\""
                    ColumnWidths ="0;1440"
                    DefaultValue ="=3"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x4d77c3d2e33ed3119033004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =300
                            Top =3000
                            Width =960
                            Height =240
                            Name ="Col1_Label"
                            Caption ="Wheatboard:"
                            GUID = Begin
                                0x4e77c3d2e33ed3119033004033532b7f
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    Left =1380
                    Top =2640
                    Width =1740
                    TabIndex =6
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    GUID = Begin
                        0xdd77c3d2e33ed3119033004033532b7f
                    End
                    Name ="comClassification"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuClassification.ClassificationName FROM tlkuClassification ORDER BY tl"
                        "kuClassification.ClassificationName"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =3
                    Left =120
                    Top =2640
                    Width =1140
                    Height =240
                    Name ="Label193"
                    Caption ="Classification: "
                    GUID = Begin
                        0xe077c3d2e33ed3119033004033532b7f
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    AccessKey =83
                    Left =360
                    Top =3840
                    Width =2280
                    Height =180
                    TabIndex =14
                    Name ="chkShade"
                    DefaultValue ="False"
                    GUID = Begin
                        0x070371dcac4ad311bb05004033532b7f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =540
                            Top =3780
                            Width =2055
                            Height =240
                            Name ="Label28"
                            Caption ="&Shade every other line"
                            GUID = Begin
                                0x090371dcac4ad311bb05004033532b7f
                            End
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =2880
                    Top =3840
                    Width =2280
                    Height =180
                    TabIndex =15
                    Name ="chkDescAtTop"
                    DefaultValue ="True"
                    GUID = Begin
                        0x501b14247b9e184f81b5d79b1c0bf881
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =3060
                            Top =3780
                            Width =2055
                            Height =240
                            Name ="Label29"
                            Caption ="Print 'Description' at top"
                            GUID = Begin
                                0x0f32815d89d0344ca4a721e97d03a1c0
                            End
                        End
                    End
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    ColumnCount =2
                    ListWidth =2880
                    Left =1380
                    Top =480
                    Width =1740
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"30\""
                    GUID = Begin
                        0xb7482c9b9c45e5488c8723a995990f3c
                    End
                    Name ="txtPO"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT Tbl_PO.RefNum AS [Ref #], Count(Tbl_PO.ID2) AS POs FROM Tbl_PO GROUP BY T"
                        "bl_PO.RefNum HAVING (((Tbl_PO.RefNum) Is Not Null)) ORDER BY Tbl_PO.RefNum"
                    ColumnWidths ="1440;1440"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =480
                            Width =1020
                            Height =240
                            Name ="Label13"
                            Caption ="Ref #:"
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1380
                    Top =1200
                    Width =1740
                    TabIndex =2
                    Name ="txtBlanketPO"
                    GUID = Begin
                        0x414b246a2a675d418d6982f0833bdfb5
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =240
                            Top =1200
                            Width =1020
                            Height =240
                            Name ="Label31"
                            Caption ="Blanket PO:"
                            GUID = Begin
                                0xe01e5a06d0e89a47a8c8bd21192e6253
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Public blnCancel As Boolean

Private Sub cmdBrowse_Click()

Dim msaof As MSA_OPENFILENAME
    
' Set options for the dialog box.
msaof.strDialogTitle = "Save file as?"
msaof.strFilter = MSA_CreateFilterString("Web Page (*.html)", "*.html", "All Files", "*.*")
msaof.strDefaultExtension = "html"

' Call the Open File dialog routine.
MSA_GetSaveFileName msaof
   
Me.txtFileName = Trim(msaof.strFullPathReturned)

End Sub

Private Sub cmdCancel_Click()

Me.Visible = False

End Sub

Private Sub cmdOK_Click()

If IsNull(Me.curPOAmount) Then
    MsgBox "You must enter a PO amount.", vbExclamation
    Me.curPOAmount.SetFocus
    Exit Sub
End If

If IsNull(Me.txtFileName) Then
    MsgBox "You must enter the filename to save this report as.", vbExclamation
    Me.cmdBrowse.SetFocus
    Exit Sub
End If

OpenWaitForm "Building PO Summary web page..."

' Build criteria string
Dim strMsg As String, strFilter As String, varItm As Variant

'PO (required)
If Not IsNull(Me.txtPO) And Me.txtPO <> "" Then
  If Right$(Me.txtPO, 1) = "*" Then
    strFilter = "RefNum Like '" & Me.txtPO & "%'"
  Else
    strFilter = "RefNum = '" & Me.txtPO & "'"
  End If
End If

'Blanket PO
If Me.txtBlanketPO <> "" Then
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter & "[BlanketPO] = '" & Me.txtBlanketPO & "'"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg & "Blanket PO = " & Me.txtBlanketPO
End If

'Date
If Me.datFrom <> "" Or Me.datTo <> "" Then
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter & "[Ship_Date] " & FromToDateCriteria(Me.datFrom, Me.datTo)
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg & FormatFromTo(Me.datFrom, Me.datTo)
End If

'Customer
If Me.comCustomer <> "" Then
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter + "[SoldName] = '" & Me.comCustomer & "'"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg + "Customer: " & Me.comCustomer
End If

'Classification
If Me.comClassification <> "" Then
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter + "[Classification] = '" & Me.comClassification & "'"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg & "Classification: " & Me.comClassification
End If

'Store
If Me.lstStore.ItemsSelected.Count > 0 Then
    Dim crit As String, msg As String
    If strFilter <> "" Then strFilter = strFilter + " AND "
    If strMsg <> "" Then strMsg = strMsg + ", "
    For Each varItm In Me.lstStore.ItemsSelected
        If crit <> "" Then crit = crit & " OR "
        crit = crit & "Store = " & "'" & DQ(Me.lstStore.ItemData(varItm)) & "'"
        If msg <> "" Then
            msg = msg & ", "
        Else
            msg = "Store: "
        End If
        msg = msg & Me.lstStore.ItemData(varItm)
    Next varItm
    strFilter = strFilter & "(" & crit & ")"
    strMsg = strMsg & msg
End If

If Me.lstWheatboard = 1 Then        ' only medite
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter + "[Medite] = True"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg & "Wheatboard Shipments"
ElseIf Me.lstWheatboard = 2 Then    ' only non medite
    If strFilter <> "" Then strFilter = strFilter + " AND "
    strFilter = strFilter + "[Medite] = False"
    If strMsg <> "" Then strMsg = strMsg + ", "
    strMsg = strMsg & "Non-Wheatboard Shipments"
End If

If OutputPOPage(Me.txtFileName, Me.txtPO, Me.curPOAmount, strFilter, strMsg, Me.chkShade, Me.chkDescAtTop) = False Then
    CloseWaitForm
    Exit Sub
End If

CloseWaitForm

If Me.chkLaunchPage Then
    Call LaunchURL(Me, Me.txtFileName)
End If

Me.Visible = False

End Sub