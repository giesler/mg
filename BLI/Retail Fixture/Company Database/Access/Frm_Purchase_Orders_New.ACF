Version =19
VersionRequired =19
Checksum =854610360
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    Cycle =1
    GridX =24
    GridY =24
    Width =13140
    ItemSuffix =275
    Left =405
    Top =405
    Right =13545
    Bottom =7470
    TimerInterval =500
    MaxRecords =20000
    RecSrcDt = Begin
        0x806719a5bff6e140
    End
    RecordSource ="dbo.Tbl_PO"
    Caption ="Purchase Orders"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    MenuBar ="RFFormMenuBar"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800701000100ea0a6f08640001000f00680102000100 ,
        0x6801020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    OnTimer ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
        End
        Begin CustomControl
            SpecialEffect =2
        End
        Begin Tab
            FontName ="Tahoma"
        End
        Begin FormHeader
            CanGrow = NotDefault
            Height =300
            BackColor =-2147483633
            Name ="FormHeader0"
            Begin
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    Left =180
                    Width =6060
                    Height =300
                    FontSize =12
                    FontWeight =700
                    ForeColor =128
                    Name ="lblHeading"
                    Caption ="Purchase Orders"
                    FontName ="Arial"
                    GUID = Begin
                        0x73b539ea99ca054bb110b67b15402264
                    End
                End
                Begin Line
                    BorderWidth =2
                    OverlapFlags =95
                    Top =300
                    Width =11880
                    BorderColor =32768
                    Name ="Line9"
                    GUID = Begin
                        0xa8e2b738675f7d4b9c0aab8753397b79
                    End
                End
                Begin Label
                    OverlapFlags =215
                    Left =9300
                    Top =60
                    Width =2100
                    Height =240
                    ForeColor =128
                    Name ="lblLoading"
                    Caption ="Loading..."
                    FontName ="Arial"
                    GUID = Begin
                        0x051c2684f37e90438d98c0b9a3e3b463
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =6300
            BackColor =-2147483633
            Name ="Detail0"
            Begin
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =8820
                    Top =720
                    Width =2520
                    FontWeight =700
                    Name ="txtID"
                    ControlSource ="ID"
                    StatusBarText ="Internal Tracking Number (Invoice Number)"
                    OnDblClick ="=OpenFind(\"RFC ID\",\"Whole\",\"txtID\")"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =8820
                    Top =120
                    Width =2520
                    FontWeight =700
                    TabIndex =1
                    BackColor =10092543
                    Name ="txtPO"
                    ControlSource ="PO"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    OnDblClick ="=OpenFind(\"Purchase Order\",\"Start\",\"txtPO\")"
                    FontName ="Arial"
                    ControlTipText ="Purchase Order #"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    TextAlign =2
                    Left =6420
                    Top =1380
                    Width =1380
                    TabIndex =3
                    Name ="txtDateOrdered"
                    ControlSource ="Date_Ordered"
                    Format ="Short Date"
                    OnDblClick ="=OpenFind(\"Date Ordered\",\"Whole\",\"txtDateOrdered\")"
                    DefaultValue ="=Date()"
                    FontName ="Arial"
                    InputMask ="99/99/00;0;_"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    TextAlign =2
                    Left =6420
                    Top =1680
                    Width =1380
                    TabIndex =4
                    Name ="txtShipDate"
                    ControlSource ="Ship_Date"
                    OnDblClick ="=OpenFind(\"Ship Date\",\"Whole\",\"txtShipDate\")"
                    FontName ="Arial"
                    InputMask ="99/99/00;0;_"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    TextAlign =2
                    Left =6420
                    Top =1980
                    Width =1380
                    TabIndex =5
                    Name ="txtArriveDate"
                    ControlSource ="Arrive_Date"
                    OnDblClick ="=OpenFind(\"Arrive Date\",\"Whole\",\"txtArriveDate\")"
                    FontName ="Arial"
                    InputMask ="99/99/00;0;_"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =9180
                    Top =1380
                    Width =2100
                    TabIndex =8
                    Name ="txtJobNumber"
                    ControlSource ="Job_Number"
                    OnDblClick ="=OpenFind(\"Job Number\",\"Whole\",\"txtJobNumber\")"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1080
                    Top =3120
                    Width =6720
                    Height =660
                    TabIndex =10
                    Name ="txtComments"
                    ControlSource ="Comments"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                    ControlTipText ="Comments About PO"
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =5460
                    Top =180
                    Width =1260
                    TabIndex =18
                    Name ="chkCreditPO"
                    ControlSource ="Credit"
                    ControlTipText ="Is this a Credit PO?"
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            Left =5700
                            Top =120
                            Width =1020
                            Height =240
                            Name ="Label171"
                            Caption ="Credit PO?: "
                            FontName ="Arial"
                            ControlTipText ="Is this a Credit PO?"
                            GUID = Begin
                                0x5145648a45645d4fa3a37c0227d82d05
                            End
                        End
                    End
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =7620
                    Top =120
                    Width =1140
                    Height =240
                    FontWeight =700
                    ForeColor =8388608
                    Name ="lblPO"
                    Caption ="PO:"
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Purchase Order\",\"Start\",\"txtPO\")"
                    ControlTipText ="Search on PO #"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =7620
                    Top =720
                    Width =1140
                    Height =240
                    FontWeight =700
                    ForeColor =8388608
                    Name ="lblID"
                    Caption ="RFC ID:"
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"RFC ID\",\"Whole\",\"txtID\")"
                    ControlTipText ="Search on RFC ID #"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =223
                    TextAlign =3
                    Left =5100
                    Top =1380
                    Width =1320
                    Height =240
                    ForeColor =8388608
                    Name ="lblDateOrdered"
                    Caption ="Date Ordered: "
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Date Ordered\",\"Whole\",\"txtDateOrdered\")"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =223
                    TextAlign =3
                    Left =5100
                    Top =1680
                    Width =1320
                    Height =240
                    ForeColor =8388608
                    Name ="lblShipDate"
                    Caption ="Ship Out Date: "
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Ship Date\",\"Whole\",\"txtShipDate\")"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =223
                    TextAlign =3
                    Left =5100
                    Top =1980
                    Width =1320
                    Height =240
                    ForeColor =8388608
                    Name ="lblArriveDate"
                    Caption ="Arrive Date: "
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Arrive Date\",\"Whole\",\"txtArriveDate\")"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =215
                    TextAlign =3
                    Left =7860
                    Top =1380
                    Width =1320
                    Height =240
                    ForeColor =8388608
                    Name ="lblJobNumber"
                    Caption ="Job Number: "
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Job Number\",\"Whole\",\"txtJobNumber\")"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =93
                    TextAlign =3
                    Left =7860
                    Top =1680
                    Width =1320
                    Height =240
                    ForeColor =8388608
                    Name ="lblShipVia"
                    Caption ="Ship Via: "
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Ship Via\",\"Start\",\"cmbShipVia\")"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =7860
                    Top =1980
                    Width =1320
                    Height =240
                    Name ="Label167"
                    Caption ="Purchaser: "
                    FontName ="Arial"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =7860
                    Top =2280
                    Width =1320
                    Height =240
                    Name ="Label168"
                    Caption ="Salesperson: "
                    FontName ="Arial"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =7860
                    Top =2580
                    Width =1320
                    Height =240
                    Name ="Label170"
                    Caption ="Current Status: "
                    FontName ="Arial"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =3
                    Left =60
                    Top =3120
                    Width =960
                    Height =240
                    Name ="Label183"
                    Caption ="Comments: "
                    FontName ="Arial"
                End
                Begin ComboBox
                    OverlapFlags =87
                    Left =9180
                    Top =2280
                    Width =2100
                    TabIndex =13
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    Name ="cmbSalesperson"
                    ControlSource ="Salesperson"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tblUser.UserName FROM tblUser ORDER BY tblUser.UserName"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin ComboBox
                    OverlapFlags =87
                    Left =9180
                    Top =2580
                    Width =2100
                    TabIndex =14
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    Name ="cmbStatus"
                    ControlSource ="Status"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuStatus.StatusName FROM tlkuStatus ORDER BY tlkuStatus.StatusName"
                    StatusBarText ="Status of Order"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =9180
                    Top =2880
                    Width =2100
                    TabIndex =15
                    Name ="txtProNum"
                    ControlSource ="Pro#"
                    StatusBarText ="Shipping & Tracking #"
                    OnDblClick ="=OpenFind(\"Pro Number\",\"Whole\",\"txtProNum\")"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    Left =6420
                    Top =2280
                    Width =1380
                    TabIndex =6
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    Name ="Priority"
                    ControlSource ="Priority"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuPriority.PriorityName FROM tlkuPriority ORDER BY tlkuPriority.Priorit"
                        "yName"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =3
                    Left =5460
                    Top =2280
                    Width =960
                    Height =240
                    Name ="Label193"
                    Caption ="Priority: "
                    FontName ="Arial"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =215
                    TextAlign =3
                    Left =7860
                    Top =2880
                    Width =1320
                    Height =240
                    FontWeight =700
                    ForeColor =8388608
                    Name ="lblProNum"
                    Caption ="Pro #:"
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Pro Number\",\"Whole\",\"txtProNum\")"
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    ListWidth =2880
                    Left =9180
                    Top =3180
                    Width =2100
                    TabIndex =16
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    Name ="cmbStore"
                    ControlSource ="Store"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuStore.StoreName FROM tlkuStore ORDER BY tlkuStore.StoreName"
                    StatusBarText ="Status of Order"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =3
                    Left =7860
                    Top =3180
                    Width =1320
                    Height =240
                    Name ="lblStore"
                    Caption ="Store:"
                    FontName ="Arial"
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    Left =6420
                    Top =2580
                    Width =1380
                    TabIndex =7
                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                    Name ="txtClass"
                    ControlSource ="Classification"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuClassification.ClassificationName FROM tlkuClassification"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =3
                    Left =5280
                    Top =2580
                    Width =1140
                    Height =240
                    Name ="Label203"
                    Caption ="Classification:"
                    FontName ="Arial"
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5460
                    Top =480
                    Width =1260
                    Height =180
                    TabIndex =19
                    Name ="chkCancelPO"
                    ControlSource ="CancelPO"
                    OnClick ="[Event Procedure]"
                    Begin
                        Begin Label
                            OverlapFlags =255
                            TextAlign =1
                            Left =5700
                            Top =420
                            Width =1020
                            Height =300
                            Name ="Label206"
                            Caption ="Cancel PO"
                            FontName ="Arial"
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =87
                    Left =9180
                    Top =1980
                    Width =2100
                    TabIndex =12
                    ColumnInfo ="\"\";\"\";\"10\";\"100\""
                    Name ="cmbPurchaser"
                    ControlSource ="Purchaser"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuPurchaser.PurchaserName FROM tlkuPurchaser ORDER BY tlkuPurchaser.Pur"
                        "chaserName"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin ComboBox
                    OverlapFlags =87
                    Left =9180
                    Top =1680
                    Width =2100
                    TabIndex =11
                    ColumnInfo ="\"\";\"\";\"10\";\"100\""
                    Name ="cmbShipVia"
                    ControlSource ="Ship_via"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="SELECT tlkuShipVia.ShipViaName FROM tlkuShipVia ORDER BY tlkuShipVia.ShipViaName"
                    OnDblClick ="=OpenFind(\"Ship Via\",\"Start\",\"cmbShipVia\")"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =93
                    TextAlign =3
                    Left =7860
                    Top =3480
                    Width =1320
                    Height =240
                    ForeColor =8388608
                    Name ="Label212"
                    Caption ="Reference #:"
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Reference #\",\"Whole\",\"txtRefNum\")"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =9180
                    Top =3480
                    Width =2100
                    TabIndex =17
                    Name ="txtRefNum"
                    ControlSource ="RefNum"
                    StatusBarText ="Reference #"
                    OnDblClick ="=OpenFind(\"Reference #\",\"Whole\",\"txtRefNum\")"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =5460
                    Top =780
                    Width =1260
                    TabIndex =20
                    Name ="chkFTofTruck"
                    ControlSource ="FTofTruck"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x8a0dd4c0cfce354481e82628da6db534
                    End
                    Begin
                        Begin Label
                            OverlapFlags =255
                            TextAlign =1
                            Left =5700
                            Top =720
                            Width =1020
                            Height =240
                            Name ="lblFTofTruck"
                            Caption ="Truck Space"
                            FontName ="Arial"
                            GUID = Begin
                                0x494507dec9fb4e4784943bc8fbb99c1f
                            End
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =119
                    TextAlign =2
                    Left =6720
                    Top =720
                    Width =840
                    TabIndex =21
                    Name ="txtFTofTruckAmount"
                    ControlSource ="FTofTruckAmount"
                    OnDblClick ="=OpenFind(\"Date Ordered\",\"Whole\",\"txtDateOrdered\")"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                    GUID = Begin
                        0x884cbd67917ae34697e2ab2757807aad
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =8820
                    Top =420
                    Width =2520
                    FontWeight =700
                    TabIndex =2
                    BackColor =15138815
                    Name ="txtBlanketPO"
                    ControlSource ="BlanketPO"
                    StatusBarText ="Internal Tracking Number (Invoice Number)"
                    OnDblClick ="=OpenFind(\"Blanket PO\",\"Start\",\"txtBlanketPO\")"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                    GUID = Begin
                        0x71a2297f53affd448ec8d10777d0b8a4
                    End
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    TextAlign =3
                    Left =7440
                    Top =420
                    Width =1320
                    Height =240
                    FontWeight =700
                    ForeColor =8388608
                    Name ="Label241"
                    Caption ="Blanket PO:"
                    FontName ="Arial"
                    OnDblClick ="=OpenFind(\"Blanket PO\",\"Start\",\"txtBlanketPO\")"
                    ControlTipText ="Search on RFC ID #"
                    GUID = Begin
                        0xd4866ae8b77ed241a52dd8653f02c100
                    End
                End
                Begin Tab
                    OverlapFlags =215
                    Left =45
                    Top =60
                    Width =5130
                    Height =3015
                    TabIndex =9
                    Name ="tb1"
                    GUID = Begin
                        0x84f1dd1f0f39904b90bbd31c34d0c0ac
                    End
                    Begin
                        Begin Page
                            OverlapFlags =215
                            AccessKey =83
                            Left =180
                            Top =465
                            Width =4860
                            Height =2475
                            Name ="Page243"
                            Caption ="&Ship To / Sold To"
                            GUID = Begin
                                0x97e8b2a59d08bc4a848b06e856db9631
                            End
                            Begin
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =223
                                    Left =4020
                                    Top =480
                                    Width =1020
                                    Name ="txtShipStoreNo"
                                    ControlSource ="Ship_StoreNo"
                                    AfterUpdate ="[Event Procedure]"
                                    OnDblClick ="=OpenFind(\"Store Number\",\"Whole\",\"txtShipStoreNo\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0xce0b39700f9f23459a8419a188c0c173
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =223
                                    Left =1560
                                    Top =480
                                    Width =2100
                                    TabIndex =1
                                    Name ="txtShipName"
                                    ControlSource ="Ship_Name"
                                    OnDblClick ="=OpenFind(\"Ship Name\",\"Start\",\"txtShipName\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0x07cacf765b62db4d95e3b9261aee724a
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =223
                                    Left =1560
                                    Top =780
                                    Width =3480
                                    TabIndex =2
                                    Name ="txtShipAddress1"
                                    ControlSource ="Ship_Address1"
                                    OnDblClick ="=OpenFind(\"Address Line 1\",\"Start\",\"txtShipAddress1\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0xc812036eaeaee64496e9aebb35785c0c
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =223
                                    Left =1560
                                    Top =1080
                                    Width =3480
                                    TabIndex =3
                                    Name ="txtShipAddress2"
                                    ControlSource ="Ship_Address2"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0x2487f438174e5644b0fd26f372476320
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =223
                                    Left =1560
                                    Top =1380
                                    Width =1860
                                    TabIndex =4
                                    Name ="txtShipCity"
                                    ControlSource ="Ship_City"
                                    OnDblClick ="=OpenFind(\"Ship City\",\"Start\",\"txtShipCity\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0xad772f91ebd2e947b9599659174efa1f
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    TextAlign =2
                                    Left =3480
                                    Top =1380
                                    Width =420
                                    TabIndex =5
                                    Name ="txtShipState"
                                    ControlSource ="Ship_State"
                                    AfterUpdate ="[Event Procedure]"
                                    OnDblClick ="=OpenFind(\"Ship State\",\"Whole\",\"txtShipState\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0x7f8f1e2f6dd5094db79af454ee1e57fb
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    TextAlign =2
                                    Left =3960
                                    Top =1380
                                    Width =1080
                                    TabIndex =6
                                    Name ="txtShipZip"
                                    ControlSource ="Ship_Zip"
                                    OnDblClick ="=OpenFind(\"Ship Zip\",\"Start\",\"txtShipZip\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0xb4176c9df40e84439b4d8d652fd998e9
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =223
                                    Left =1560
                                    Top =1680
                                    Width =3480
                                    TabIndex =7
                                    Name ="txtShipAttn"
                                    ControlSource ="Ship_Attn"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0x9eb4538fbd861f4a855d3c992971c1a6
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =215
                                    TextAlign =3
                                    Left =240
                                    Top =480
                                    Width =1320
                                    Height =240
                                    FontWeight =700
                                    ForeColor =8388608
                                    Name ="lblShipName"
                                    Caption ="Ship To: "
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Ship Name\",\"Start\",\"txtShipName\")"
                                    GUID = Begin
                                        0x5f9bd91225f88a489527589fb1a1eb7b
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =215
                                    TextAlign =3
                                    Left =240
                                    Top =780
                                    Width =1320
                                    Height =240
                                    ForeColor =8388608
                                    Name ="lblShipAddress1"
                                    Caption ="Mall: "
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Address Line 1\",\"Start\",\"txtShipAddress1\")"
                                    GUID = Begin
                                        0xcdf145b88f96c54189f7df77029f1843
                                    End
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =3
                                    Left =240
                                    Top =1080
                                    Width =1320
                                    Height =240
                                    Name ="Label154"
                                    Caption ="Address 2: "
                                    FontName ="Arial"
                                    GUID = Begin
                                        0xea35b68e47cbf746b1e0de5787cccc27
                                    End
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =3
                                    Left =240
                                    Top =1680
                                    Width =1320
                                    Height =240
                                    Name ="lblShipAttn"
                                    Caption ="Attention: "
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x305047db102e9c488c263ab4549ddc6b
                                    End
                                End
                                Begin Label
                                    OverlapFlags =223
                                    TextAlign =3
                                    Left =240
                                    Top =1980
                                    Width =1320
                                    Height =240
                                    Name ="lblShipPhone"
                                    Caption ="Phone, Acc #: "
                                    FontName ="Arial"
                                    GUID = Begin
                                        0xd162e89ae1c7014eae13eaa4954f7817
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =223
                                    TextAlign =3
                                    Left =240
                                    Top =1380
                                    Width =600
                                    Height =240
                                    ForeColor =8388608
                                    Name ="lblShipCity"
                                    Caption ="City, "
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Ship City\",\"Start\",\"txtShipCity\")"
                                    GUID = Begin
                                        0x0139cb76d6835b45998b01edca7e3b0c
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =223
                                    TextAlign =3
                                    Left =840
                                    Top =1380
                                    Width =300
                                    Height =240
                                    ForeColor =8388608
                                    Name ="lblShipState"
                                    Caption ="ST"
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Ship State\",\"Whole\",\"txtShipState\")"
                                    GUID = Begin
                                        0xd26683d4c03ff54783fc7cbc3a0dc44d
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =215
                                    TextAlign =3
                                    Left =1140
                                    Top =1380
                                    Width =420
                                    Height =240
                                    ForeColor =8388608
                                    Name ="lblShipZip"
                                    Caption ="Zip"
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Ship Zip\",\"Start\",\"txtShipZip\")"
                                    GUID = Begin
                                        0x0c7c4c0af838ce47b39357cd5d6a6c93
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1560
                                    Top =1980
                                    Width =1860
                                    TabIndex =8
                                    Name ="txtShipPhone"
                                    ControlSource ="Ship_Phone"
                                    FontName ="Arial"
                                    InputMask ="!\\(999\") \"000\\-0000;0;_"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0x6489bc57d2afd046aa5b3e5c9b5fae1b
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    TextAlign =2
                                    Left =3480
                                    Top =1980
                                    Width =1560
                                    TabIndex =9
                                    Name ="txtShipAccountNum"
                                    ControlSource ="Account#"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    GUID = Begin
                                        0xe8eae29a2d0bd14b828b8ebcbc1457c0
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =215
                                    TextAlign =2
                                    Left =3720
                                    Top =480
                                    Width =300
                                    Height =240
                                    ForeColor =8388608
                                    Name ="lblShipStoreNo"
                                    Caption ="#"
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Store Number\",\"Whole\",\"txtShipStoreNo\")"
                                    GUID = Begin
                                        0x4b48c3b1719aa048beaab1a44017e478
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =223
                                    TextAlign =3
                                    Left =240
                                    Top =2400
                                    Width =1320
                                    Height =240
                                    FontWeight =700
                                    ForeColor =8388608
                                    Name ="lblSoldName"
                                    Caption ="Sold To: "
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Sold To\",\"Start\",\"txtSoldName\")"
                                    GUID = Begin
                                        0x5144c66793ad9e41851d9a4413141344
                                    End
                                End
                                Begin ComboBox
                                    LimitToList = NotDefault
                                    OverlapFlags =215
                                    ColumnCount =2
                                    Left =1560
                                    Top =2400
                                    Width =3480
                                    TabIndex =10
                                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"50\""
                                    GUID = Begin
                                        0x10747e534a395a4dba3c87204579d66d
                                    End
                                    Name ="txtSoldName"
                                    ControlSource ="SoldName"
                                    RowSourceType ="Table/View/StoredProc"
                                    RowSource ="SELECT SoldName,SoldID FROM dbo.tblSold ORDER BY SoldName"
                                    ColumnWidths ="1440;0"
                                    AfterUpdate ="[Event Procedure]"
                                    OnDblClick ="=OpenFind(\"Sold To\",\"Start\",\"txtSoldName\")"
                                    FontName ="Arial"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                    OnNotInList ="[Event Procedure]"
                                End
                                Begin Label
                                    OverlapFlags =223
                                    TextAlign =3
                                    Left =240
                                    Top =2700
                                    Width =1320
                                    Height =240
                                    Name ="lblSoldAttn"
                                    Caption ="Sold Attn:"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x96aedbfb10b5ea42bcece42617466d40
                                    End
                                End
                                Begin ComboBox
                                    LimitToList = NotDefault
                                    OverlapFlags =215
                                    ColumnCount =2
                                    Left =1560
                                    Top =2700
                                    Width =3480
                                    TabIndex =11
                                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                                    GUID = Begin
                                        0xcf3fd9a6a9bae042b56f6517049620a7
                                    End
                                    Name ="comSoldAttention"
                                    ControlSource ="SoldAttentionID"
                                    RowSourceType ="Table/View/StoredProc"
                                    RowSource ="SELECT SoldAttentionID, Attention FROM dbo.tblSoldAttention"
                                    ColumnWidths ="0;1440"
                                    FontName ="Arial"
                                    OnKeyDown ="[Event Procedure]"
                                    OnGotFocus ="=ControlGotFocus()"
                                    OnLostFocus ="=ControlLostFocus()"
                                End
                                Begin Line
                                    OverlapFlags =87
                                    Left =240
                                    Top =2304
                                    Width =4800
                                    BorderColor =8421504
                                    Name ="Line258"
                                    GUID = Begin
                                        0x8acc6f6487b5304bba488ac492c9a60d
                                    End
                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            AccessKey =79
                            Left =180
                            Top =465
                            Width =4860
                            Height =2475
                            Name ="Page244"
                            Caption ="S&old To Address"
                            GUID = Begin
                                0xe3451b893428024bac2f0b5fbef05686
                            End
                            Begin
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =255
                                    Left =1560
                                    Top =480
                                    Width =3480
                                    Name ="txtSoldToAddress1"
                                    ControlSource ="SoldTo_Address1"
                                    OnDblClick ="=OpenFind(\"Address Line 1\",\"Start\",\"txtSoldToAddress1\")"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0xda253b2e9738b040a8fe139f66aa26bc
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =255
                                    Left =1560
                                    Top =780
                                    Width =3480
                                    TabIndex =1
                                    Name ="txtSoldToAddress2"
                                    ControlSource ="SoldTo_Address2"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x565f9aa9e45a03408e649fc395e2238a
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =255
                                    Left =1560
                                    Top =1080
                                    Width =1860
                                    TabIndex =2
                                    Name ="txtSoldToCity"
                                    ControlSource ="SoldTo_City"
                                    OnDblClick ="=OpenFind(\"Sold To City\",\"Start\",\"txtSoldToCity\")"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0xae57833d20b2dd438ec1bd26474964b3
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =247
                                    TextAlign =2
                                    Left =3480
                                    Top =1080
                                    Width =420
                                    TabIndex =3
                                    Name ="txtSoldToState"
                                    ControlSource ="SoldTo_State"
                                    OnDblClick ="=OpenFind(\"Sold To State\",\"Whole\",\"txtSoldToState\")"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x83d33fdad74a9141bd219df7d46f0168
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =247
                                    TextAlign =2
                                    Left =3960
                                    Top =1080
                                    Width =1080
                                    TabIndex =4
                                    Name ="txtSoldToZip"
                                    ControlSource ="SoldTo_Zip"
                                    OnDblClick ="=OpenFind(\"Sold To Zip\",\"Start\",\"txtSoldToZip\")"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x386291b2bb63e54fad77e4d758f8c158
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =247
                                    TextAlign =3
                                    Left =240
                                    Top =480
                                    Width =1320
                                    Height =240
                                    ForeColor =8388608
                                    Name ="Label250"
                                    Caption ="Address 1: "
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Address Line 1\",\"Start\",\"txtShipAddress1\")"
                                    GUID = Begin
                                        0xe70014d4deb9f844827e7c90fce8d5ba
                                    End
                                End
                                Begin Label
                                    OverlapFlags =247
                                    TextAlign =3
                                    Left =240
                                    Top =780
                                    Width =1320
                                    Height =240
                                    Name ="Label251"
                                    Caption ="Address 2: "
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x06e28f9f7a22fe4fb70218ac3fe2c6bb
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =255
                                    TextAlign =3
                                    Left =240
                                    Top =1080
                                    Width =600
                                    Height =240
                                    ForeColor =8388608
                                    Name ="Label252"
                                    Caption ="City, "
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Sold To City\",\"Start\",\"txtSoldToCity\")"
                                    GUID = Begin
                                        0x74a0268eb6279d4da9a945043b40df07
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =255
                                    TextAlign =3
                                    Left =840
                                    Top =1080
                                    Width =300
                                    Height =240
                                    ForeColor =8388608
                                    Name ="Label253"
                                    Caption ="ST"
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Sold To State\",\"Whole\",\"txtSoldToState\")"
                                    GUID = Begin
                                        0x2a1c50ca7b50574e9621bda405cb00f5
                                    End
                                End
                                Begin Label
                                    FontUnderline = NotDefault
                                    OverlapFlags =247
                                    TextAlign =3
                                    Left =1140
                                    Top =1080
                                    Width =420
                                    Height =240
                                    ForeColor =8388608
                                    Name ="Label254"
                                    Caption ="Zip"
                                    FontName ="Arial"
                                    OnDblClick ="=OpenFind(\"Sold To Zip\",\"Start\",\"txtSoldToZip\")"
                                    GUID = Begin
                                        0x9f0618d96a35b4459d0d972ea5834d5d
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =255
                                    Left =1560
                                    Top =1740
                                    Width =2760
                                    TabIndex =5
                                    Name ="txtReplyToEmail"
                                    ControlSource ="ReplyToEmail"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x4f2a131307d24643863a355fae6321e1
                                    End
                                End
                                Begin Label
                                    OverlapFlags =247
                                    TextAlign =3
                                    Left =240
                                    Top =1740
                                    Width =1320
                                    Height =240
                                    Name ="Label256"
                                    Caption ="Reply To Email:"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0xe958206a001d2a4cbfbd2de81111fb3a
                                    End
                                End
                                Begin CommandButton
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =4380
                                    Top =1740
                                    Width =600
                                    Height =240
                                    FontSize =6
                                    FontWeight =400
                                    TabIndex =6
                                    Name ="cmdSendReplyTo"
                                    Caption ="Send"
                                    OnClick ="[Event Procedure]"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x85463fe570ccb748a27b384c4eb68894
                                    End
                                End
                            End
                        End
                    End
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =60
                    Top =4320
                    Width =10980
                    Height =1680
                    AutoActivate =1
                    TabIndex =25
                    Name ="lvPOItems"
                    OleData = Begin
                        0x00100000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000f04185b30a40c10108000000c0020000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000027020000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfeffffff09000000feffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000e0d11e70aa69c20105000000c0020000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000027020000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffeffffff06000000feffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff0300000004000000050000000600000007000000 ,
                        0x08000000090000000a000000feffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0xffff000041439ebc37f0cd11870100aa003f0f07fffffffff09a1a00ec170000 ,
                        0x3d06ffff4bf0d1bd8b85d111b16a00c0f02836282143341208000000a84b0000 ,
                        0x930b00004e087deb010006001c000000000000000000000023820000a84b0000 ,
                        0x01efcdab00000500805ca6770700000008000080050000800001038000000000 ,
                        0x00000000000000001fdeecbd0100050050e519000b0020000000000000000000 ,
                        0x0000030000000000000000000000000000000300000049440020000100000000 ,
                        0x00940700000c0000000000000000000000000000000c0000005246204d617465 ,
                        0x7269616c002000020000000000940700000e0000000000000000000000000000 ,
                        0x000e00000043757374204d6174657269616c002000030000000000ac1400000c ,
                        0x0000000000000000000000000000000c0000004465736372697074696f6e0020 ,
                        0x000400020000007b040000060000000000000000000000000000000600000050 ,
                        0x6861736500200005000200000022040000050000000000000000000000000000 ,
                        0x000500000042726b64002000060001000000db05000006000000000000000000 ,
                        0x0000000000000600000050726963650020000700020000002204000005000000 ,
                        0x00000000000000000000000005000000556e6974002000080001000000d30400 ,
                        0x0004000000000000000000000000000000040000005174790020000900010000 ,
                        0x002b050000070000000000000000000000000000000700000057656967687400 ,
                        0x20000a00010000003c0700000b0000000000000000000000000000000b000000 ,
                        0x4c696e6520546f74616c00000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                    GUID = Begin
                        0x096fae0f93f47746b5c077190bf440bc
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =65
                    TextFontFamily =34
                    Left =11100
                    Top =4320
                    Width =720
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =22
                    Name ="cmdPOItemAdd"
                    Caption ="&Add"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0x67327f21ff3eda4aaecafbc1fdb16da5
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =84
                    TextFontFamily =34
                    Left =11100
                    Top =4680
                    Width =720
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =23
                    Name ="cmdPOItemEdit"
                    Caption ="Edi&t"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0xcd391f6e61746b42ac2d35178b61412e
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =68
                    TextFontFamily =34
                    Left =11100
                    Top =5040
                    Width =720
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =24
                    Name ="cmdPOItemDelete"
                    Caption ="&Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0xdcb50e72d850c64bb6e0220c05656855
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =6000
                    Width =1860
                    Height =240
                    Name ="Label264"
                    Caption ="Purchase Order Totals:"
                    FontName ="Arial"
                    GUID = Begin
                        0x0530b67cb591c147a588007671295967
                    End
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =8520
                    Top =6000
                    Width =1080
                    Height =240
                    Name ="lblWeight"
                    Caption ="[Weight]"
                    GUID = Begin
                        0xf804c7d269d51449b2f806711cd20b67
                    End
                End
                Begin Label
                    OverlapFlags =87
                    TextAlign =3
                    Left =9600
                    Top =6000
                    Width =1080
                    Height =240
                    Name ="lblPrice"
                    Caption ="[Price]"
                    GUID = Begin
                        0x3b615aa082fcfc4f840cb4e9f75808a2
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1080
                    Top =3840
                    Width =6720
                    Height =420
                    TabIndex =26
                    Name ="Text277"
                    ControlSource ="TrafficComments"
                    FontName ="Arial"
                    OnGotFocus ="=ControlGotFocus()"
                    OnLostFocus ="=ControlLostFocus()"
                    ControlTipText ="Comments About PO"
                    GUID = Begin
                        0x35d0326a8f0baf4ca00e2d4780ca3acd
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =3
                    Left =60
                    Top =3840
                    Width =960
                    Height =435
                    Name ="Label278"
                    Caption ="Traffic Comments"
                    FontName ="Arial"
                    GUID = Begin
                        0x79330f0e6f0837439b8cdec765705fa2
                    End
                End
            End
        End
        Begin FormFooter
            Height =480
            BackColor =8421376
            Name ="FormFooter1"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =720
                    Top =60
                    Width =540
                    FontWeight =400
                    TabIndex =1
                    Name ="cmdPrevious"
                    Caption ="Previous"
                    OnClick ="=fRecNav(\"prev\")"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888088888888888888888888888888888800888 ,
                        0x888888888888888888888888880c088888888888888888888888888880cc0888 ,
                        0x8888888888888888888888880ccc0888888888888888888888888880cccc0000 ,
                        0x00088888888888888888880ccccccccccc08888888888888888880cccccccccc ,
                        0xcc0888888888888888880ccccccccccccc08888888888800888880cccccccccc ,
                        0xcc088888888888808888880ccccccccccc0888888888888888888880cccc0000 ,
                        0x0008888888888888888888880ccc088888888888888888888888888880cc0888 ,
                        0x888888888888888888888888880c088888888888888888888888888888800888 ,
                        0x8888888888888888888888888888088888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000
                    End
                    FontName ="Arial"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Goto Previous Record"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =67
                    TextFontFamily =34
                    Left =10200
                    Top =60
                    Width =1140
                    FontWeight =400
                    TabIndex =5
                    Name ="cmdClose"
                    Caption ="&Close"
                    OnClick ="=CloseForm()"
                    FontName ="Arial"
                    ControlTipText ="Close PO Form"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =1980
                    Top =60
                    Width =600
                    FontWeight =400
                    TabIndex =3
                    Name ="cmdNext"
                    Caption ="Next"
                    OnClick ="=fRecNav(\"next\")"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888088888888888888888888888888888880088 ,
                        0x88888888888888888888888888880c0888888888888888888888888888880cc0 ,
                        0x88888888888888888888888888880ccc08888888888888888888880000000ccc ,
                        0xc0888888888888888888880ccccccccccc088888888888888888880ccccccccc ,
                        0xccc08888888888808888880ccccccccccccc08888888880c8888880ccccccccc ,
                        0xccc08888888888808888880ccccccccccc088888888888888888880000000ccc ,
                        0xc0888888888888888888888888880ccc08888888888888888888888888880cc0 ,
                        0x88888888888888888888888888880c0888888888888888888888888888880088 ,
                        0x8888888888888888888888888888088888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="Arial"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Goto Next Record"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =120
                    Top =60
                    Width =600
                    FontWeight =400
                    Name ="cmdFirst"
                    Caption ="First"
                    OnClick ="=fRecNav(\"first\")"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888844888888848888888888888888888888448888884 ,
                        0x4888888888888888888888844888884248888888888888888888888448888422 ,
                        0x4888888888888888888888844888422248888888888888888888888448842222 ,
                        0x4888888888888888888888844842222248888888888888888888888448842222 ,
                        0x4888888888888888888888844888422248888888888888888888888448888422 ,
                        0x4888888888888888888888844888884248888888888888888888888448888884 ,
                        0x4888888888888888888888844888888848888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="Arial"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Goto First Record"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2580
                    Top =60
                    Width =540
                    FontWeight =400
                    TabIndex =4
                    Name ="cmdLast"
                    Caption ="Last"
                    OnClick ="=fRecNav(\"last\")"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888488888884488888888884888888888884488888 ,
                        0x8448888888888448888888888424888884488888888884248888888884224888 ,
                        0x8448888888888422888888888422248884488888888884228888888884222248 ,
                        0x8448888888888422888888888422222484488888888884228888888884222248 ,
                        0x8448888888888422888888888422248884488888888884228888888884224888 ,
                        0x8448888888888422888888888424888884488888888884248888888884488888 ,
                        0x8448888888888448888888888488888884488888888884888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="Arial"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Goto Last Record"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =78
                    TextFontFamily =34
                    Left =1260
                    Top =60
                    Width =720
                    FontWeight =400
                    TabIndex =2
                    Name ="cmdNew"
                    Caption ="&New"
                    StatusBarText ="Goto a new record"
                    OnClick ="=fRecNav(\"new\")"
                    FontName ="Arial"
                    ControlTipText ="Create New Purchase Order"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =70
                    TextFontFamily =34
                    Left =6900
                    Top =60
                    Width =1140
                    FontWeight =400
                    TabIndex =6
                    Name ="cmdFinished"
                    Caption ="&Finished"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Finished Entering New PO"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =73
                    TextFontFamily =34
                    Left =3360
                    Top =60
                    Width =1560
                    FontWeight =400
                    TabIndex =7
                    Name ="cmdCreateInv"
                    Caption ="Create &Invoice"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Build Invoice/Set PO to 'Complete'"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =68
                    TextFontFamily =34
                    Left =5580
                    Top =60
                    Width =1200
                    FontWeight =400
                    TabIndex =8
                    Name ="cmdDelete"
                    Caption ="&Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Delete Current PO"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

Private mblnInitPO As Boolean     ' flag to track if we are in InitPO function already
Private mlngJumpToID As Long      ' jump to this ID when recordset loaded
Private mlngTicks As Long         ' number of ticks left before giving up
Private mblnLoading As Boolean

Private Sub chkCancelPO_Click()
On Error GoTo errHandler

  ' Check if user really wants to cancel this PO
  If Not Me.chkCancelPO Then
    MsgBox "Once a PO is cancelled you cannot uncancel it.", vbCritical
    Me.chkCancelPO = True
    Exit Sub
  Else
    If MsgBox("Are you sure you want to cancel this PO?  You cannot undo a cancel.  It will not appear on any reports.", vbQuestion + vbYesNo + vbDefaultButton2) = vbYes Then
      Me.chkCancelPO = True
    Else
      Me.chkCancelPO = False
    End If
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "CancelPO"
Exit Sub
End Sub

Private Sub chkFTofTruck_Click()
On Error Resume Next

  If Me.chkFTofTruck Then
    Me.txtFTofTruckAmount.Enabled = True
  Else
    Me.txtFTofTruckAmount.Enabled = False
    Me.txtFTofTruckAmount.Text = ""
  End If
  
End Sub

Private Sub cmdCreateInv_Click()
On Error GoTo errHandler

  Dim lngID As Long, rs As ADODB.Recordset
  lngID = Me.txtID
  
  ' Verify we can create an invoice first
  If Me.cmbStatus = "Completed" Then
    If MsgBox("You have already completed this PO.  Would you like to delete the associated invoice and recreate it?", vbQuestion + vbYesNo + vbDefaultButton2) = vbNo Then Exit Sub
    DeleteInvoice lngID, False
  End If
  If Me.chkCancelPO Then
    MsgBox "You cannot create an invoice for a cancelled PO.", vbCritical
    Exit Sub
  End If
  
  ' Make sure changes are saved
  DoCmd.RunCommand acCmdSaveRecord
    
  ' Call createinvoice to create it, checking return val
  OpenWaitForm "Saving invoice..."
  If CreateInvoice(lngID, False) Then
    Me!Status = "Completed"
    DoCmd.RunCommand acCmdSaveRecord
    CloseWaitForm
  Else
    MsgBox "The invoice was not created.", vbCritical
    CloseWaitForm
    Exit Sub
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "cmdCreateInv"
Exit Sub
End Sub

Private Sub cmdDelete_Click()
On Error GoTo errHandler
    
  Dim cn As ADODB.Connection, lngPrevID As Long, rs As ADODB.Recordset
  
  ' make sure rec saved
  If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord
  
  ' Confirm we want to delete this PO
  If MsgBox("Are you sure you want to delete the current PO?", vbYesNo + vbQuestion) = vbYes Then
    ' create a new connection to transact the delete
    OpenWaitForm "Deleting PO..."
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord
    Set cn = New ADODB.Connection
    cn.Open gConn.ConnectionString
    cn.BeginTrans
    cn.Execute "delete from tbl_PO_Items where ID = " + CStr(Me.txtID)
    cn.Execute "delete from tbl_PO where ID = " + CStr(Me.txtID)
    cn.CommitTrans
    cn.Close
    Set cn = Nothing
    Me.Refresh
    mblnLoading = True
    CloseWaitForm
    MsgBox "The PO has been deleted.", vbInformation
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "DeletePO"
On Error Resume Next
' attempt rollback just in case
If Not cn Is Nothing Then
  cn.RollbackTrans
  cn.Close
  Set cn = Nothing
End If
On Error GoTo 0
Exit Sub
End Sub

Private Sub cmdFinished_Click()
On Error GoTo errHandler

  Dim varTmp As Variant, lngCurID As Long
  
  ' Verify data
  If IsNull(Me.txtID) Then
    MsgBox "You must enter information about this new PO first.", vbExclamation
    Exit Sub
  End If
  lngCurID = Me.txtID
  If Me.chkCancelPO Then
    MsgBox "You cannot 'finish' a cancelled PO.", vbCritical
    Exit Sub
  End If
  If IsNull(Me.txtPO) Or Me.txtPO = "" Then
    MsgBox "You must fill in the Purchase Order # before saving this record.", vbExclamation
    Exit Sub
  End If
  If IsNull(Me.txtShipName) Or Me.txtShipName = "" Then
    MsgBox "You must fill in the Ship To before saving this record.", vbExclamation
    Exit Sub
  End If
  If IsNull(Me.txtDateOrdered) Or Me.txtDateOrdered = "" Then
    MsgBox "You must fill in the Date Ordered before saving this record.", vbExclamation
    Exit Sub
  End If
  If IsNull(Me.txtShipDate) Or Me.txtShipDate = "" Then
    If MsgBox("You should enter a Ship Date before saving this record.  Do you want to enter a ship date?", vbQuestion + vbYesNo) = vbYes Then Exit Sub
  End If
  If IsNull(Me.cmbSalesperson) Or Me.cmbSalesperson = "" Then
    MsgBox "You must fill in the Salesperson before saving this record.", vbExclamation
    Exit Sub
  End If
  
  ' Prompt for label count and validate
  varTmp = InputBox("How many labels do you want printed for this invoice?", "# of Labels")
  If varTmp = "" Then Exit Sub
  If Not IsNumeric(varTmp) Then
    MsgBox "You must enter a numeric value!", vbExclamation
    Exit Sub
  End If
  Me!Labels = varTmp
    
  DoCmd.RunCommand acCmdSaveRecord
  MsgBox "Purchase Order Saved!", vbInformation
    
  If flgDebug Then
    SetSPVar "ID", lngCurID
    DoCmd.OpenReport "rptWorkOrder", acViewPreview
  Else
    SetSPVar "ID", lngCurID
    DoCmd.OpenReport "rptWorkOrder", acViewNormal
  End If

  fRecNav "new"

Exit Sub
errHandler:
ErrHand Me.Name, "cmdFinished"
Exit Sub
End Sub

Private Sub cmdPOItemAdd_Click()
On Error GoTo errHandler

  Dim f As Form_fdlgPOItem, li As ListItem
  Set f = New Form_fdlgPOItem
  
  f.POID = Me.txtID
  Pause f
  If Not f.Cancel Then
    Set li = lvPOItems.ListItems.Add(, , f.POItemID)
    UpdatePOItem li, f.cmbMaterial, f.cmbCustMaterial, f.txtDescription, f.txtPhase, f.chkSubItems, f.txtPrice, _
            f.txtQuantity, f.txtUnit, f.txtWeight, f.txtTotal
    
    While f.AddNew
      Set f = Nothing
      Set f = New Form_fdlgPOItem
      f.POID = Me.txtID
      Pause f
      If Not f.Cancel Then
        Set li = lvPOItems.ListItems.Add(, , f.POItemID)
        UpdatePOItem li, f.cmbMaterial, f.cmbCustMaterial, f.txtDescription, f.txtPhase, f.chkSubItems, f.txtPrice, _
                f.txtQuantity, f.txtUnit, f.txtWeight, f.txtTotal
      End If
    
    Wend
  End If
  Set f = Nothing
  

Exit Sub
errHandler:
ErrHand Me.Name, "cmdPOItemAdd"
Exit Sub
End Sub

Private Sub cmdPOItemDelete_Click()
On Error GoTo errHandler

  Dim li As ListItem
  
  Set li = lvPOItems.SelectedItem
  If li Is Nothing Then
    MsgBox "Please select an item to delete.", vbExclamation
    Exit Sub
  End If

  If MsgBox("Are you sure you want to delete '" & li.SubItems(1) & "' from this purchase order?", vbQuestion + vbYesNo) = vbYes Then
    gConn.Execute "delete from Tbl_PO_Items where apkPOItem = " & li.Text
    lvPOItems.ListItems.Remove li.Index
    UpdateTotals
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "cmdPOItemDelete"
Exit Sub
End Sub

Private Sub cmdPOItemEdit_Click()
On Error GoTo errHandler

  Dim f As Form_fdlgPOItem, li As ListItem
  Set f = New Form_fdlgPOItem
  
  Set li = lvPOItems.SelectedItem
  If li Is Nothing Then
    MsgBox "You must select an item to edit.", vbExclamation
    Exit Sub
  End If
  
  f.LoadItem li.Text
  Pause f
  
  If Not f.Cancel Then
    UpdatePOItem li, f.cmbMaterial, f.cmbCustMaterial, f.txtDescription, f.txtPhase, f.chkSubItems, f.txtPrice, _
            f.txtQuantity, f.txtUnit, f.txtWeight, f.txtTotal
  End If


Exit Sub
errHandler:
ErrHand Me.Name, "cmdPOItemEdit"
Exit Sub
End Sub

Private Sub cmdSendReplyTo_Click()

    Dim lngReturn As Long
    
    If Trim(Me.txtReplyToEmail) = "" Or IsNull(Me.txtReplyToEmail) Then
        MsgBox "You must enter an email address!", vbExclamation
        Exit Sub
    End If
    
    lngReturn = ShellExecute(Me.hwnd, "Open", "mailto:" & Me.txtReplyToEmail & "&subject=RFC PO " & Me.ID, 0&, 0&, SW_SHOWNORMAL)

End Sub

Private Sub comSoldAttention_Enter()
On Error GoTo errHandler

  If IsNull(Me!SoldID) Then
    MsgBox "You must select a sold to name before an attention name.", vbExclamation
    Exit Sub
  End If
  
  Me.comSoldAttention.RowSource = "SELECT SoldAttentionID, Attention " _
      & "FROM dbo.tblSoldAttention " _
      & "WHERE SoldID = " + CStr(Me!SoldID)
  
Exit Sub
errHandler:
ErrHand Me.Name, "comSoldAttention_Enter"
Exit Sub
End Sub

Private Sub comSoldAttention_KeyDown(KeyCode As Integer, Shift As Integer)
On Error Resume Next

    If (KeyCode = vbKeyTab And Shift <> 1) Or KeyCode = vbKeyReturn Then
      txtComments.SetFocus
    End If

End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
On Error GoTo errHandler
  
  If Screen.ActiveControl.Name <> "txtPO" Then
    MsgBox "You must enter a PO number.", vbExclamation
    Me.txtPO.SetFocus
    Cancel = True
  Else
'    ' Check if we are already in InitPO, if not we should run InitPO and cancel this insert
'    Me.txtID = DMax("[id]", "Tbl_PO") + 1
'    Me.subPOItems.LinkChildFields = ""
  End If
  
Exit Sub
errHandler:
ErrHand Me.Name, "Form_BeforeInsert"
Exit Sub
End Sub

Private Sub Form_Close()
On Error GoTo errHandler

    ' NN 10/1/02
    If Me.txtID <> 0 Then
        gConn.Execute "sp_Form_POMarkDone " & Me.txtID
    End If

  DoCmd.Close acForm, "fdlgFind"
  Call CSStopDDE

Exit Sub
errHandler:
ErrHand Me.Name, "Form_Close"
Exit Sub
End Sub

Private Sub Form_Current()
On Error GoTo errHandler

  Dim lngID As Long, i As Long

  ' Reset flag just in case, and if a new rec run InitPO
  mblnInitPO = False
  If IsNull(Me.txtID) Then
    Me.txtPO.SetFocus
  End If
  
  Dim rs As Recordset, li As ListItem
  Set rs = New Recordset
  
  lvPOItems.ListItems.Clear
  If Me.txtID <> 0 Then
    rs.Open "dbo.sp_Form_POItems " & Me.txtID, gConn, adOpenForwardOnly, adLockReadOnly
    Do While Not rs.EOF
      Set li = lvPOItems.ListItems.Add(, , rs.Fields("apkPOItem").Value)
      UpdatePOItem li, rs.Fields("RFMaterial").Value, rs.Fields("CustMaterial").Value, rs.Fields("Description").Value, _
        rs.Fields("Phase").Value, rs.Fields("SubItems").Value, rs.Fields("Price").Value, rs.Fields("Quantity").Value, _
        rs.Fields("Unit").Value, rs.Fields("Weight").Value, rs.Fields("Total").Value
      rs.MoveNext
    Loop
    rs.Close
  End If
  Set rs = Nothing
  
  UpdateTotals
  
  chkFTofTruck_Click
  
    ' NN 10/1/02
    If Me.txtID <> 0 Then
        gConn.Execute "sp_Form_POMarkDone " & Me.txtID
    End If
    
Exit Sub
errHandler:
ErrHand Me.Name, "Form_Current"
Exit Sub
End Sub

Private Sub Form_Load()
On Error GoTo errHandler

  ' Remove any server filters or form filters just in case
  If Me.ServerFilter <> "" Then Me.ServerFilter = ""
  If Me.Filter <> "" Then Me.Filter = ""
  If Me.FilterOn = True Then Me.FilterOn = False
  If Me.OrderBy <> "" Then Me.OrderBy = ""
  If Me.OrderByOn = True Then Me.OrderByOn = False
  mblnLoading = True

  ' Set heading and caption to openargs - used for 'Recent POs'
  If Me.OpenArgs <> "" Then
    Me.Caption = Me.OpenArgs
    Me.lblHeading.Caption = Me.OpenArgs
  End If
  
Exit Sub
errHandler:
ErrHand Me.Name, "Form_Load"
Exit Sub
End Sub

Private Sub Form_Timer()
On Error GoTo errHandler

  Dim rs As ADODB.Recordset

  If mblnLoading Then
    Set rs = Me.RecordsetClone
    ' see if we are fetching records
    If rs.State = 9 Then
      Me.lblLoading.Caption = "Loading (" + CStr(rs.RecordCount) + ")..."
      Set rs = Nothing
      Exit Sub
    Else
      Me.lblLoading.Caption = ""
      mblnLoading = False
    End If
    Set rs = Nothing
  Else
    Me.TimerInterval = 0
  End If
  
Exit Sub
errHandler:
ErrHand Me.Name, "Form_Timer"
Exit Sub
End Sub

Private Sub lvPOItems_DblClick()

  cmdPOItemEdit_Click
  
End Sub

Private Sub txtJobNumber_KeyDown(KeyCode As Integer, Shift As Integer)

    If (KeyCode = vbKeyTab And Shift <> 1) Or KeyCode = vbKeyReturn Then
        tb1.Value = 0
        txtShipStoreNo.SetFocus
    End If
    
End Sub

Private Sub txtPO_AfterUpdate()
On Error GoTo errHandler

  Dim intAttempt As Integer
  intAttempt = 0
  
RetryAfterUpdate:
  If IsNull(Me.txtPO) Then Exit Sub
      
  If IsNull(Me.txtID) Then
    Me.txtID = DMax("[id]", "Tbl_PO") + 1
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord
  End If
  CloseWaitForm
  
Exit Sub
errHandler:
Select Case Err
  Case 2757     'happens if record couldn't be saved
    intAttempt = intAttempt + 1
    If intAttempt > 5 Then
      If MsgBox("There were problems saving the record.  Please try again.", vbRetryCancel) = vbCancel Then Exit Sub
    End If
    Me.txtID = Null
    OpenWaitForm "Please wait... "
    Sleep 1000
    Resume RetryAfterUpdate
  Case Else
    ErrHand Me.Name, "txtPO_AfterUpdate"
    Exit Sub
End Select
End Sub

Private Sub txtPO_BeforeUpdate(Cancel As Integer)
On Error GoTo errHandler:

  Dim varResult
  If IsNull(Me.txtID) Then
    varResult = DLookup("PO", "Tbl_PO", "PO='" + Me.txtPO + "'")
  Else
    varResult = DLookup("PO", "Tbl_PO", "PO='" + Me.txtPO + "' AND ID <> " + CStr(Me.txtID))
  End If
'  Me.subPOItems.LinkChildFields = Me.subPOItems.LinkChildFields
  If Not IsNull(varResult) Then
    MsgBox "The PO you entered is already in use.  Please enter another PO.", vbExclamation
    Cancel = True
    Exit Sub
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "txtPO_BeforeUpdate"
Exit Sub
End Sub

Private Sub txtRefNum_KeyDown(KeyCode As Integer, Shift As Integer)
On Error Resume Next

  If KeyCode = vbKeyReturn Or (KeyCode = vbKeyTab And Shift = 0) Then
    cmdPOItemAdd_Click
  End If
  
End Sub

Private Sub txtShipState_AfterUpdate()
On Error GoTo errHandler

  Me.cmbShipVia = DLookup("[ship_via]", "tbl_ship_via", "[state] = '" & Me.txtShipState & "'")

Exit Sub
errHandler:
ErrHand Me.Name, "txtShipState_AfterUpdate"
Exit Sub
End Sub

Private Sub txtShipStoreNo_AfterUpdate()
On Error GoTo errHandler

  Dim rst As ADODB.Recordset, strSQL As String
  
  ' Exit if no blank store number
  If IsNull(Me.txtShipStoreNo) Or Me.txtShipStoreNo = "" Then Exit Sub
  
  ' Look up store details based on store number entered
  strSQL = "sp_Util_GetStoreInfo '" + Me.txtShipStoreNo + "'"
  Set rst = New ADODB.Recordset
  With rst
    .Open strSQL, gConn, adOpenForwardOnly, adLockReadOnly
    If Not .EOF Then
      Me.txtShipName = !Ship_Name
      Me.txtShipAddress1 = !Ship_Address1
      Me.txtShipAddress2 = !Ship_Address2
      Me.txtShipCity = !Ship_City
      Me.txtShipState = !Ship_State
      Me.txtShipZip = !Ship_Zip
      Me.txtShipAttn = !Ship_Attn
      Me.txtShipPhone = !Ship_Phone
      Me.cmbShipVia = !Ship_via
    End If
    .Close
  End With
  Set rst = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "Ship_StoreNo"
Exit Sub
End Sub

Private Sub InitPO()
On Error GoTo errHandler

  ' check if we are already in init
  If mblnInitPO Then Exit Sub
    
  Dim fP As Form_fdlgPO
  Set fP = New Form_fdlgPO
  
  ' Make sure we are visible (when form opened in add mode)
  Me.Visible = True
  Me.Repaint
  
  Pause fP
  
  If Not fP.mblnCancel Then
    mblnInitPO = True
    Me.txtPO = fP.txtPO
    Me.txtID = DMax("[id]", "Tbl_PO") + 1
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord
    mblnInitPO = False
    Me.txtDateOrdered.SetFocus
  End If

Exit Sub
errHandler:
ErrHand Me.Name, "InitPO"
Exit Sub
End Sub

Private Sub txtSoldName_AfterUpdate()
On Error GoTo errHandler

  Me!SoldID = Me.txtSoldName.Column(1)
  If Me.txtSoldName <> Me.txtSoldName.OldValue Then
    Me.comSoldAttention = Null
    Call comSoldAttention_Enter
    If Me.comSoldAttention.ListCount > 0 Then
      Me.comSoldAttention = Me.comSoldAttention.ItemData(0)
    End If
  End If
  
  
  Dim rst As ADODB.Recordset, strSQL As String
  
  ' Look up store details based on store number entered
  strSQL = "sp_Util_GetSoldToAddressInfo " + CStr(Me.SoldID)
  Set rst = New ADODB.Recordset
  With rst
    .Open strSQL, gConn, adOpenForwardOnly, adLockReadOnly
    If Not .EOF Then
        Me.txtSoldToAddress1 = .Fields("SoldAddress1")
        Me.txtSoldToAddress2 = .Fields("SoldAddress2")
        Me.txtSoldToCity = .Fields("SoldCity")
        Me.txtSoldToState = .Fields("SoldState")
        Me.txtSoldToZip = .Fields("SoldZip")
    End If
    .Close
  End With
  Set rst = Nothing
  
Exit Sub
errHandler:
ErrHand Me.Name, "txtSoldName_AfterUpdate"
Exit Sub
End Sub

Private Sub txtSoldName_NotInList(NewData As String, Response As Integer)
On Error GoTo errHandler

  MsgBox "You must choose a name from the list.  To bill to another company not listed, close the PO screen and open the Utility Menu from the Main Menu.", vbCritical

Exit Sub
errHandler:
ErrHand Me.Name, "txtSoldName_NotInList"
Exit Sub
End Sub


Private Sub UpdateTotals()
On Error GoTo errHandler

  Dim rs As ADODB.Recordset, strSQL As String
  Set rs = New ADODB.Recordset
  
  ' reset to 0
  Me.lblPrice.Caption = ""
  Me.lblWeight.Caption = ""
  
  ' this sp will total all items in this PO
  If Me!ID = 0 Then Exit Sub
  strSQL = "sp_Form_POItemTotals " + CStr(Nz(Me!ID, 0))
  rs.Open strSQL, gConn, adOpenForwardOnly, adLockReadOnly
  
  ' Show totals
  If Not rs.EOF Then
    Me.lblPrice.Caption = Format(Nz(rs.Fields("ExtPrice").Value, 0), "Currency")
    Me.lblWeight.Caption = Format(Nz(rs.Fields("ExtWeight").Value, 0), "Fixed")
  End If
  
  rs.Close
  Set rs = Nothing

Exit Sub
errHandler:
ErrHand Me.Name, "UpdateTotals"
Exit Sub
End Sub

Public Sub UpdatePOItem(li As ListItem, RFMaterial As Variant, CustMaterial As Variant, Description As Variant, Phase As Variant, _
  SubItems As Variant, Price As Variant, Quantity As Variant, Unit As Variant, Weight As Variant, Total As Variant)

  li.SubItems(1) = Nz(RFMaterial, "")
  li.SubItems(2) = Nz(CustMaterial, "")
  li.SubItems(3) = Nz(Description, "")
  li.SubItems(4) = Nz(Phase, "")
  li.SubItems(5) = IIf(SubItems, "x", "")
  li.SubItems(6) = Nz(Format(Price, "Fixed"), " ")
  li.SubItems(7) = Nz(Unit, " ")
  li.SubItems(8) = Nz(Quantity, " ")
  li.SubItems(9) = Nz(Weight, "")
  li.SubItems(10) = Nz(Format(Total, "Fixed"), " ")

End Sub