Version =19
VersionRequired =19
Checksum =-1664013136
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    AllowUpdating =4
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =9360
    DatasheetFontHeight =10
    ItemSuffix =4
    Left =1260
    Top =990
    Right =14880
    Bottom =9030
    DatasheetGridlinesColor =12632256
    Toolbar ="FCFormToolBar"
    RecSrcDt = Begin
        0x9534e2b3afd4e140
    End
    Caption ="Production Parts Explorer"
    OnOpen ="[Event Procedure]"
    MenuBar ="FCFormMenuBar"
    DatasheetFontName ="Arial"
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CustomControl
            SpecialEffect =2
        End
        Begin Section
            Height =6120
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0x76a7a554e71aac419fa57e93bb931f04
            End
            Begin
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =60
                    Top =300
                    Width =2310
                    Height =5130
                    AutoActivate =1
                    Name ="tvPO"
                    OleData = Begin
                        0x000e0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000e0e206f8704dbf010700000000010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000020000006a000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdfffffffffffffffffffffffffffffffffffffffeffffff ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000608ee7cf734dbf010500000000010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000020000006a000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff03000000feffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b69041c78985d111b16a00c0f02836282143341208000000eb0f0000 ,
                        0x59230000b13cc16a010006002200000039000000b90100000a00000071035308 ,
                        0x01efcdab0000050040055308060000000000000005000080d8e7120001000000 ,
                        0x5c001fdeecbd01000500e0e71200000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="TreeCtrl"
                    Class ="MSComctlLib.TreeCtrl.2"
                    GUID = Begin
                        0x751cc46ab94c7d4a8220d5fc05e63e65
                    End
                End
                Begin Label
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =60
                    Top =60
                    Width =2280
                    Height =210
                    Name ="Label1"
                    Caption ="POs/Parts"
                    GUID = Begin
                        0xc30150297b924b42839189ae626c4552
                    End
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =2460
                    Top =300
                    Width =6780
                    Height =5100
                    AutoActivate =1
                    TabIndex =1
                    Name ="lvParts"
                    OleData = Begin
                        0x000e0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000c08ab1c0704dbf010700000000010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000072000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdfffffffffffffffffffffffffffffffffffffffeffffff ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000608ee7cf734dbf010500000000010000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000072000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff03000000feffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000004bf0d1bd8b85d111b16a00c0f02836282143341208000000b72e0000 ,
                        0x242300004e087deb010006001c000000000000000000000003820088b72e0000 ,
                        0x01efcdab00000500def7a4770700008808000080050000800001038000000000 ,
                        0x00000000000000001fdeecbd010005009076080c000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                    GUID = Begin
                        0x6457ad7fac42d248a58f39f35a3a7b0e
                    End
                End
                Begin Label
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =2460
                    Top =60
                    Width =6780
                    Height =210
                    Name ="lblListView"
                    Caption ="POs/Parts"
                    GUID = Begin
                        0xc95cfeebe7250c438beda0e2360fe870
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub Form_Open(Cancel As Integer)

Dim n As Node, sMsg As String

sMsg = "This form is a different view of the production parts data.  It is not fully functional - you can currently only view data - you cannot edit anything."
MsgBox sMsg, vbInformation

Set n = Me.tvPO.Nodes.Add(, , "s:1", "PO")
Set n = Me.tvPO.Nodes.Add(, , "s:2", "Vendor")
Set n = Me.tvPO.Nodes.Add(, , "s:3", "RPS P/N")

End Sub

Private Sub LoadPOs(nParent As Node)
On Error GoTo LoadPOs_Err

Dim r As New Recordset, sSQL As String, n As Node, li As ListItem, ch As ColumnHeader
Dim p As Node

Me.lvParts.ListItems.Clear
Me.lvParts.ColumnHeaders.Clear

Set ch = Me.lvParts.ColumnHeaders.Add(, , "PO", 1500, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Vendor", 2500, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Confirmed", 900, lvwColumnCenter)

sSQL = "select POID, Vendor, Confirmed from dbo.tblPO order by POID"

OpenWaitForm "Loading POs..."
r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set p = Me.tvPO.Nodes.Add(nParent, tvwChild, "p:" & r!POID, r!POID)
  Set li = Me.lvParts.ListItems.Add(, "p:" & r!POID, r!POID)
  li.SubItems(1) = Nz(r!Vendor, "")
  li.SubItems(2) = IIf(r!Confirmed, "x", "")
  r.MoveNext
Loop
nParent.Tag = "cache"

r.Close
Set r = Nothing
CloseWaitForm
nParent.Expanded = True

Exit Sub
LoadPOs_Err:
ErrHand Me.Name, "LoadPOs"
Exit Sub

End Sub

Private Sub LoadVendors(nParent As Node)
On Error GoTo LoadVendors_Err

Dim r As New Recordset, sSQL As String, n As Node, p As Node

sSQL = "select Vendor from dbo.tblPO where Vendor is not null group by Vendor order by Vendor"

OpenWaitForm "Loading Vendors..."
r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set p = Me.tvPO.Nodes.Add(nParent, tvwChild, "v:" & r!Vendor, r!Vendor)
  r.MoveNext
Loop

r.Close
Set r = Nothing
CloseWaitForm
nParent.Expanded = True
nParent.Tag = "cache"

Exit Sub
LoadVendors_Err:
ErrHand Me.Name, "LoadVendors"
Exit Sub

End Sub

Private Sub LoadRPSParts(nParent As Node)
On Error GoTo LoadRPSParts_Err

Dim r As New Recordset, sSQL As String, n As Node, p As Node

sSQL = "select RPSPartNum, RPSPNSort from dbo.tblParts where RPSPartNum is not null group by RPSPartNum, RPSPNSort order by RPSPNSort"

OpenWaitForm "Loading RPS Part Numbers..."
r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set p = Me.tvPO.Nodes.Add(nParent, tvwChild, "r:" & r!RPSPartNum, r!RPSPartNum)
  r.MoveNext
Loop

r.Close
Set r = Nothing
CloseWaitForm
nParent.Expanded = True
nParent.Tag = "cache"

Exit Sub
LoadRPSParts_Err:
ErrHand Me.Name, "LoadRPSParts_Err"
Exit Sub

End Sub

Private Sub LoadVendorPOs(nParent As Node)
On Error GoTo LoadVendorPOs_Err

Dim r As New Recordset, sSQL As String, n As Node, li As ListItem
Dim ch As ColumnHeader, p As Node

Me.lvParts.ListItems.Clear
Me.lvParts.ColumnHeaders.Clear

Set ch = Me.lvParts.ColumnHeaders.Add(, , "PO", 1500, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Vendor", 2500, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Confirmed", 900, lvwColumnCenter)

sSQL = "select POID, Vendor, Confirmed from dbo.tblPO where Vendor = '" & nParent.Text & "' order by POID"

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set p = Me.tvPO.Nodes.Add(nParent, tvwChild, "q:" & r!POID, r!POID)
  Set li = Me.lvParts.ListItems.Add(, "p:" & r!POID, r!POID)
  li.SubItems(1) = Nz(r!Vendor, "")
  li.SubItems(2) = IIf(r!Confirmed, "x", "")
  r.MoveNext
Loop

r.Close
Set r = Nothing
nParent.Expanded = True

Exit Sub
LoadVendorPOs_Err:
ErrHand Me.Name, "LoadVendorPOs"
Exit Sub

End Sub

Private Sub lvParts_DblClick()
On Error GoTo lvParts_DblClick_Err

Dim n As Node, li As ListItem, ch As Node, i As Integer

Set n = Me.tvPO.SelectedItem
Set li = Me.lvParts.SelectedItem

If li Is Nothing Or n Is Nothing Then
  MsgBox "You must select an item to open it!", vbExclamation
  Exit Sub
End If

'loop through nodes, until we find one with same caption
Set ch = n.Child
Do While ch <> n.Child.LastSibling
  If ch.Text = li.Text Then
    Exit Do
  End If
  Set ch = ch.Next
Loop

ch.Selected = True
tvPO_NodeClick ch

Exit Sub
lvParts_DblClick_Err:
ErrHand Me.Name, "lvParts_DblClick_Err"
Exit Sub
End Sub

Private Sub lvParts_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Long, ByVal y As Long)

Dim cBar As CommandBar, cmd As CommandBarControl

If Button = acRightButton Then
  On Error Resume Next
  Set cBar = Application.CommandBars("FCProdPartsLVPopup")
  'see if we need to create it
  If Err <> 0 Then
    Set cBar = Application.CommandBars.Add("FCProdPartsLVPopup", msoBarPopup, , True)
    Set cmd = cBar.Controls.Add(msoControlButton)
    cmd.Caption = "&Add"
    cmd.OnAction = "AddLVItem"
    Set cmd = cBar.Controls.Add(msoControlButton)
    cmd.Caption = "&Edit"
    cmd.OnAction = "EditLVItem"
    Set cmd = cBar.Controls.Add(msoControlButton)
    cmd.Caption = "&Delete"
    cmd.OnAction = "DeleteLVItem"
  End If
  cBar.ShowPopup
End If

End Sub

Private Sub tvPO_NodeClick(ByVal Node As Object)
On Error GoTo tvPO_NC_Err

Dim n As Node, ch As Node
Set n = Node

If InStr(n.Tag, "cache") = 0 Then
  While n.Children > 0
    Set ch = n.Child
    Me.tvPO.Nodes.Remove ch.Key
  Wend
End If

If Left(n.Key, 2) = "s:" Then
  If n.Text = "PO" Then
    If n.Children = 0 Then LoadPOs n
  ElseIf n.Text = "Vendor" Then
    If n.Children = 0 Then LoadVendors n
  ElseIf n.Text = "RPS P/N" Then
    If n.Children = 0 Then LoadRPSParts n
  End If
ElseIf Left(Node.Key, 2) = "v:" Then
  If n.Children = 0 Then LoadVendorPOs n
ElseIf Left(Node.Key, 2) = "p:" Then
  LoadPOParts n
ElseIf Left(Node.Key, 2) = "q:" Then
  LoadPOParts n
ElseIf Left(Node.Key, 2) = "g:" Then
  LoadPOParts n
ElseIf Left(Node.Key, 2) = "i:" Then
  LoadPartDetail n
ElseIf Left(Node.Key, 2) = "r:" Then
  LoadRPSPartsOrders n
End If

Dim sTmp As String, sOut As String, i As Integer
sTmp = n.FullPath
For i = 1 To Len(sTmp)
  If Mid(sTmp, i, 1) = "\" Then
    sOut = sOut + " \ "
  Else
    sOut = sOut + Mid(sTmp, i, 1)
  End If
Next i
Me.lblListView.Caption = sOut

Exit Sub
tvPO_NC_Err:
ErrHand Me.Name, "tvPO_NodeClick"
Exit Sub
End Sub

Private Sub LoadPOParts(pNode As Node)
On Error GoTo LoadPOParts_Err

Dim sSQL As String, r As New Recordset, n As Node, li As ListItem
Dim blnSkipChildren As Boolean, ch As ColumnHeader

'see if nodes children already done
blnSkipChildren = pNode.Children > 0

Me.lvParts.ListItems.Clear
Me.lvParts.ColumnHeaders.Clear

Set ch = Me.lvParts.ColumnHeaders.Add(, , "Vendor Part Num", 1500, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "RPS Part Num", 1500, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Part Description", 3500, lvwColumnLeft)

'open recordset
sSQL = "select POPartID, VendorPartNumber, RPSPartNum, PartDescription from dbo.tblPOPart where fkPOID = " & pNode.Text
r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set li = Me.lvParts.ListItems.Add(, "i:" & r!POPartID, Nz(r!VendorPartNumber, ""))
  li.SubItems(1) = Nz(r!RPSPartNum, "")
  li.SubItems(2) = Nz(r!PartDescription, "")
  If Not blnSkipChildren Then
    Set n = Me.tvPO.Nodes.Add(pNode, tvwChild, "i:" & r!POPartID, Nz(r!VendorPartNumber, ""))
  End If
  r.MoveNext
Loop
r.Close
Set r = Nothing
pNode.Expanded = True

Exit Sub
LoadPOParts_Err:
ErrHand Me.Name, "LoadPOParts_Err"
Exit Sub
End Sub

Private Sub LoadRPSPartsOrders(pNode As Node)
On Error GoTo LoadRPSPartsOrders_Err

Dim sSQL As String, r As New Recordset, n As Node, li As ListItem
Dim blnSkipChildren As Boolean, ch As ColumnHeader

'see if nodes children already done
blnSkipChildren = pNode.Children > 0

Me.lvParts.ListItems.Clear
Me.lvParts.ColumnHeaders.Clear

Set ch = Me.lvParts.ColumnHeaders.Add(, , "PO", 800, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Vendor", 1000, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Vendor P/N", 1100, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "RPS P/N", 1000, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Part Description", 2500, lvwColumnLeft)

'open recordset
sSQL = "select po.POID, po.Vendor, pp.POPartID, pp.VendorPartNumber, pp.RPSPartNum, pp.PartDescription "
sSQL = sSQL & "from dbo.tblPOPart pp, dbo.tblPO po where po.POID = pp.fkPOID and RPSPartNum = '" & pNode.Text & "'"
r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set li = Me.lvParts.ListItems.Add(, , Nz(r!POID, ""))
  li.Tag = "nocache,prt " & r!POPartID
  li.SubItems(1) = Nz(r!Vendor, "")
  li.SubItems(2) = Nz(r!VendorPartNumber, "")
  li.SubItems(3) = Nz(r!RPSPartNum, "")
  li.SubItems(4) = Nz(r!PartDescription, "")
  If Not blnSkipChildren Then
    Set n = Me.tvPO.Nodes.Add(pNode, tvwChild, "i:" & r!POPartID, Nz(r!VendorPartNumber, ""))
  End If
  r.MoveNext
Loop
r.Close
Set r = Nothing
pNode.Expanded = True

Exit Sub
LoadRPSPartsOrders_Err:
ErrHand Me.Name, "LoadRPSPartsOrders"
Exit Sub
End Sub

Private Sub LoadPartDetail(pNode As Node)
On Error GoTo LoadPartDetail_Err

Dim sSQL As String, r As New Recordset, li As ListItem
Dim ch As ColumnHeader

Me.lvParts.ListItems.Clear
Me.lvParts.ColumnHeaders.Clear

Set ch = Me.lvParts.ColumnHeaders.Add(, , "Cost Ea", 800, lvwColumnLeft)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Qty", 500, lvwColumnRight)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "In-House", 950, lvwColumnCenter)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Rcvd Date", 1000, lvwColumnCenter)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Qty Rcvd", 900, lvwColumnRight)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Value", 800, lvwColumnRight)
Set ch = Me.lvParts.ColumnHeaders.Add(, , "Notes", 1600, lvwColumnLeft)

'Me.lvParts.Sorted = True
'Me.lvParts.SortKey = 0
'Me.lvParts.SortOrder = lvwDescending

'open recordset
sSQL = "select POPartDetailID, Quantity, RequestedShipDate, ReceivedDate, QuantityReceived, CostEach, "
sSQL = sSQL & "Value, Notes from dbo.tblPOPartDetail where fkPOPartID = " & Val(Mid(pNode.Key, 3))
r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly

Do While Not r.EOF
  Set li = Me.lvParts.ListItems.Add(, , Format(Nz(r!CostEach, "0"), "currency"))
  li.Tag = "nocache,ord " & r!POPartDetailID
  li.SubItems(1) = Nz(r!Quantity, " ")
  li.SubItems(2) = Nz(r!RequestedShipDate, " ")
  li.SubItems(3) = Nz(r!ReceivedDate, " ")
  li.SubItems(4) = Nz(r!QuantityReceived, " ")
  li.SubItems(5) = Format(Nz(r!Value, 0), "currency")
  li.SubItems(6) = Nz(r!Notes, " ")
  r.MoveNext
Loop
r.Close
Set r = Nothing

Exit Sub
LoadPartDetail_Err:
ErrHand Me.Name, "LoadPartDetail_Err"
Exit Sub
End Sub