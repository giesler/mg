Version =19
VersionRequired =19
Checksum =316613923
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    GridX =24
    GridY =24
    Width =8460
    ItemSuffix =56
    Left =1125
    Top =270
    Right =9585
    Bottom =4995
    Toolbar ="FCFormToolBar"
    RecSrcDt = Begin
        0x88b87406dfd1e140
    End
    Caption ="Production Schedule"
    MenuBar ="FCFormMenuBar"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x5c5c6b796c655c4850204c617365724a65742032313030000000000000000000 ,
        0x010400059c00340243ef800501000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200000034020000114c35610000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001900310001004850204c617365724a65742032313030005c5c6b796c655c ,
        0x4850204c617365724a657420323130300049505f31302e31302e312e393000
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin CustomControl
            SpecialEffect =2
        End
        Begin Tab
            FontName ="Tahoma"
        End
        Begin Section
            CanGrow = NotDefault
            Height =4740
            BackColor =-2147483633
            Name ="Detail0"
            GUID = Begin
                0xafca04e92849d311bb05004033532b7f
            End
            Begin
                Begin Tab
                    OverlapFlags =85
                    Top =60
                    Width =8355
                    Height =4500
                    Name ="TabCtl31"
                    GUID = Begin
                        0x7667a1a38ce11f44973f7a6049acc659
                    End
                    Begin
                        Begin Page
                            OverlapFlags =215
                            AccessKey =80
                            Left =135
                            Top =465
                            Width =8085
                            Height =3960
                            Name ="Page32"
                            Caption ="&Production Schedule Entry"
                            GUID = Begin
                                0x0bd0da052b695a4997c4abe9337def8f
                            End
                            Begin
                                Begin TextBox
                                    Visible = NotDefault
                                    TabStop = NotDefault
                                    FELineBreak = NotDefault
                                    SpecialEffect =0
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =2220
                                    Top =4020
                                    Width =1728
                                    BackColor =12632256
                                    Name ="ScheduleID"
                                    FontName ="MS Sans Serif"
                                    GUID = Begin
                                        0x33afec2d08fd0a43a0701d604f4ba280
                                    End
                                End
                                Begin Subform
                                    OverlapFlags =247
                                    SpecialEffect =0
                                    Left =4200
                                    Top =660
                                    Width =2466
                                    Height =3600
                                    TabIndex =1
                                    Name ="ModelSUB"
                                    SourceObject ="Form.pafsubPSModel"
                                    LinkChildFields ="ScheduleID"
                                    LinkMasterFields ="ScheduleID"
                                    GUID = Begin
                                        0xd6682fc669a55a4fad42e377da261446
                                    End
                                End
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =215
                                    Left =300
                                    Top =540
                                    Width =3600
                                    Height =660
                                    BackColor =-2147483624
                                    ForeColor =-2147483625
                                    Name ="Label17"
                                    Caption ="Select a month and year below, then edit the model amounts on the right."
                                    FontName ="MS Sans Serif"
                                    GUID = Begin
                                        0xbd4bd6a3b31c6a47a59c9c37ac1f7781
                                    End
                                End
                                Begin ComboBox
                                    RowSourceTypeInt =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    ColumnCount =2
                                    ListWidth =1440
                                    Left =1260
                                    Top =1320
                                    Width =1560
                                    TabIndex =2
                                    GUID = Begin
                                        0xc6ae3c1b3eac3249bda9a27029013343
                                    End
                                    Name ="comboMonth"
                                    RowSourceType ="Value List"
                                    RowSource ="1;\"January\";2;\"February\";3;\"March\";4;\"April\";5;\"May\";6;\"June\";7;\"Ju"
                                        "ly\";8;\"August\";9;\"September\";10;\"October\";11;\"November\";12;\"December\""
                                    ColumnWidths ="0;1440"
                                    OnChange ="[Event Procedure]"
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =480
                                            Top =1320
                                            Width =615
                                            Height =245
                                            Name ="Month:_Label"
                                            Caption ="Month:"
                                            EventProcPrefix ="Month__Label"
                                            GUID = Begin
                                                0x96b6c4bedc6ea74e8ddc3f9e3b023141
                                            End
                                        End
                                    End
                                End
                                Begin ComboBox
                                    RowSourceTypeInt =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    ListWidth =1440
                                    Left =1260
                                    Top =1740
                                    Width =1560
                                    TabIndex =3
                                    GUID = Begin
                                        0xcefee211ddb67840b1d377f467395069
                                    End
                                    Name ="comboYear"
                                    RowSourceType ="Value List"
                                    RowSource ="2000;2001;2002;2003;2004;2005;2006;2007;2008;2009;2010"
                                    ColumnWidths ="1440"
                                    OnChange ="[Event Procedure]"
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =480
                                            Top =1740
                                            Width =495
                                            Height =245
                                            Name ="Year:_Label"
                                            Caption ="Year:"
                                            EventProcPrefix ="Year__Label"
                                            GUID = Begin
                                                0x34fd9c86fca71c47a903d10d69240891
                                            End
                                        End
                                    End
                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            AccessKey =82
                            Left =135
                            Top =465
                            Width =8085
                            Height =3960
                            Name ="Page33"
                            Caption ="Production &Report"
                            GUID = Begin
                                0xbdbe44c0ab7b9e48b551586912c21eaf
                            End
                            Begin
                                Begin CommandButton
                                    OverlapFlags =247
                                    AccessKey =86
                                    TextFontFamily =34
                                    Left =4320
                                    Top =3240
                                    Width =2040
                                    Height =480
                                    Name ="cmdPrevProdSched"
                                    Caption ="Pre&view Report"
                                    OnClick ="[Event Procedure]"
                                    FontName ="Tahoma"
                                    GUID = Begin
                                        0x8bf9ac2e5862b24fa863481ee4e3b344
                                    End
                                End
                                Begin Label
                                    OverlapFlags =247
                                    Left =240
                                    Top =720
                                    Width =1800
                                    Height =240
                                    Name ="Label38"
                                    Caption ="From:"
                                    GUID = Begin
                                        0x35c48386c3de7a41adb74162821cb505
                                    End
                                End
                                Begin Label
                                    OverlapFlags =247
                                    Left =3060
                                    Top =720
                                    Width =1800
                                    Height =240
                                    Name ="Label40"
                                    Caption ="To:"
                                    GUID = Begin
                                        0x5146bd4ea785d949bf1cf6e1cecaa842
                                    End
                                End
                                Begin ComboBox
                                    LimitToList = NotDefault
                                    OverlapFlags =247
                                    TextAlign =1
                                    ListWidth =2830
                                    Left =5760
                                    Top =960
                                    Width =2035
                                    TabIndex =1
                                    ColumnInfo ="\"\";\"\";\"10\";\"50\""
                                    GUID = Begin
                                        0xf1b762420b7b554cb62307cc40329e6d
                                    End
                                    Name ="comVendorName"
                                    RowSourceType ="Table/View/StoredProc"
                                    RowSource ="dbo.qselVendorName"
                                    ColumnWidths ="2580"
                                    FontName ="MS Sans Serif"
                                    Begin
                                        Begin Label
                                            OverlapFlags =255
                                            Left =5760
                                            Top =720
                                            Width =2220
                                            Height =240
                                            Name ="Text35"
                                            Caption ="Vendor Name (optional)"
                                            FontName ="MS Sans Serif"
                                            GUID = Begin
                                                0x9561adc260e0d2448facd1f455f180d1
                                            End
                                        End
                                    End
                                End
                                Begin ComboBox
                                    LimitToList = NotDefault
                                    RowSourceTypeInt =1
                                    OverlapFlags =247
                                    IMESentenceMode =3
                                    ColumnCount =2
                                    ListWidth =1440
                                    Left =1020
                                    Top =1080
                                    Width =1560
                                    TabIndex =2
                                    GUID = Begin
                                        0x99f14d1c832d6c44bb33f8e74162edd7
                                    End
                                    Name ="comboFromMonth"
                                    RowSourceType ="Value List"
                                    RowSource ="1;\"January\";2;\"February\";3;\"March\";4;\"April\";5;\"May\";6;\"June\";7;\"Ju"
                                        "ly\";8;\"August\";9;\"September\";10;\"October\";11;\"November\";12;\"December\""
                                    ColumnWidths ="0;1440"
                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =240
                                            Top =1080
                                            Width =615
                                            Height =245
                                            Name ="Label49"
                                            Caption ="Month:"
                                            GUID = Begin
                                                0x5c048be6d3eb7844a1880a71483d0b3a
                                            End
                                        End
                                    End
                                End
                                Begin ComboBox
                                    RowSourceTypeInt =1
                                    OverlapFlags =247
                                    IMESentenceMode =3
                                    ListWidth =1440
                                    Left =1020
                                    Top =1500
                                    Width =1560
                                    TabIndex =3
                                    GUID = Begin
                                        0x54b38e11a34e1942b4e89d52d0f93221
                                    End
                                    Name ="comboFromYear"
                                    RowSourceType ="Value List"
                                    RowSource ="2000;2001;2002;2003;2004;2005;2006;2007;2008;2009;2010"
                                    ColumnWidths ="1440"
                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =240
                                            Top =1500
                                            Width =495
                                            Height =245
                                            Name ="Label51"
                                            Caption ="Year:"
                                            GUID = Begin
                                                0x41d6df42aa310449b680bbaf76994a06
                                            End
                                        End
                                    End
                                End
                                Begin ComboBox
                                    LimitToList = NotDefault
                                    RowSourceTypeInt =1
                                    OverlapFlags =247
                                    IMESentenceMode =3
                                    ColumnCount =2
                                    ListWidth =1440
                                    Left =3840
                                    Top =1080
                                    Width =1560
                                    TabIndex =4
                                    GUID = Begin
                                        0x7d4303e138ced44fa839fef475c1a73d
                                    End
                                    Name ="comboToMonth"
                                    RowSourceType ="Value List"
                                    RowSource ="1;\"January\";2;\"February\";3;\"March\";4;\"April\";5;\"May\";6;\"June\";7;\"Ju"
                                        "ly\";8;\"August\";9;\"September\";10;\"October\";11;\"November\";12;\"December\""
                                    ColumnWidths ="0;1440"
                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =3060
                                            Top =1080
                                            Width =615
                                            Height =245
                                            Name ="Label53"
                                            Caption ="Month:"
                                            GUID = Begin
                                                0x78bd052f3ee51e4285e83e19764fabfd
                                            End
                                        End
                                    End
                                End
                                Begin ComboBox
                                    RowSourceTypeInt =1
                                    OverlapFlags =247
                                    IMESentenceMode =3
                                    ListWidth =1440
                                    Left =3840
                                    Top =1500
                                    Width =1560
                                    TabIndex =5
                                    GUID = Begin
                                        0xbb3c8baaa0f5224f9bc2d7e970f7ddee
                                    End
                                    Name ="comboToYear"
                                    RowSourceType ="Value List"
                                    RowSource ="2000;2001;2002;2003;2004;2005;2006;2007;2008;2009;2010"
                                    ColumnWidths ="1440"
                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =3060
                                            Top =1500
                                            Width =495
                                            Height =245
                                            Name ="Label55"
                                            Caption ="Year:"
                                            GUID = Begin
                                                0x7b6c9389bf587f41a28cc385a51fefa5
                                            End
                                        End
                                    End
                                End
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

Private Sub UpdateData()
On Error GoTo errHandler

  Dim r As New Recordset, sSQL As String, sID As Long
  r.Open "dbo.tblProdSchedules", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
  r.Filter = "Month = " & Val(Me.comboMonth) & " And Year = " & Val(Me.comboYear)
  If r.BOF And r.EOF Then
    With r
      .AddNew
      !Month = Me.comboMonth
      !Year = Me.comboYear
      .Update
      sID = r!ScheduleID
    End With
  Else
    sID = r!ScheduleID
  End If
  
  r.Close
  Set r = Nothing
  
  'Update models
  sSQL = "insert into dbo.tblProdSchedItems (ScheduleID, Model, Quantity) "
  sSQL = sSQL & "select " & sID & ", Model, 0 from dbo.tblModels "
  sSQL = sSQL & "where Model NOT IN (select Model from dbo.tblProdSchedItems where ScheduleID = " & sID & ")"
  CurrentProject.Connection.Execute sSQL
  Me.ScheduleID = sID

Exit Sub
errHandler:
ErrHand Me.Name, "UpdateData"
Exit Sub
End Sub

Private Sub cmdPrevProdSched_Click()
On Error GoTo cmdPrevProdSched_Err

SetSPVar "FromMonth", Me.comboFromMonth.Value
SetSPVar "FromYear", Me.comboFromYear.Value
SetSPVar "ToMonth", Me.comboToMonth.Value
SetSPVar "ToYear", Me.comboToYear.Value
SetSPVar "Vendor", Me.comVendorName
DoCmd.OpenReport "parptProdSched", acViewPreview

Exit Sub
cmdPrevProdSched_Err:
ErrHand Me.Name, "cmdPrevProdSched"
Exit Sub
End Sub

Private Sub comboMonth_Change()

  UpdateData
  
End Sub

Private Sub comboYear_Change()

  UpdateData
  
End Sub

Private Sub Form_Load()
  
  Me.comboMonth.Value = Month(Now)
  Me.comboYear.Value = Year(Now)
  
  Me.comboFromMonth.Value = Me.comboMonth.Value
  Me.comboFromYear.Value = Me.comboYear.Value
  
  Me.comboToMonth.Value = Me.comboMonth.Value
  Me.comboToYear.Value = Me.comboYear.Value
  
  UpdateData
  
End Sub