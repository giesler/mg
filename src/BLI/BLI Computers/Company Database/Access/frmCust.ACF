Version =19
VersionRequired =19
Checksum =1953808643
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    ViewsAllowed =1
    GridX =24
    GridY =24
    Width =12093
    ItemSuffix =255
    Left =675
    Top =555
    Right =12165
    Bottom =5640
    Toolbar ="BLIFormToolbar"
    RecSrcDt = Begin
        0xc219c1f478c9e140
    End
    RecordSource ="SELECT apkCust, CustName, CustBusinessFlag FROM dbo.tblCust WHERE (CustBusinessF"
        "lag = 1)"
    Caption ="Business Customers"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    MenuBar ="BLIFormMenuBar"
    OnDeactivate ="=CloseFind()"
    OnResize ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ListBox
            SpecialEffect =2
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin CustomControl
            SpecialEffect =2
        End
        Begin FormHeader
            Height =0
            BackColor =-2147483633
            Name ="FormHeader"
        End
        Begin Section
            CanGrow = NotDefault
            Height =4680
            BackColor =-2147483633
            Name ="Detail0"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10080
                    Top =60
                    Width =486
                    Height =486
                    TabIndex =2
                    Name ="cmdClose"
                    OnClick ="=CloseForm()"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880888888 ,
                        0x8888888888888888888888880088888888888888888888888888888030888888 ,
                        0x8888888888888888888888033088888888888888888888888888803330888888 ,
                        0x8888888888888888888803333088888888888888888888888000333330000000 ,
                        0x00000888888888888880333330ffff0888888888888888888880333330ffff08 ,
                        0x88888888888888888880333300ffff0888888888888888888880333330ffff08 ,
                        0x88888488888888888880333330ffff0888884488888888888880333330ffff08 ,
                        0x88844488888888888880333330ffff0888444444488888888880333330ffff08 ,
                        0x84444444488888888880333330ffff0884444444488888888880333330ffff08 ,
                        0x8844444448888888888033330fffff08888444888888800088803330ffffff08 ,
                        0x88884488888880ff8880330fffffff0888888488888880ff888030ffffffff08 ,
                        0x888888888888800088800fffffffff0888888888888888888880000000000008 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =7200
                    Top =60
                    Width =480
                    Height =480
                    Name ="cmdPrint"
                    Caption ="Button20"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888000008888000000000000 ,
                        0x000088888880ffff8880888888888888888008888880ffff8880888888888888 ,
                        0x888080888880ffff8000000000000000000008088880ff00808888888888bbbb ,
                        0x888800808880ffff808888888888bbbb888808008880ffff8088888888887777 ,
                        0x888808808880ff008088888888888888888808880880ffff8000000000000000 ,
                        0x000008880880ffff8088888888888888888080880880ffff8808888888888888 ,
                        0x888088080880ffff8880000000000000000008800880ffff888880ffffffffff ,
                        0xff0880880880fff0888880ffffffffffff0088070880fff08888880ff0000000 ,
                        0xfff000008880ffff8888880ffffffffffff008888880000088888880ffffffff ,
                        0xffff088888888888888888880f00000000ff088888888888888888880fffffff ,
                        0xfffff088888888888888888880fffffffffff088888888888888888880000000 ,
                        0x0000008888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =5
                    Top =600
                    Width =12093
                    Name ="Line31"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =7680
                    Top =60
                    Width =540
                    Height =480
                    TabIndex =1
                    Name ="cmdPrintEnv"
                    Caption ="Button55"
                    OnClick ="=PrintEnvelope([apkCust])"
                    PictureData = Begin
                        0x2800000019000000180000000100040000000000800100000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x8888888888888888888888888888888888888888888888888888888888888888 ,
                        0x88888888888888888000000000000000000000008888888880ffffffffffffff ,
                        0xfffffff08888888880fffffffffffffffffffff08888888880ffffffff000000 ,
                        0xfffffff08888887780fffffffffffffffffffff08888870080ffffffffffffff ,
                        0xfffffff08888707780ffffffff00000000fffff08887077380ffffffffffffff ,
                        0xfffffff08880773380fffffffffffffffffffff08880733380ffffffffffffff ,
                        0xfffffff08880733380ffffffffffffffff111ff08880733080ff000000ffffff ,
                        0xff111ff08887780f80ffffffffffffffff111ff088808b0f80ffffffffffffff ,
                        0xfffffff08880b8b080000000000000000000000088880b8b8888888888888888 ,
                        0x88888888888880b8888888888888888888888888888888008888888888888888 ,
                        0x8888888888888888000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    ColumnCount =2
                    ListWidth =4320
                    Left =5580
                    Top =240
                    Width =1140
                    TabIndex =3
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"50\""
                    Name ="comFindCust"
                    RowSourceType ="Table/View/StoredProc"
                    RowSource ="dbo.qselCustBusiness"
                    ColumnWidths ="0;4320"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Tahoma"
                    BaseInfo ="\"dbo.qselCustBusiness\";\"\""
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =4740
                            Top =240
                            Width =720
                            Height =240
                            Name ="Label151"
                            Caption ="Jump to:"
                            FontName ="Tahoma"
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =1860
                    Top =780
                    Width =6480
                    ColumnWidth =3165
                    FontWeight =700
                    TabIndex =4
                    Name ="txtCustName"
                    ControlSource ="CustName"
                    StatusBarText ="Company's name"
                    OnDblClick ="=OpenFind(\"Name\")"
                    FontName ="Tahoma"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =420
                            Top =780
                            Width =1380
                            Height =240
                            BorderColor =6697728
                            ForeColor =10040115
                            Name ="lblCustName"
                            Caption ="Company Name:"
                            FontName ="Tahoma"
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =8880
                    Top =750
                    TabIndex =5
                    Name ="CustBusinessFlag"
                    ControlSource ="CustBusinessFlag"
                    StatusBarText ="If Yes, customer is a business, if no, customer is not a business"
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =9110
                            Top =720
                            Width =705
                            Height =240
                            Name ="Label154"
                            Caption ="Business"
                            FontName ="Tahoma"
                        End
                    End
                End
                Begin Label
                    OverlapFlags =223
                    TextAlign =1
                    Left =1050
                    Top =75
                    Width =4440
                    Height =420
                    FontSize =16
                    FontWeight =700
                    ForeColor =8421504
                    Name ="lblHead2"
                    Caption ="Business Customers"
                    FontName ="Tahoma"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    Left =1020
                    Top =60
                    Width =4440
                    Height =420
                    FontSize =16
                    FontWeight =700
                    ForeColor =128
                    Name ="lblHead"
                    Caption ="Business Customers"
                    FontName ="Tahoma"
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    SpecialEffect =0
                    Left =60
                    Top =60
                    Width =660
                    Height =480
                    TabIndex =6
                    Name ="subLogoSmall"
                    SourceObject ="Form.zfsubLogoSmall"
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =120
                    Top =1140
                    Width =2460
                    Height =3480
                    AutoActivate =1
                    TabIndex =7
                    Name ="tvAreas"
                    OleData = Begin
                        0x00120000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000a0901e812602bf010a00000080020000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000060000008e000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000900000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000030000008b000000 ,
                        0x0000000009000000fdffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfefffffffefffffffeffffff07000000ffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf028362800000000000000000000000080a022b32906bf010600000080020000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000060000008e000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000900000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000030000008b000000 ,
                        0x00000000ffffffffffffffff05000000fdfffffffefffffffeffffff07000000 ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffeffffff02000000feffffff0400000005000000feffffff07000000 ,
                        0x08000000fefffffffeffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff03004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000010000005c000000 ,
                        0x0000000002004f006c0065005000720065007300300030003000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000018000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000024000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000400000001000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000005c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b69041c78985d111b16a00c0f02836282143341208000000f3100000 ,
                        0xfa170000b13cc16a010006002200000039000000610100000800000079e8b506 ,
                        0x01efcdab0000050000000000060000000000000005000080a8f5120001000000 ,
                        0x5c001fdeecbd01000500b1f512000352e30b918fce119de300aa004bb8510100 ,
                        0x0000900144420100065461686f6d610000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000100feff030a0000ffffffffb69041c78985d111b16a00c0f0283628 ,
                        0x280000004d6963726f736f667420547265655669657720436f6e74726f6c2c20 ,
                        0x76657273696f6e20362e3000170000004d53436f6d63746c4c69622e54726565 ,
                        0x4374726c2e3200170000004d53436f6d63746c4c69622e547265654374726c2e ,
                        0x3200f439b2710000000000000000000000007901000203020310000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000001000002000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="TreeCtrl"
                    Class ="MSComctlLib.TreeCtrl.2"
                    GUID = Begin
                        0x26faed1b59d3414ca023a713ebee7a5e
                    End
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =2640
                    Top =1140
                    Width =7260
                    Height =3480
                    AutoActivate =1
                    TabIndex =8
                    Name ="lvItems"
                    OleData = Begin
                        0x00180000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000000000000000000000100000 ,
                        0x0800000001000000feffffff0000000001000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf028362800000000000000000000000080a022b32906bf010a00000080030000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000a00000096000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000d00000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000300000093000000 ,
                        0x0000000009000000fdffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfefffffffefffffffeffffff07000000ffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000a0901e812602bf010600000080030000 ,
                        0x00000000010043006f006d0070004f0062006a00000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000120002010200000003000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000a00000096000000 ,
                        0x0000000001004f006c0065000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000a000201ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000d00000014000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e0002010500000004000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000300000093000000 ,
                        0x00000000ffffffffffffffff05000000fdfffffffefffffffeffffff07000000 ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffeffffff02000000feffffff0400000005000000feffffffffffffff ,
                        0xffffffffffffffffffffffff0b0000000c000000fefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff03004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000010000005c000000 ,
                        0x0000000002004f006c0065005000720065007300300030003000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000018000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000024000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000400000001000000ffffffff000000000000000000000000 ,
                        0x0000000000000000888888888888880088888888888888888888888888888030 ,
                        0x888888885c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0xffff0888888888888888888880333300ffff0888888888888888888880333330 ,
                        0xffff08884bf0d1bd8b85d111b16a00c0f0283628214334120800000006320000 ,
                        0xfa1700004e087deb010006001c0000000000000000000000e382000606320000 ,
                        0x01efcdab0000050081e1af770780da0608000080050000800001038000000000 ,
                        0x00000000000000001fdeecbd0100050079e29b060352e30b918fce119de300aa ,
                        0x004bb85101000000900144420100065461686f6d610000200000000000000083 ,
                        0x05000007000000000000000000000000000000070000004e756d626572002000 ,
                        0x010002000000e406000005000000000000000000000000000000050000004461 ,
                        0x7465002000020000000000c80d00000600000000000000000000000000000006 ,
                        0x0000005061796565002000030001000000940700000800000000000000000000 ,
                        0x0000000000080000005061796d656e7400200004000100000045080000080000 ,
                        0x00000000000000000000000000080000004465706f7369740020000500020000 ,
                        0x0011020000020000000000000000000000000000000200000052002000060000 ,
                        0x000000000000000a0000000000000000000000000000000a000000536f72744f ,
                        0x7264657200000000000000000000000001000000000000006c00000000000000 ,
                        0x000000000100feff030a0000ffffffff4bf0d1bd8b85d111b16a00c0f0283628 ,
                        0x280000004d6963726f736f6674204c6973745669657720436f6e74726f6c2c20 ,
                        0x76657273696f6e20362e30001b0000004d53436f6d63746c4c69622e4c697374 ,
                        0x566965774374726c2e32001b0000004d53436f6d63746c4c69622e4c69737456 ,
                        0x6965774374726c2e3200f439b271000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000130000000000 ,
                        0xffff000001000002000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000000013000000000007000000a0dc120027003002 ,
                        0x02000000b0021300b00213000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00001d00feffffff02000000feffffff0400000005000000feffffffffffffff ,
                        0xffffffffffffffffffffffff0b0000000c000000fefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff03004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000010000005c000000 ,
                        0x0000000002004f006c0065005000720065007300300030003000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000018000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000024000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000400000001000000ffffffff000000000000000000000000 ,
                        0x0000000000000000888888888888880088888888888888888888888888888030 ,
                        0x888888885c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0xffff0888888888888888888880333300ffff0888888888888888888880333330 ,
                        0xffff08884bf0d1bd8b85d111b16a00c0f0283628214334120800000006320000 ,
                        0xfa1700004e087deb010006001c0000000000000000000000e382000606320000 ,
                        0x01efcdab00000500def7a4770780da0608000080050000800001038000000000 ,
                        0x00000000000000001fdeecbd01000500399222000352e30b918fce119de300aa ,
                        0x004bb85101000000900144420100065461686f6d610000200000000000000083 ,
                        0x05000007000000000000000000000000000000070000004e756d626572002000 ,
                        0x010002000000e406000005000000000000000000000000000000050000004461 ,
                        0x7465002000020000000000c80d00000600000000000000000000000000000006 ,
                        0x0000005061796565002000030001000000940700000800000000000000000000 ,
                        0x0000000000080000005061796d656e7400200004000100000045080000080000 ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                    GUID = Begin
                        0xf3b97d867a2bf042a8406325e9b64b34
                    End
                End
            End
        End
        Begin FormFooter
            Height =420
            BackColor =128
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =1260
                    Top =60
                    Width =360
                    Height =300
                    FontWeight =400
                    Name ="Button48"
                    Caption ="Button48"
                    OnClick ="=fRecNav(\"next\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8888800888888888800000008888800088888888840000008888800008888888 ,
                        0x8004322688888000008888888040e26288888000000888888440366688888000 ,
                        0x000088888111a3338888800000088888899deaee8888800000888888888caaaa ,
                        0x8888800008888888811133228888800088888888811909108888800888888888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =900
                    Top =60
                    Width =360
                    Height =300
                    FontWeight =400
                    TabIndex =1
                    Name ="Button49"
                    Caption ="Button49"
                    OnClick ="=fRecNav(\"prev\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8888888800888888800000008888888000888888840000008888880000888888 ,
                        0x8004322688888000008888888040e26288880000008888888440366688800000 ,
                        0x008888888111a3338888000000888888899deaee8888800000888888888caaaa ,
                        0x8888880000888888811133228888888000888888811909108888888800888888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =1620
                    Top =60
                    Width =360
                    Height =300
                    FontWeight =400
                    TabIndex =2
                    Name ="Button50"
                    Caption ="Button50"
                    OnClick ="=fRecNav(\"last\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8800888888800888800000008800088888800888840000008800008888800888 ,
                        0x8004322688000008888008888040e26288000000888008888440366688000000 ,
                        0x088008888111a3338800000088800888899deaee8800000888800888888caaaa ,
                        0x8800008888800888811133228800088888800888811909108800888888800888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x0000000000000000000000000000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =540
                    Top =60
                    Width =360
                    Height =300
                    FontWeight =400
                    TabIndex =3
                    Name ="cmdPrevious"
                    Caption ="Button51"
                    OnClick ="=fRecNav(\"first\")"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8800888888800888800000008800888888000888840000008800888880000888 ,
                        0x8004322688008888000008888040e26288008880000008888440366688008800 ,
                        0x000008888111a3338800888000000888899deaee8800888800000888888caaaa ,
                        0x8800888880000888811133228800888888000888811909108800888888800888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x00000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =1980
                    Top =60
                    Width =360
                    Height =300
                    FontWeight =400
                    TabIndex =4
                    Name ="cmdNew"
                    Caption ="Button52"
                    OnClick ="=fRecNav(\"new\")"
                    PictureData = Begin
                        0x28000000100000000f0000000100040000000000780000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x80800000c0c0c000808080000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00777777777777777777777777777777777777777777777777 ,
                        0x7077777777777777700777777770777770007777707070777000077777000777 ,
                        0x7000007700000007700007777700077770007777707070777007777777707777 ,
                        0x7077777777777777777777777777777777777777777777777777777777777777 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0xc0c0c00080808000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =540
                    Top =60
                    Width =1800
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =5
                    Name ="cmdShowAll"
                    Caption ="Show All"
                    OnClick ="=fRecNav(\"showall\")"
                    FontName ="Tahoma"
                End
                Begin OptionButton
                    OverlapFlags =85
                    Left =180
                    Top =120
                    Width =240
                    Height =180
                    TabIndex =6
                    Name ="optHideCosts"
                    DefaultValue ="True"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =67
                    TextFontFamily =34
                    Left =10800
                    Top =60
                    Width =1020
                    Height =300
                    FontSize =8
                    FontWeight =400
                    TabIndex =7
                    Name ="cmdBarCloseForm"
                    Caption ="&Close"
                    OnClick ="=CloseForm()"
                    FontName ="Tahoma"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons

Dim wHeight As Long
Public blnHome As Boolean

Private Sub comFindCust_AfterUpdate()
On Error GoTo comFindCust_Err

Dim rst As Recordset

Set rst = Me.RecordsetClone

If IsNull(Me.comFindCust) Then Exit Sub

rst.Find "[apkCust] = " & Me.comFindCust
Me.Form.Bookmark = rst.Bookmark

Exit Sub
comFindCust_Err:
ErrHand Me.Name, "comFindCust"
Exit Sub

End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
If Not blnHome Then Me.CustBusinessFlag = True
End Sub

Private Sub Form_Close()
On Error Resume Next
Me.ServerFilter = ""
End Sub

Private Sub Form_Current()
tvAreas_Click
End Sub

Private Sub Form_Open(Cancel As Integer)
On Error GoTo Form_Open_Err

If InStr(UCase(Me.OpenArgs), "CMDSHOWALL") Then
  Me!cmdShowAll.Visible = True
End If

If InStr(UCase(Me.OpenArgs), "HOME") Then
  Me.RecordSource = "SELECT apkCust, CustName, CustBusinessFlag FROM tblCust WHERE (CustBusinessFlag = 0)"
  Me.lblCustName.Caption = "Customer Name"
  Me.lblHead.Caption = "Home Customers"
  Me.lblHead2.Caption = "Home Customers"
  Me.comFindCust.RowSource = "dbo.qselCustHome"
  Me.Caption = "Home Customers"
  blnHome = True
End If

If InStr(UCase(Me.OpenArgs), "CUSTID=") Then
  Dim CustId As Long
  CustId = Val(Mid(Me.OpenArgs, InStr(Me.OpenArgs, "CUSTID=") + 7))
  Me.Filter = "apkCust = " & CustId
  Me.FilterOn = True
End If

wHeight = 0

Dim n As Node, p As Node

Set p = Me.tvAreas.Nodes.Add(, , , "Purchasing")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Invoices")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Sales Orders")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Quotes")
If Not blnHome Then Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Labor Logs")
p.Expanded = True

Set p = Me.tvAreas.Nodes.Add(, , , "Contact Information")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Phone Numbers")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Addresses")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Contacts")
p.Expanded = True

Set p = Me.tvAreas.Nodes.Add(, , , "Other Information")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Computers")
Set n = Me.tvAreas.Nodes.Add(p, tvwChild, , "Misc. Info")
p.Expanded = True

Exit Sub
Form_Open_Err:
ErrHand Me.Name, "Form_Open_Err"
Exit Sub

End Sub

Private Sub Form_Resize()
On Error GoTo Form_Resize_Err

Dim topHeight As Long, detHeight As Long, curWindowHeight

' Check to see if window was resized
curWindowHeight = GetWindowHeight
If wHeight = curWindowHeight Then
    Exit Sub
End If

wHeight = curWindowHeight

topHeight = 1220    ' height above tab control
detHeight = 6720    ' detail height before resizing

Me.tvAreas.Height = 1000
Me.lvItems.Height = 1000
Me.Detail0.Height = detHeight

Me.Detail0.Height = wHeight * TwipsPerPixelY - Me.FormFooter.Height - 1600
Me.tvAreas.Height = Me.Detail0.Height - topHeight
Me.lvItems.Height = Me.tvAreas.Height

Exit Sub
Form_Resize_Err:
ErrHand Me.Name, "Form_Resize"
Exit Sub


End Sub

Private Sub lvItems_DblClick()
On Error GoTo lvItems_DblClick_Err

Dim n As Node, li As ListItem
Set n = Me.tvAreas.SelectedItem
If n Is Nothing Then Exit Sub
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub

If IsNull(Me!apkCust) Then
  If IsNull(Me.txtCustName) Then
    MsgBox "Please enter a customer name!", vbExclamation
    Me.txtCustName.SetFocus
    Exit Sub
  End If
  DoCmd.RunCommand acCmdSaveRecord
End If

Select Case n.Text
  Case "Invoices"
    If Mid(li.key, 3) = "add" Then
      NewInvoice (Me!apkCust)
    Else
      liEditInvoice
    End If
  Case "Sales Orders"
    If Mid(li.key, 3) = "add" Then
      NewSale Me!apkCust
    Else
      liEditSaleOrder
    End If
  Case "Quotes"
    If Mid(li.key, 3) = "add" Then
      NewQuote Me!apkCust
    Else
      liEditQuote
    End If
  Case "Labor Logs"
    If Mid(li.key, 3) = "add" Then
      NewLaborSheet Me!apkCust
    Else
      OpenLaborSheet Val(Mid(li.key, 3))
    End If
  Case "Phone Numbers"
    If Mid(li.key, 3) = "add" Then
      liEditPhoneNumber True
    Else
      liEditPhoneNumber False
    End If
  Case "Addresses"
    If Mid(li.key, 3) = "add" Then
      liEditAddress True
    Else
      liEditAddress False
    End If
  Case "Contacts"
    If Mid(li.key, 3) = "add" Then
      liEditContact True
    Else
      liEditContact False
    End If
  Case "Computers"
    If Mid(li.key, 3) = "add" Then
      liEditComputer True
    Else
      liEditComputer False
    End If
  Case "Misc. Info"
    liEditMiscInfo
End Select

Exit Sub
lvItems_DblClick_Err:
ErrHand Me.Name, "lvItems_DblClick_Err"
Exit Sub

End Sub

Private Sub lvItems_KeyUp(KeyCode As Integer, ByVal Shift As Integer)
On Error GoTo lvItems_KeyUp_Err

Dim li As ListItem, sSQL As String, n As Node, cnn As Connection
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
Set n = Me.tvAreas.SelectedItem
If n Is Nothing Then Exit Sub
Set cnn = CurrentProject.Connection

If KeyCode <> vbKeyDelete Then Exit Sub

If Mid(li.key, 3) = "add" Then
  MsgBox "You can't delete the 'Add new' item.", vbExclamation
  Exit Sub
End If

Select Case n.Text
  Case "Invoices"
    MsgBox "You can't delete invoices.  To void an invoice, open the invoice and click 'Void' at the bottom of the screen.", vbExclamation
  Case "Sales Orders"
    MsgBox "You can't delete sales orders.  To void a sales order, open it and click 'Void' at the bottom of the screen.", vbExclamation
  Case "Quotes"
    MsgBox "You can't delete quotes.", vbExclamation
  Case "Labor Logs"
    MsgBox "You can't delete labor logs.", vbExclamation
  Case "Phone Numbers"
    If (li.SubItems(3) = Chr(215)) Then
      MsgBox "You can't delete the 'Main' number.  Open another number and mark it as main, then delete this number.", vbExclamation
    Else
      If MsgBox("Are you sure you want to delete the '" & li.Text & "' number, '" & li.SubItems(1) & "'?", vbQuestion + vbYesNo) = vbYes Then
        cnn.Execute "DELETE FROM tblCustPhone WHERE apkCPhone = " & Val(Mid(li.key, 3))
        Me.lvItems.ListItems.Remove li.Index
      End If
    End If
  Case "Addresses"
    If li.SubItems(3) = Chr(215) Then
      MsgBox "You can't delete the 'Mail' address.  Open another address and mark it as mail, then delete this address.", vbExclamation
    Else
      If MsgBox("Are you sure you want to delete the '" & li.Text & "' address?", vbQuestion + vbYesNo) = vbYes Then
        cnn.Execute "DELETE FROM tblCustAddr WHERE apkCAddr = " & Val(Mid(li.key, 3))
        Me.lvItems.ListItems.Remove li.Index
      End If
    End If
  Case "Contacts"
    If li.SubItems(3) = Chr(215) Then
      MsgBox "You can't delete the primary contact.  Open another contact and mark it as primary, then delete this contact.", vbExclamation
    Else
      If MsgBox("Are you sure you want to delete '" & li.Text & "'?", vbQuestion + vbYesNo) = vbYes Then
        cnn.Execute "DELETE FROM tblCustCon WHERE apkCon = " & Val(Mid(li.key, 3))
        Me.lvItems.ListItems.Remove li.Index
      End If
    End If
  Case "Computers"
    MsgBox "You can't delete a computer yet.", vbExclamation
  Case "Misc. Info"
    MsgBox "You can't delete this information.  If you would like to edit it, double click it.", vbExclamation
End Select

Exit Sub
lvItems_KeyUp_Err:
ErrHand Me.Name, "lvItems_KeyUp_Err"
Exit Sub

End Sub

Private Sub optHideCosts_Click()
If Me.optHideCosts = True Then
Else
    If SecureAuthorize = False Then
        Me.optHideCosts = True
        Exit Sub
    End If
End If
End Sub

Private Sub tvAreas_Click()
On Error GoTo tvAreas_Click_Err

Dim n As Node
Set n = Me.tvAreas.SelectedItem
If n Is Nothing Then Exit Sub

Me.lvItems.ListItems.Clear
Me.lvItems.ColumnHeaders.Clear
Select Case n.Text
  Case "Invoices"
    FillInvoices
  Case "Sales Orders"
    FillSalesOrders
  Case "Quotes"
    FillQuotes
  Case "Labor Logs"
    FillLaborSheets
  Case "Phone Numbers"
    FillPhoneNumbers
  Case "Addresses"
    FillAddresses
  Case "Contacts"
    FillContacts
  Case "Computers"
    FillComputers
  Case "Misc. Info"
    FillMiscInfo
End Select

Exit Sub
tvAreas_Click_Err:
ErrHand Me.Name, "tvAreas_Err"
Exit Sub
End Sub

Private Sub FillInvoices()
On Error GoTo FillInvoices_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Title", 2400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Invoice", 1000, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Date", 900, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Total", 1050, lvwColumnRight)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Paid", 600, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Discount", 800, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "SortOrder", 0, lvwColumnLeft)
Me.lvItems.Sorted = True
Me.lvItems.SortKey = 6
Me.lvItems.SortOrder = lvwDescending

Set li = Me.lvItems.ListItems.Add(, "i:add", "Add new invoice")
li.SubItems(3) = " "
PadListRow li
li.SubItems(6) = "99999999"

sSQL = "SELECT apkInv, InvNumber, InvDate, InvTitle, InvTotal, " _
  & "InvDiscFlag, InvPaymentReceivedFlag FROM tblInvoice "
sSQL = sSQL & "WHERE afkInvCust = " & Nz(Me.apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "i:" & r!apkInv, Nz(r!InvTitle, ""))
  li.SubItems(1) = r!InvNumber
  li.SubItems(2) = Format(r!InvDate, "Short Date")
  li.SubItems(3) = Format(r!InvTotal, "Currency")
  li.SubItems(4) = IIf(r!InvPaymentReceivedFlag, Chr(215), " ")
  li.SubItems(5) = IIf(r!InvDiscFlag, Chr(215), " ")
  li.SubItems(6) = CDateToStr(r!InvDate)
  r.MoveNext
Loop
r.Close

Exit Sub
FillInvoices_Err:
ErrHand Me.Name, "FillInvoices"
Exit Sub
End Sub

Private Sub liEditInvoice()
On Error GoTo liEditInvoice_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgInvInfo
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
id = Val(Mid(li.key, 3))
fE.Filter = "apkInv = " & id
fE.FilterOn = True
If Not Me.optHideCosts Then
  fE.txtInvCost.Visible = True
  fE.txtInvProfit.Visible = True
End If
Pause fE
  
If Not fE.blnCancel Then
  li.Text = Nz(fE.txtInvTitle, "")
  li.SubItems(4) = IIf(fE.chkInvPaymentReceivedFlag, Chr(215), "")
  li.SubItems(5) = IIf(fE.chkInvDiscFlag, Chr(215), "")
End If

Exit Sub
liEditInvoice_Err:
ErrHand Me.Name, "liEditInvoice"
Exit Sub
End Sub


Private Sub FillSalesOrders()
On Error GoTo FillSalesOrders_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Title", 3800, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Sale Order", 1000, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Date", 900, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Total", 1050, lvwColumnRight)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "SortOrder", 0, lvwColumnLeft)
Me.lvItems.Sorted = True
Me.lvItems.SortKey = 4
Me.lvItems.SortOrder = lvwDescending

Set li = Me.lvItems.ListItems.Add(, "s:add", "Add new sale order")
li.SubItems(3) = " "
PadListRow li
li.SubItems(4) = "99999999"

sSQL = "SELECT apkSale, SaleNumber, SaleDate, SaleTitle, SaleTotal "
sSQL = sSQL & "FROM tblSale WHERE afkSaleCust = " & Nz(Me.apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "i:" & r!apkSale, Nz(r!SaleTitle, ""))
  li.SubItems(1) = r!SaleNumber
  li.SubItems(2) = Format(r!SaleDate, "Short Date")
  li.SubItems(3) = Format(r!SaleTotal, "Currency")
  li.SubItems(4) = CDateToStr(r!SaleDate)
  r.MoveNext
Loop
r.Close

Exit Sub
FillSalesOrders_Err:
ErrHand Me.Name, "FillSalesOrders"
Exit Sub
End Sub

Private Sub liEditSaleOrder()
On Error GoTo liEditSaleOrder_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgSaleOrder
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
id = Val(Mid(li.key, 3))
fE.Filter = "apkSale = " & id
fE.FilterOn = True
If Not Me.optHideCosts Then
  fE.txtSaleCost.Visible = True
  fE.txtSaleProfit.Visible = True
End If
Pause fE
  
If Not fE.blnCancel Then
  li.Text = Nz(fE.txtSaleTitle, "")
End If

Exit Sub
liEditSaleOrder_Err:
ErrHand Me.Name, "liEditSaleOrder"
Exit Sub
End Sub


Private Sub FillQuotes()
On Error GoTo FillQuotes_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Title", 3400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Quote", 1200, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Date", 900, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Total", 1050, lvwColumnRight)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "SortOrder", 0, lvwColumnLeft)
Me.lvItems.Sorted = True
Me.lvItems.SortKey = 4
Me.lvItems.SortOrder = lvwDescending

Set li = Me.lvItems.ListItems.Add(, "q:add", "Add new quote")
li.SubItems(3) = " "
PadListRow li
li.SubItems(4) = "99999999"

sSQL = "SELECT apkQuote, QuoteNumber, QuoteDate, QuoteTitle, QuoteTotal "
sSQL = sSQL & "FROM tblQuote WHERE afkQuoteCust = " & Nz(Me.apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "i:" & r!apkQuote, Nz(r!QuoteTitle, ""))
  li.SubItems(1) = r!QuoteNumber
  li.SubItems(2) = Format(r!QuoteDate, "Short Date")
  li.SubItems(3) = Format(r!QuoteTotal, "Currency")
  li.SubItems(4) = CDateToStr(r!QuoteDate)
  r.MoveNext
Loop
r.Close

Exit Sub
FillQuotes_Err:
ErrHand Me.Name, "FillQuotes"
Exit Sub
End Sub

Private Sub liEditQuote()
On Error GoTo liEditQuote_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgQuote
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
id = Val(Mid(li.key, 3))
fE.Filter = "apkQuote = " & id
fE.FilterOn = True
If Not Me.optHideCosts Then
  fE.txtQuoteCost.Visible = True
  fE.txtQuoteProfit.Visible = True
End If
Pause fE
  
If Not fE.blnCancel Then
  li.Text = Nz(fE.txtQuoteTitle, "")
End If

Exit Sub
liEditQuote_Err:
ErrHand Me.Name, "liEditQuote"
Exit Sub
End Sub


Private Sub FillPhoneNumbers()
On Error GoTo FillPhoneNumbers_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Description", 2200, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Phone Number", 1600, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Note", 2400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Main", 600, lvwColumnCenter)
Me.lvItems.Sorted = False

Set li = Me.lvItems.ListItems.Add(, "p:add", "Add new phone number")
PadListRow li

sSQL = "SELECT apkCPhone, afkCPhoneCust, CPhoneMain, CPhoneDesc, CPhoneNumber, CPhoneNote "
sSQL = sSQL & "FROM tblCustPhone WHERE afkCPhoneCust = " & Nz(Me!apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "p:" & r!apkCPhone, Nz(r!CPhoneDesc, ""))
  li.SubItems(1) = Nz(r!CPhoneNumber, "")
  li.SubItems(2) = Nz(r!CPhoneNote, "")
  li.SubItems(3) = IIf(r!CPhoneMain, Chr(215), "")
  r.MoveNext
Loop
r.Close

Exit Sub
FillPhoneNumbers_Err:
ErrHand Me.Name, "FillPhoneNumbers"
Exit Sub
End Sub

Private Sub liEditPhoneNumber(blnAdd As Boolean)
On Error GoTo liEditPhoneNumber_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgCustPhone, id2 As Long
Dim r As New Recordset, blnFoundMain As Boolean, oLI As ListItem
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
If blnAdd Then
  r.Open "tblCustPhone", CurrentProject.Connection, adOpenDynamic, adLockOptimistic
  r.AddNew
  r!afkCPhoneCust = Me.apkCust
  r.Update
  id = r!apkCPhone
  r.Close
Else
  id = Val(Mid(li.key, 3))
End If
fE.Filter = "apkCPhone = " & id
fE.FilterOn = True
Pause fE
  
If blnAdd And fE.blnCancel Then
  CurrentProject.Connection.Execute "DELETE FROM tblCustPhone WHERE apkCPhone = " & fE.apkCPhone
End If

If Not fE.blnCancel Then
  If blnAdd Then Set li = Me.lvItems.ListItems.Add(, "p:" & fE.apkCPhone)
  li.Text = Nz(fE.comCPhoneDesc, "")
  li.SubItems(1) = Nz(fE.txtCPhoneNumber, "")
  li.SubItems(2) = Nz(fE.txtCPhoneNote, "")
  li.SubItems(3) = IIf(fE.chkCPhoneMain, Chr(215), "")
  If fE.chkCPhoneMain Then
    For Each oLI In Me.lvItems.ListItems
      If Mid(oLI.key, 3) <> "add" Then
        id2 = Val(Mid(oLI.key, 3))
        If oLI.SubItems(3) = Chr(215) And id2 <> id Then
          CurrentProject.Connection.Execute "UPDATE tblCustPhone SET CPhoneMain = 0 WHERE apkCPhone = " & id2
          oLI.SubItems(3) = ""
        End If
      End If
    Next oLI
  Else
    For Each oLI In Me.lvItems.ListItems
      If oLI.SubItems(3) = Chr(215) Then blnFoundMain = True
    Next oLI
    If Not blnFoundMain Then
      CurrentProject.Connection.Execute "UPDATE tblCustPhone SET CPhoneMain = 1 WHERE apkCPhone = " & id
      li.SubItems(3) = Chr(215)
      If Not blnAdd Then MsgBox "The current phone number has been set as the main phone number because there wasn't another phone number set as main.  To set another as main, double click it and check 'Main'.", vbExclamation
    End If
  End If
End If

Exit Sub
liEditPhoneNumber_Err:
ErrHand Me.Name, "liEditPhoneNumber"
Exit Sub
End Sub


Private Sub FillAddresses()
On Error GoTo FillAddresses_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Description", 1500, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Address", 2400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "City, ST  Zip", 2400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Mail", 600, lvwColumnCenter)
Me.lvItems.Sorted = False

Set li = Me.lvItems.ListItems.Add(, "p:add", "Add new address")
PadListRow li

sSQL = "SELECT apkCAddr, CAddrMail, CAddrDesc, CAddrAddr, CAddrCity, CAddrState, CAddrZip "
sSQL = sSQL & "FROM tblCustAddr WHERE afkCAddrCust = " & Nz(Me!apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "p:" & r!apkCAddr, Nz(r!CAddrDesc, ""))
  li.SubItems(1) = Nz(r!CAddrAddr, "")
  li.SubItems(2) = Nz(r!CAddrCity, "") & ", " & Nz(r!CAddrState, "") & "  " & Nz(r!CAddrZip, "")
  li.SubItems(3) = IIf(r!CAddrMail, Chr(215), "")
  r.MoveNext
Loop
r.Close

Exit Sub
FillAddresses_Err:
ErrHand Me.Name, "FillAddresses"
Exit Sub
End Sub

Private Sub liEditAddress(blnAdd As Boolean)
On Error GoTo liEditAddress_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgCustAddr, id2 As Long
Dim r As New Recordset, blnFoundMain As Boolean, oLI As ListItem
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
If blnAdd Then
  r.Open "tblCustAddr", CurrentProject.Connection, adOpenDynamic, adLockOptimistic
  r.AddNew
  r!afkCAddrCust = Me.apkCust
  r.Update
  id = r!apkCAddr
  r.Close
Else
  id = Val(Mid(li.key, 3))
End If
fE.Filter = "apkCAddr = " & id
fE.FilterOn = True
Pause fE
  
If blnAdd And fE.blnCancel Then
  CurrentProject.Connection.Execute "DELETE FROM tblCustAddr WHERE apkCAddr = " & fE.apkCAddr
End If

If Not fE.blnCancel Then
  If blnAdd Then Set li = Me.lvItems.ListItems.Add(, "p:" & fE.apkCAddr)
  li.Text = Nz(fE.comCAddrDesc, "")
  li.SubItems(1) = Nz(fE.txtCAddrAddr, "")
  li.SubItems(2) = Nz(fE.txtCAddrCity, "") & ", " & Nz(fE.txtCAddrState, "") & "  " & Nz(fE.txtCAddrZip, "")
  li.SubItems(3) = IIf(fE.chkCAddrMail, Chr(215), "")
  If fE.chkCAddrMail Then
    For Each oLI In Me.lvItems.ListItems
      If Mid(oLI.key, 3) <> "add" Then
        id2 = Val(Mid(oLI.key, 3))
        If oLI.SubItems(3) = Chr(215) And id2 <> id Then
          CurrentProject.Connection.Execute "UPDATE tblCustAddr SET CAddrMail = 0 WHERE apkCAddr = " & id2
          oLI.SubItems(3) = ""
        End If
      End If
    Next oLI
  Else
    For Each oLI In Me.lvItems.ListItems
      If oLI.SubItems(3) = Chr(215) Then blnFoundMain = True
    Next oLI
    If Not blnFoundMain Then
      CurrentProject.Connection.Execute "UPDATE tblCustAddr SET CAddrMail = 1 WHERE apkCAddr = " & id
      li.SubItems(3) = Chr(215)
      If Not blnAdd Then MsgBox "The current address has been set as the mailling address because there wasn't another address set as the mailling address.  To set another as mailling, double click it and check 'Mail'.", vbExclamation
    End If
  End If
End If

Exit Sub
liEditAddress_Err:
ErrHand Me.Name, "liEditAddress"
Exit Sub
End Sub


Private Sub FillContacts()
On Error GoTo FillContacts_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Name", 2000, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Phone", 1600, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Notes", 2400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Primary", 800, lvwColumnCenter)
Me.lvItems.Sorted = False

Set li = Me.lvItems.ListItems.Add(, "c:add", "Add new contact")
PadListRow li

sSQL = "SELECT apkCon, ConName, ConPhone, ConNotes, ConPrimaryFlag "
sSQL = sSQL & "FROM tblCustCon WHERE afkConCust = " & Nz(Me!apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "p:" & r!apkCon, Nz(r!ConName, ""))
  li.SubItems(1) = Nz(r!ConPhone, "")
  li.SubItems(2) = Nz(r!ConNotes, "")
  li.SubItems(3) = IIf(r!ConPrimaryFlag, Chr(215), "")
  r.MoveNext
Loop
r.Close

Exit Sub
FillContacts_Err:
ErrHand Me.Name, "FillContacts"
Exit Sub
End Sub

Private Sub liEditContact(blnAdd As Boolean)
On Error GoTo liEditContact_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgCustCon, id2 As Long
Dim r As New Recordset, blnFoundMain As Boolean, oLI As ListItem
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
If blnAdd Then
  r.Open "tblCustCon", CurrentProject.Connection, adOpenDynamic, adLockOptimistic
  r.AddNew
  r!afkConCust = Me.apkCust
  r.Update
  id = r!apkCon
  r.Close
Else
  id = Val(Mid(li.key, 3))
End If
fE.Filter = "apkCon = " & id
fE.FilterOn = True
Pause fE
  
If blnAdd And fE.blnCancel Then
  CurrentProject.Connection.Execute "DELETE FROM tblCustCon WHERE apkCon = " & id
End If

If Not fE.blnCancel Then
  If blnAdd Then Set li = Me.lvItems.ListItems.Add(, "p:" & id)
  li.Text = Nz(fE.txtConName, "")
  li.SubItems(1) = Nz(fE.txtConPhone, "")
  li.SubItems(2) = Nz(fE.txtConNotes, "")
  li.SubItems(3) = IIf(fE.chkConPrimaryFlag, Chr(215), "")
  If fE.chkConPrimaryFlag Then
    For Each oLI In Me.lvItems.ListItems
      If Mid(oLI.key, 3) <> "add" Then
        id2 = Val(Mid(oLI.key, 3))
        If oLI.SubItems(3) = Chr(215) And id2 <> id Then
          CurrentProject.Connection.Execute "UPDATE tblCustCon SET ConPrimaryFlag = 0 WHERE apkCon = " & id2
          oLI.SubItems(3) = ""
        End If
      End If
    Next oLI
  Else
    For Each oLI In Me.lvItems.ListItems
      If oLI.SubItems(3) = Chr(215) Then blnFoundMain = True
    Next oLI
    If Not blnFoundMain Then
      CurrentProject.Connection.Execute "UPDATE tblCustCon SET ConPrimaryFlag = 1 WHERE apkCon = " & id
      li.SubItems(3) = Chr(215)
      If Not blnAdd Then MsgBox "The current contact has been set as the primary contact because there wasn't another primary contact set.  To set someone else as primary, double click their line and check 'Primary'.", vbExclamation
    End If
  End If
End If

Exit Sub
liEditContact_Err:
ErrHand Me.Name, "liEditContact"
Exit Sub
End Sub


Private Sub FillComputers()
On Error GoTo FillComputers_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Name", 2200, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Type", 1400, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "HD", 1000, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "RAM", 1000, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Notes", 1300, lvwColumnLeft)
Me.lvItems.Sorted = False

Set li = Me.lvItems.ListItems.Add(, "m:add", "Add new computer")
PadListRow li

sSQL = "SELECT apkCComp, CCompName, CCompType, CCompHardDrive, CCompRAM, CCompNotes "
sSQL = sSQL & "FROM tblCustComp WHERE afkCCompCust = " & Nz(Me!apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "p:" & r!apkCComp, Nz(r!CCompName, ""))
  li.SubItems(1) = Nz(r!CCompType, "")
  li.SubItems(2) = Nz(r!CCompHardDrive, "")
  li.SubItems(3) = Nz(r!CCompRAM, "")
  li.SubItems(4) = Nz(r!CCompNotes, "")
  r.MoveNext
Loop
r.Close

Exit Sub
FillComputers_Err:
ErrHand Me.Name, "FillComputers"
Exit Sub
End Sub

Private Sub liEditComputer(blnAdd As Boolean)
On Error GoTo liEditComputer_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgCustComp, id2 As Long
Dim r As New Recordset, blnFoundMain As Boolean, oLI As ListItem
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
If blnAdd Then
  r.Open "tblCustComp", CurrentProject.Connection, adOpenDynamic, adLockOptimistic
  r.AddNew
  r!afkCompCust = Me.apkCust
  r.Update
  id = r!apkCComp
  r.Close
Else
  id = Val(Mid(li.key, 3))
End If
fE.Filter = "apkCComp = " & id
fE.FilterOn = True
Pause fE
  
If blnAdd And fE.blnCancel Then
  CurrentProject.Connection.Execute "DELETE FROM tblCustComp WHERE apkCComp = " & id
End If

If Not fE.blnCancel Then
  If blnAdd Then Set li = Me.lvItems.ListItems.Add(, "p:" & id)
  li.Text = Nz(fE.txtCCompName, "")
  li.SubItems(1) = Nz(fE.comCCompType, "")
  li.SubItems(2) = Nz(fE.txtCCompHardDrive, "")
  li.SubItems(3) = Nz(fE.txtCCompRAM, "")
  li.SubItems(4) = Nz(fE.txtCCompNotes, "")
End If

Exit Sub
liEditComputer_Err:
ErrHand Me.Name, "liEditComputer"
Exit Sub
End Sub

Private Sub FillLaborSheets()
On Error GoTo FillLaborSheets_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Title", 2500, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Number", 1000, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Printed", 900, lvwColumnCenter)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "BLI Notes", 2450, lvwColumnLeft)
Me.lvItems.Sorted = False

Set li = Me.lvItems.ListItems.Add(, "l:add", "Add new labor sheet")
PadListRow li

sSQL = "SELECT apkLabor, LaborTitle, LaborSummaryNum, LaborLastPrint, LaborBLINotes "
sSQL = sSQL & "FROM tblLabor WHERE afkLaborCust = " & Nz(Me.apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, "i:" & r!apkLabor, Nz(r!LaborTitle, ""))
  li.SubItems(1) = r!LaborSummaryNum
  li.SubItems(2) = Format(r!LaborLastPrint, "Short Date")
  li.SubItems(3) = Nz(r!LaborBLINotes, "")
  r.MoveNext
Loop
r.Close

Exit Sub
FillLaborSheets_Err:
ErrHand Me.Name, "FillLaborSheets"
Exit Sub
End Sub

Private Sub FillMiscInfo()
On Error GoTo FillMiscInfo_Err

Dim li As ListItem, lsi As ListSubItem, sSQL As String, r As New Recordset, ch As ColumnHeader

Set ch = Me.lvItems.ColumnHeaders.Add(, , "Labor Rate", 1000, lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Terms", IIf(blnHome, 0, 1300), lvwColumnLeft)
Set ch = Me.lvItems.ColumnHeaders.Add(, , "Notes", 4500, lvwColumnLeft)
Me.lvItems.Sorted = False

If IsNull(Me!apkCust) Then
  If IsNull(Me.txtCustName) Then
    MsgBox "Please enter a customer name then click 'Misc Info' again.", vbExclamation
    Exit Sub
  End If
  DoCmd.RunCommand acCmdSaveRecord
End If

sSQL = "SELECT tblCust.CustName, tblCust.CustLaborRate, tblCust.afkCustTerm, "
sSQL = sSQL & "tblTerm.Term, tblCust.CustCustomerNotes "
sSQL = sSQL & "FROM tblCust LEFT OUTER JOIN tblTerm ON tblCust.afkCustTerm = tblTerm.apkTerm "
sSQL = sSQL & "WHERE tblCust.apkCust = " & Nz(Me.apkCust, 0)

r.Open sSQL, CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly
Do While Not r.EOF
  Set li = Me.lvItems.ListItems.Add(, , "")
  li.Text = Format(Nz(r!CustLaborRate, ""), "Currency")
  li.SubItems(1) = Nz(r!Term, "")
  li.SubItems(2) = Nz(r!CustCustomerNotes, "")
  r.MoveNext
Loop
r.Close

Exit Sub
FillMiscInfo_Err:
ErrHand Me.Name, "FillMiscInfo"
Exit Sub
End Sub

Private Sub liEditMiscInfo()
On Error GoTo liEditMiscInfo_Err

Dim li As ListItem, id As Long, fE As New Form_fdlgCustNotes
Dim r As New Recordset
Set li = Me.lvItems.SelectedItem
If li Is Nothing Then Exit Sub
  
If IsNull(Me!apkCust) Then DoCmd.RunCommand acCmdSaveRecord

fE.Filter = "apkCust = " & Me!apkCust
fE.FilterOn = True
fE.comafkCustTerm.Visible = Not blnHome
Pause fE
  
If Not fE.blnCancel Then
  li.Text = Format(Nz(fE.txtCustLaborRate, ""), "Currency")
  li.SubItems(1) = Nz(fE.comafkCustTerm.Column(1), "")
  li.SubItems(2) = Nz(fE.txtCustCustomerNotes, "")
End If

Exit Sub
liEditMiscInfo_Err:
ErrHand Me.Name, "liEditMiscInfo"
Exit Sub
End Sub